:userdoc.
:prolog.
.nameit symbol=fn0049 gmltype=hp2 size='+2' text='abs'
.nameit symbol=fn0005 gmltype=hp2 size='+2' text='ACTCOL'
.nameit symbol=fn0006 gmltype=hp2 size='+2' text='ADDSTF'
.nameit symbol=fn0035 gmltype=hp2 size='+2' text='AMOD'
.nameit symbol=fn0063 gmltype=hp2 size='+2' text='atan'
.nameit symbol=fn0062 gmltype=hp2 size='+2' text='atan2'
.nameit symbol=fn0007 gmltype=hp2 size='+2' text='DOT'
.nameit symbol=fn0036 gmltype=hp2 size='+2' text='dspMatrix'
.nameit symbol=fn0008 gmltype=hp2 size='+2' text='ELMLIB'
.nameit symbol=fn0023 gmltype=hp2 size='+2' text='ELMT01'
.nameit symbol=fn0028 gmltype=hp2 size='+2' text='ELMT02'
.nameit symbol=fn0029 gmltype=hp2 size='+2' text='ELMT03'
.nameit symbol=fn0009 gmltype=hp2 size='+2' text='EUPDAT'
.nameit symbol=fn0052 gmltype=hp2 size='+2' text='exit'
.nameit symbol=fn0058 gmltype=hp2 size='+2' text='fabs'
.nameit symbol=fn0066 gmltype=hp2 size='+2' text='floor'
.nameit symbol=fn0001 gmltype=hp2 size='+2' text='GENVEC'
.nameit symbol=fn0050 gmltype=hp2 size='+2' text='Get'
.nameit symbol=fn0045 gmltype=hp2 size='+2' text='gets'
.nameit symbol=fn0034 gmltype=hp2 size='+2' text='ISIGN'
.nameit symbol=fn0059 gmltype=hp2 size='+2' text='labs'
.nameit symbol=fn0043 gmltype=hp2 size='+2' text='main'
.nameit symbol=fn0055 gmltype=hp2 size='+2' text='max'
.nameit symbol=fn0053 gmltype=hp2 size='+2' text='memset'
.nameit symbol=fn0051 gmltype=hp2 size='+2' text='min'
.nameit symbol=fn0010 gmltype=hp2 size='+2' text='NORM'
.nameit symbol=fn0011 gmltype=hp2 size='+2' text='PCOMP'
.nameit symbol=fn0000 gmltype=hp2 size='+2' text='PCONTR'
.nameit symbol=fn0012 gmltype=hp2 size='+2' text='PEIGS'
.nameit symbol=fn0013 gmltype=hp2 size='+2' text='PFORM'
.nameit symbol=fn0024 gmltype=hp2 size='+2' text='PGAUSS'
.nameit symbol=fn0014 gmltype=hp2 size='+2' text='PLOAD'
.nameit symbol=fn0004 gmltype=hp2 size='+2' text='PMACR'
.nameit symbol=fn0002 gmltype=hp2 size='+2' text='PMESH'
.nameit symbol=fn0060 gmltype=hp2 size='+2' text='pow'
.nameit symbol=fn0038 gmltype=hp2 size='+2' text='print1Darray'
.nameit symbol=fn0040 gmltype=hp2 size='+2' text='print1Dvalue'
.nameit symbol=fn0037 gmltype=hp2 size='+2' text='print2Darray'
.nameit symbol=fn0039 gmltype=hp2 size='+2' text='print2Dvalue'
.nameit symbol=fn0044 gmltype=hp2 size='+2' text='printf'
.nameit symbol=fn0015 gmltype=hp2 size='+2' text='PROFIL'
.nameit symbol=fn0016 gmltype=hp2 size='+2' text='PROMUL'
.nameit symbol=fn0017 gmltype=hp2 size='+2' text='PROPLD'
.nameit symbol=fn0018 gmltype=hp2 size='+2' text='PRTDIS'
.nameit symbol=fn0019 gmltype=hp2 size='+2' text='PRTREA'
.nameit symbol=fn0020 gmltype=hp2 size='+2' text='PSETM'
.nameit symbol=fn0025 gmltype=hp2 size='+2' text='PSTRES'
.nameit symbol=fn0021 gmltype=hp2 size='+2' text='PZERO'
.nameit symbol=fn0031 gmltype=hp2 size='+2' text='read_double'
.nameit symbol=fn0030 gmltype=hp2 size='+2' text='read_int'
.nameit symbol=fn0032 gmltype=hp2 size='+2' text='read_string'
.nameit symbol=fn0048 gmltype=hp2 size='+2' text='Set'
.nameit symbol=fn0003 gmltype=hp2 size='+2' text='SETMEM'
.nameit symbol=fn0027 gmltype=hp2 size='+2' text='SHAP2'
.nameit symbol=fn0026 gmltype=hp2 size='+2' text='SHAPE'
.nameit symbol=fn0061 gmltype=hp2 size='+2' text='sin'
.nameit symbol=fn0071 gmltype=hp2 size='+2' text='sprintf'
.nameit symbol=fn0056 gmltype=hp2 size='+2' text='sqrt'
.nameit symbol=fn0065 gmltype=hp2 size='+2' text='sscanf'
.nameit symbol=fn0070 gmltype=hp2 size='+2' text='strchr'
.nameit symbol=fn0057 gmltype=hp2 size='+2' text='strcmp'
.nameit symbol=fn0047 gmltype=hp2 size='+2' text='strcpy'
.nameit symbol=fn0033 gmltype=hp2 size='+2' text='strip'
.nameit symbol=fn0064 gmltype=hp2 size='+2' text='strlen'
.nameit symbol=fn0046 gmltype=hp2 size='+2' text='strncmp'
.nameit symbol=fn0054 gmltype=hp2 size='+2' text='strncpy'
.nameit symbol=fn0041 gmltype=hp2 size='+2' text='traceIN'
.nameit symbol=fn0042 gmltype=hp2 size='+2' text='traceOUT'
.nameit symbol=fn0022 gmltype=hp2 size='+2' text='UACTCL'
.nameit symbol=fn0069 gmltype=hp2 size='+2' text='va_end'
.nameit symbol=fn0067 gmltype=hp2 size='+2' text='va_start'
.nameit symbol=fn0068 gmltype=hp2 size='+2' text='vprintf'
:docprof
   layout=1
   ldrdots=yes
   headnum=no
   rhrfrule=both
   fbc=yes
   bodyhd1=''
   .
:eprolog.
:body.
:tdef id=reftbl
   cols='1* 6*'
   arrange='5 5'
   arrange='1 2'
   arrange='3 4'
   concat=no
   scale='.8'
   split=yes
   .
:subject.
:h1.FEAP&period.C (10/14/94 14&colon.43&colon.30)
&rbl.
.layout 2 space
:table refid=reftbl.
:row.:c 5.&fn0005. (FEAP.C, page :spotref refid=sp0005.)
:c 1.calls
:c 2.:hp2.DOT:ehp2. (FEAP.C, page :spotref refid=sp0007.)
:hp2.dspMatrix:ehp2. (FEAP.C, page :spotref refid=sp0036.)
:hp2.min:ehp2.
:hp2.printf:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0006. (FEAP.C, page :spotref refid=sp0006.)
:c 1.calls
:c 2.:hp2.dspMatrix:ehp2. (FEAP.C, page :spotref refid=sp0036.)
:hp2.Get:ehp2.
:hp2.printf:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0035. (FEAP.C, page :spotref refid=sp0035.)
:c 1.calls
:c 2.:hp2.fabs:ehp2.
:hp2.floor:ehp2.
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0007. (FEAP.C, page :spotref refid=sp0007.)
:c 3.called
by
:c 4.:hp2.ACTCOL:ehp2. (FEAP.C, page :spotref refid=sp0005.)
:hp2.NORM:ehp2. (FEAP.C, page :spotref refid=sp0010.)
:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:hp2.UACTCL:ehp2. (FEAP.C, page :spotref refid=sp0022.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0036. (FEAP.C, page :spotref refid=sp0036.)
:c 1.calls
:c 2.:hp2.printf:ehp2.
:hp2.va_end:ehp2.
:hp2.va_start:ehp2.
:hp2.vprintf:ehp2.
:c 3.called
by
:c 4.:hp2.ACTCOL:ehp2. (FEAP.C, page :spotref refid=sp0005.)
:hp2.ADDSTF:ehp2. (FEAP.C, page :spotref refid=sp0006.)
:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0008. (FEAP.C, page :spotref refid=sp0008.)
:c 1.calls
:c 2.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.ELMT02:ehp2. (FEAP.C, page :spotref refid=sp0028.)
:hp2.ELMT03:ehp2. (FEAP.C, page :spotref refid=sp0029.)
:hp2.exit:ehp2.
:hp2.printf:ehp2.
:hp2.Set:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0023. (FEAP.C, page :spotref refid=sp0023.)
:c 1.calls
:c 2.:hp2.Get:ehp2.
:hp2.gets:ehp2.
:hp2.max:ehp2.
:hp2.min:ehp2.
:hp2.PGAUSS:ehp2. (FEAP.C, page :spotref refid=sp0024.)
:hp2.print1Darray:ehp2. (FEAP.C, page :spotref refid=sp0038.)
:hp2.print2Darray:ehp2. (FEAP.C, page :spotref refid=sp0037.)
:hp2.printf:ehp2.
:hp2.PSTRES:ehp2. (FEAP.C, page :spotref refid=sp0025.)
:hp2.read_double:ehp2. (FEAP.C, page :spotref refid=sp0031.)
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.Set:ehp2.
:hp2.SHAPE:ehp2. (FEAP.C, page :spotref refid=sp0026.)
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.ELMLIB:ehp2. (FEAP.C, page :spotref refid=sp0008.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0028. (FEAP.C, page :spotref refid=sp0028.)
:c 1.calls
:c 2.:hp2.Get:ehp2.
:hp2.gets:ehp2.
:hp2.printf:ehp2.
:hp2.read_double:ehp2. (FEAP.C, page :spotref refid=sp0031.)
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.Set:ehp2.
:hp2.SHAPE:ehp2. (FEAP.C, page :spotref refid=sp0026.)
:hp2.sqrt:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.ELMLIB:ehp2. (FEAP.C, page :spotref refid=sp0008.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0029. (FEAP.C, page :spotref refid=sp0029.)
:c 1.calls
:c 2.:hp2.Get:ehp2.
:hp2.gets:ehp2.
:hp2.PGAUSS:ehp2. (FEAP.C, page :spotref refid=sp0024.)
:hp2.printf:ehp2.
:hp2.read_double:ehp2. (FEAP.C, page :spotref refid=sp0031.)
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.Set:ehp2.
:hp2.SHAPE:ehp2. (FEAP.C, page :spotref refid=sp0026.)
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.ELMLIB:ehp2. (FEAP.C, page :spotref refid=sp0008.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0009. (FEAP.C, page :spotref refid=sp0009.)
:c 1.calls
:c 2.:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0001. (FEAP.C, page :spotref refid=sp0001.)
:c 1.calls
:c 2.:hp2.abs:ehp2.
:hp2.Get:ehp2.
:hp2.gets:ehp2.
:hp2.ISIGN:ehp2. (FEAP.C, page :spotref refid=sp0034.)
:hp2.min:ehp2.
:hp2.printf:ehp2.
:hp2.read_double:ehp2. (FEAP.C, page :spotref refid=sp0031.)
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.Set:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0034. (FEAP.C, page :spotref refid=sp0034.)
:c 1.calls
:c 2.:hp2.abs:ehp2.
:c 3.called
by
:c 4.:hp2.GENVEC:ehp2. (FEAP.C, page :spotref refid=sp0001.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0043. (FEAP.C, page :spotref refid=sp0043.)
:c 1.calls
:c 2.:hp2.gets:ehp2.
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:hp2.printf:ehp2.
:hp2.PROFIL:ehp2. (FEAP.C, page :spotref refid=sp0015.)
:hp2.PZERO:ehp2. (FEAP.C, page :spotref refid=sp0021.)
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.SETMEM:ehp2. (FEAP.C, page :spotref refid=sp0003.)
:hp2.strcpy:ehp2.
:hp2.strip:ehp2. (FEAP.C, page :spotref refid=sp0033.)
:hp2.strncmp:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0010. (FEAP.C, page :spotref refid=sp0010.)
:c 1.calls
:c 2.:hp2.DOT:ehp2. (FEAP.C, page :spotref refid=sp0007.)
:hp2.sqrt:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0011. (FEAP.C, page :spotref refid=sp0011.)
:c 3.called
by
:c 4.:hp2.PRTDIS:ehp2. (FEAP.C, page :spotref refid=sp0018.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0012. (FEAP.C, page :spotref refid=sp0012.)
:c 1.calls
:c 2.:hp2.ACTCOL:ehp2. (FEAP.C, page :spotref refid=sp0005.)
:hp2.DOT:ehp2. (FEAP.C, page :spotref refid=sp0007.)
:hp2.fabs:ehp2.
:hp2.NORM:ehp2. (FEAP.C, page :spotref refid=sp0010.)
:hp2.printf:ehp2.
:hp2.PROMUL:ehp2. (FEAP.C, page :spotref refid=sp0016.)
:hp2.PRTDIS:ehp2. (FEAP.C, page :spotref refid=sp0018.)
:hp2.PZERO:ehp2. (FEAP.C, page :spotref refid=sp0021.)
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0013. (FEAP.C, page :spotref refid=sp0013.)
:c 1.calls
:c 2.:hp2.ADDSTF:ehp2. (FEAP.C, page :spotref refid=sp0006.)
:hp2.dspMatrix:ehp2. (FEAP.C, page :spotref refid=sp0036.)
:hp2.ELMLIB:ehp2. (FEAP.C, page :spotref refid=sp0008.)
:hp2.Get:ehp2.
:hp2.labs:ehp2.
:hp2.print1Darray:ehp2. (FEAP.C, page :spotref refid=sp0038.)
:hp2.print2Darray:ehp2. (FEAP.C, page :spotref refid=sp0037.)
:hp2.printf:ehp2.
:hp2.Set:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0024. (FEAP.C, page :spotref refid=sp0024.)
:c 1.calls
:c 2.:hp2.print1Darray:ehp2. (FEAP.C, page :spotref refid=sp0038.)
:hp2.sqrt:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.ELMT03:ehp2. (FEAP.C, page :spotref refid=sp0029.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0014. (FEAP.C, page :spotref refid=sp0014.)
:c 1.calls
:c 2.:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0004. (FEAP.C, page :spotref refid=sp0004.)
:c 1.calls
:c 2.:hp2.ACTCOL:ehp2. (FEAP.C, page :spotref refid=sp0005.)
:hp2.AMOD:ehp2. (FEAP.C, page :spotref refid=sp0035.)
:hp2.dspMatrix:ehp2. (FEAP.C, page :spotref refid=sp0036.)
:hp2.EUPDAT:ehp2. (FEAP.C, page :spotref refid=sp0009.)
:hp2.gets:ehp2.
:hp2.max:ehp2.
:hp2.memset:ehp2.
:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:hp2.PLOAD:ehp2. (FEAP.C, page :spotref refid=sp0014.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:hp2.printf:ehp2.
:hp2.PROPLD:ehp2. (FEAP.C, page :spotref refid=sp0017.)
:hp2.PRTDIS:ehp2. (FEAP.C, page :spotref refid=sp0018.)
:hp2.PRTREA:ehp2. (FEAP.C, page :spotref refid=sp0019.)
:hp2.PSETM:ehp2. (FEAP.C, page :spotref refid=sp0020.)
:hp2.PZERO:ehp2. (FEAP.C, page :spotref refid=sp0021.)
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.SETMEM:ehp2. (FEAP.C, page :spotref refid=sp0003.)
:hp2.sqrt:ehp2.
:hp2.strcmp:ehp2.
:hp2.strcpy:ehp2.
:hp2.strncmp:ehp2.
:hp2.strncpy:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:hp2.UACTCL:ehp2. (FEAP.C, page :spotref refid=sp0022.)
:c 3.called
by
:c 4.:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0002. (FEAP.C, page :spotref refid=sp0002.)
:c 1.calls
:c 2.:hp2.ELMLIB:ehp2. (FEAP.C, page :spotref refid=sp0008.)
:hp2.exit:ehp2.
:hp2.GENVEC:ehp2. (FEAP.C, page :spotref refid=sp0001.)
:hp2.Get:ehp2.
:hp2.gets:ehp2.
:hp2.ISIGN:ehp2. (FEAP.C, page :spotref refid=sp0034.)
:hp2.min:ehp2.
:hp2.printf:ehp2.
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.read_string:ehp2. (FEAP.C, page :spotref refid=sp0032.)
:hp2.Set:ehp2.
:hp2.strcpy:ehp2.
:hp2.strip:ehp2. (FEAP.C, page :spotref refid=sp0033.)
:hp2.strncmp:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0038. (FEAP.C, page :spotref refid=sp0038.)
:c 1.calls
:c 2.:hp2.print1Dvalue:ehp2. (FEAP.C, page :spotref refid=sp0040.)
:hp2.printf:ehp2.
:hp2.sprintf:ehp2.
:hp2.strchr:ehp2.
:c 3.called
by
:c 4.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:hp2.PGAUSS:ehp2. (FEAP.C, page :spotref refid=sp0024.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0040. (FEAP.C, page :spotref refid=sp0040.)
:c 1.calls
:c 2.:hp2.printf:ehp2.
:c 3.called
by
:c 4.:hp2.print1Darray:ehp2. (FEAP.C, page :spotref refid=sp0038.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0037. (FEAP.C, page :spotref refid=sp0037.)
:c 1.calls
:c 2.:hp2.print2Dvalue:ehp2. (FEAP.C, page :spotref refid=sp0039.)
:hp2.printf:ehp2.
:hp2.sprintf:ehp2.
:hp2.strchr:ehp2.
:c 3.called
by
:c 4.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:hp2.SHAPE:ehp2. (FEAP.C, page :spotref refid=sp0026.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0039. (FEAP.C, page :spotref refid=sp0039.)
:c 1.calls
:c 2.:hp2.Get:ehp2.
:hp2.printf:ehp2.
:c 3.called
by
:c 4.:hp2.print2Darray:ehp2. (FEAP.C, page :spotref refid=sp0037.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0015. (FEAP.C, page :spotref refid=sp0015.)
:c 1.calls
:c 2.:hp2.abs:ehp2.
:hp2.Get:ehp2.
:hp2.max:ehp2.
:hp2.Set:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0016. (FEAP.C, page :spotref refid=sp0016.)
:c 1.calls
:c 2.:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0017. (FEAP.C, page :spotref refid=sp0017.)
:c 1.calls
:c 2.:hp2.gets:ehp2.
:hp2.max:ehp2.
:hp2.pow:ehp2.
:hp2.printf:ehp2.
:hp2.read_double:ehp2. (FEAP.C, page :spotref refid=sp0031.)
:hp2.read_int:ehp2. (FEAP.C, page :spotref refid=sp0030.)
:hp2.sin:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0018. (FEAP.C, page :spotref refid=sp0018.)
:c 1.calls
:c 2.:hp2.abs:ehp2.
:hp2.Get:ehp2.
:hp2.min:ehp2.
:hp2.PCOMP:ehp2. (FEAP.C, page :spotref refid=sp0011.)
:hp2.printf:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0019. (FEAP.C, page :spotref refid=sp0019.)
:c 1.calls
:c 2.:hp2.fabs:ehp2.
:hp2.Get:ehp2.
:hp2.min:ehp2.
:hp2.printf:ehp2.
:hp2.Set:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0020. (FEAP.C, page :spotref refid=sp0020.)
:c 1.calls
:c 2.:hp2.SETMEM:ehp2. (FEAP.C, page :spotref refid=sp0003.)
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0025. (FEAP.C, page :spotref refid=sp0025.)
:c 1.calls
:c 2.:hp2.atan:ehp2.
:hp2.atan2:ehp2.
:hp2.sqrt:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0021. (FEAP.C, page :spotref refid=sp0021.)
:c 1.calls
:c 2.:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0031. (FEAP.C, page :spotref refid=sp0031.)
:c 1.calls
:c 2.:hp2.sscanf:ehp2.
:hp2.strlen:ehp2.
:c 3.called
by
:c 4.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.ELMT02:ehp2. (FEAP.C, page :spotref refid=sp0028.)
:hp2.ELMT03:ehp2. (FEAP.C, page :spotref refid=sp0029.)
:hp2.GENVEC:ehp2. (FEAP.C, page :spotref refid=sp0001.)
:hp2.PROPLD:ehp2. (FEAP.C, page :spotref refid=sp0017.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0030. (FEAP.C, page :spotref refid=sp0030.)
:c 1.calls
:c 2.:hp2.sscanf:ehp2.
:hp2.strlen:ehp2.
:c 3.called
by
:c 4.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.ELMT02:ehp2. (FEAP.C, page :spotref refid=sp0028.)
:hp2.ELMT03:ehp2. (FEAP.C, page :spotref refid=sp0029.)
:hp2.GENVEC:ehp2. (FEAP.C, page :spotref refid=sp0001.)
:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:hp2.PROPLD:ehp2. (FEAP.C, page :spotref refid=sp0017.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0032. (FEAP.C, page :spotref refid=sp0032.)
:c 1.calls
:c 2.:hp2.strlen:ehp2.
:hp2.strncpy:ehp2.
:c 3.called
by
:c 4.:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0003. (FEAP.C, page :spotref refid=sp0003.)
:c 1.calls
:c 2.:hp2.exit:ehp2.
:hp2.printf:ehp2.
:c 3.called
by
:c 4.:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:hp2.PSETM:ehp2. (FEAP.C, page :spotref refid=sp0020.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0027. (FEAP.C, page :spotref refid=sp0027.)
:c 1.calls
:c 2.:hp2.Get:ehp2.
:hp2.Set:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.SHAPE:ehp2. (FEAP.C, page :spotref refid=sp0026.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0026. (FEAP.C, page :spotref refid=sp0026.)
:c 1.calls
:c 2.:hp2.Get:ehp2.
:hp2.print2Darray:ehp2. (FEAP.C, page :spotref refid=sp0037.)
:hp2.printf:ehp2.
:hp2.Set:ehp2.
:hp2.SHAP2:ehp2. (FEAP.C, page :spotref refid=sp0027.)
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.ELMT02:ehp2. (FEAP.C, page :spotref refid=sp0028.)
:hp2.ELMT03:ehp2. (FEAP.C, page :spotref refid=sp0029.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0033. (FEAP.C, page :spotref refid=sp0033.)
:c 3.called
by
:c 4.:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0041. (FEAP.C, page :spotref refid=sp0041.)
:c 1.calls
:c 2.:hp2.printf:ehp2.
:hp2.va_end:ehp2.
:hp2.va_start:ehp2.
:hp2.vprintf:ehp2.
:c 3.called
by
:c 4.:hp2.ACTCOL:ehp2. (FEAP.C, page :spotref refid=sp0005.)
:hp2.ADDSTF:ehp2. (FEAP.C, page :spotref refid=sp0006.)
:hp2.ELMLIB:ehp2. (FEAP.C, page :spotref refid=sp0008.)
:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.ELMT02:ehp2. (FEAP.C, page :spotref refid=sp0028.)
:hp2.ELMT03:ehp2. (FEAP.C, page :spotref refid=sp0029.)
:hp2.EUPDAT:ehp2. (FEAP.C, page :spotref refid=sp0009.)
:hp2.GENVEC:ehp2. (FEAP.C, page :spotref refid=sp0001.)
:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:hp2.NORM:ehp2. (FEAP.C, page :spotref refid=sp0010.)
:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:hp2.PGAUSS:ehp2. (FEAP.C, page :spotref refid=sp0024.)
:hp2.PLOAD:ehp2. (FEAP.C, page :spotref refid=sp0014.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:hp2.PROFIL:ehp2. (FEAP.C, page :spotref refid=sp0015.)
:hp2.PROMUL:ehp2. (FEAP.C, page :spotref refid=sp0016.)
:hp2.PROPLD:ehp2. (FEAP.C, page :spotref refid=sp0017.)
:hp2.PRTDIS:ehp2. (FEAP.C, page :spotref refid=sp0018.)
:hp2.PRTREA:ehp2. (FEAP.C, page :spotref refid=sp0019.)
:hp2.PSETM:ehp2. (FEAP.C, page :spotref refid=sp0020.)
:hp2.PSTRES:ehp2. (FEAP.C, page :spotref refid=sp0025.)
:hp2.PZERO:ehp2. (FEAP.C, page :spotref refid=sp0021.)
:hp2.SHAP2:ehp2. (FEAP.C, page :spotref refid=sp0027.)
:hp2.SHAPE:ehp2. (FEAP.C, page :spotref refid=sp0026.)
:hp2.UACTCL:ehp2. (FEAP.C, page :spotref refid=sp0022.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0042. (FEAP.C, page :spotref refid=sp0042.)
:c 1.calls
:c 2.:hp2.printf:ehp2.
:hp2.va_end:ehp2.
:hp2.va_start:ehp2.
:hp2.vprintf:ehp2.
:c 3.called
by
:c 4.:hp2.ACTCOL:ehp2. (FEAP.C, page :spotref refid=sp0005.)
:hp2.ADDSTF:ehp2. (FEAP.C, page :spotref refid=sp0006.)
:hp2.ELMLIB:ehp2. (FEAP.C, page :spotref refid=sp0008.)
:hp2.ELMT01:ehp2. (FEAP.C, page :spotref refid=sp0023.)
:hp2.ELMT02:ehp2. (FEAP.C, page :spotref refid=sp0028.)
:hp2.ELMT03:ehp2. (FEAP.C, page :spotref refid=sp0029.)
:hp2.EUPDAT:ehp2. (FEAP.C, page :spotref refid=sp0009.)
:hp2.GENVEC:ehp2. (FEAP.C, page :spotref refid=sp0001.)
:hp2.main:ehp2. (FEAP.C, page :spotref refid=sp0043.)
:hp2.NORM:ehp2. (FEAP.C, page :spotref refid=sp0010.)
:hp2.PEIGS:ehp2. (FEAP.C, page :spotref refid=sp0012.)
:hp2.PFORM:ehp2. (FEAP.C, page :spotref refid=sp0013.)
:hp2.PGAUSS:ehp2. (FEAP.C, page :spotref refid=sp0024.)
:hp2.PLOAD:ehp2. (FEAP.C, page :spotref refid=sp0014.)
:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:hp2.PMESH:ehp2. (FEAP.C, page :spotref refid=sp0002.)
:hp2.PROFIL:ehp2. (FEAP.C, page :spotref refid=sp0015.)
:hp2.PROMUL:ehp2. (FEAP.C, page :spotref refid=sp0016.)
:hp2.PROPLD:ehp2. (FEAP.C, page :spotref refid=sp0017.)
:hp2.PRTDIS:ehp2. (FEAP.C, page :spotref refid=sp0018.)
:hp2.PRTREA:ehp2. (FEAP.C, page :spotref refid=sp0019.)
:hp2.PSETM:ehp2. (FEAP.C, page :spotref refid=sp0020.)
:hp2.PSTRES:ehp2. (FEAP.C, page :spotref refid=sp0025.)
:hp2.PZERO:ehp2. (FEAP.C, page :spotref refid=sp0021.)
:hp2.SHAP2:ehp2. (FEAP.C, page :spotref refid=sp0027.)
:hp2.SHAPE:ehp2. (FEAP.C, page :spotref refid=sp0026.)
:hp2.UACTCL:ehp2. (FEAP.C, page :spotref refid=sp0022.)
:etable.
:table refid=reftbl.
:row.:c 5.&fn0022. (FEAP.C, page :spotref refid=sp0022.)
:c 1.calls
:c 2.:hp2.DOT:ehp2. (FEAP.C, page :spotref refid=sp0007.)
:hp2.min:ehp2.
:hp2.traceIN:ehp2. (FEAP.C, page :spotref refid=sp0041.)
:hp2.traceOUT:ehp2. (FEAP.C, page :spotref refid=sp0042.)
:c 3.called
by
:c 4.:hp2.PMACR:ehp2. (FEAP.C, page :spotref refid=sp0004.)
:etable.
.layout
.pa
.sa oldenv
:xmp width=128 scale=auto.
.sa xmpenv
:exmp
.re xmpenv
    1                  
    2   :hp1./*---------------------------------------------------------------------------*/:ehp1.
    3   :hp1./* Include files                                                             */:ehp1.
    4   :hp1./*---------------------------------------------------------------------------*/:ehp1.
    5   
    6   :hp5.#include <stdlib&period.h>:ehp5.
    7   :hp5.#include <stdio&period.h>:ehp5.
    8   :hp5.#include <string&period.h>:ehp5.
    9   :hp5.#include <stdarg&period.h>:ehp5.
   10   :hp5.#include <math&period.h>:ehp5.
   11   
   12   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   13   :hp1./* Macros                                                                    */:ehp1.
   14   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   15   
   16   :hp5.#define BLANK           999&period.0:ehp5.
   17   :hp5.#define LINE_LENGTH     256:ehp5.
   18   :hp5.#define FALSE             0:ehp5.
   19   :hp5.#define TRUE              1:ehp5.
   20   
   21   :hp5.#define Get(array,row,col,limit)        array&lbrk.(row) * (limit) + col&rbrk.:ehp5.
   22   :hp5.#define Set(array,row,col,limit,value)  array&lbrk.(row) * (limit) + col&rbrk. = value:ehp5.
   23   
   24   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   25   :hp1./* Declarations                                                              */:ehp1.
   26   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   27   
   28   :hp3.typedef:ehp3. :hp3.struct:ehp3. control_tag CONTROL;
   29   
   30   :hp3.struct:ehp3. control_tag
   31  &bxul.{
   32  &bxv.    :hp3.char:ehp3.   s1&lbrk.8&rbrk.;
   33  &bxv.    :hp3.char:ehp3.   s2&lbrk.8&rbrk.;
   34  &bxv.    :hp3.double:ehp3. d1;
   35  &bxv.    :hp3.double:ehp3. d2;
   36  &bxll.};
   37   
   38   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   39   :hp1./* blank common                                                              */:ehp1.
   40   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   41   
   42   :hp3.int:ehp3. M&lbrk.2000&rbrk. = {0};
   43   
   44   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   45   :hp1./* PSIZE common                                                              */:ehp1.
   46   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   47   
   48   :hp3.int:ehp3. MAX = 2000;
   49   
   50   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   51   :hp1./* CDATA common                                                              */:ehp1.
   52   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   53   
   54   :hp3.char:ehp3.  O&lbrk.LINE_LENGTH + 1&rbrk.    = "\n";
   55   :hp3.char:ehp3.  HEAD&lbrk.LINE_LENGTH + 1&rbrk. = "";
   56   :hp3.int:ehp3.   NUMNP  = 0;
   57   :hp3.int:ehp3.   NUMEL  = 0;
   58   :hp3.int:ehp3.   NUMMAT = 0;
   59   :hp3.int:ehp3.   NEN    = 0;
   60   :hp3.int:ehp3.   NEQ    = 0;
   61   :hp3.int:ehp3.   IPR    = 2;
   62   
   63   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   64   :hp1./* ELDATA common                                                             */:ehp1.
   65   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   66   
   67   :hp3.int:ehp3. DM  = 0;
   68   :hp3.int:ehp3. N   = 0;
   69   :hp3.int:ehp3. MA  = 0;
   70   :hp3.int:ehp3. MCT = 0;
   71   :hp3.int:ehp3. IEL = 0;
   72   :hp3.int:ehp3. NEL = 0;
   73   
   74   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   75   :hp1./* ENGYS common                                                              */:ehp1.
   76   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   77   
   78   :hp3.double:ehp3. AENGY = 0&period.0;
   79   
   80   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   81   :hp1./* LABEL common                                                              */:ehp1.
   82   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   83   
   84   :hp3.char:ehp3. *BC    = " B&period.C&period. ";
   85   :hp3.char:ehp3. *DI&lbrk.3&rbrk. = {"Displ", "Veloc", "Accel"};
   86   :hp3.char:ehp3. *CD    = " Coordinates";
   87   :hp3.char:ehp3. *TE    = " Temperature";
   88   :hp3.char:ehp3. *FD    = " Force/Displ";
   89   
   90   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   91   :hp1./* PRLOD common                                                              */:ehp1.
   92   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   93   
   94   :hp3.double:ehp3. PROP = 0&period.0;
   95   
   96   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   97   :hp1./* TDATA common                                                              */:ehp1.
   98   :hp1./*---------------------------------------------------------------------------*/:ehp1.
   99   
  100   :hp3.double:ehp3. TIME = 0&period.0;
  101   :hp3.double:ehp3. DT   = 0&period.0;
  102   :hp3.int:ehp3.    C1 = 0;
  103   :hp3.int:ehp3.    C2 = 0;
  104   :hp3.int:ehp3.    C3 = 0;
  105   :hp3.int:ehp3.    C4 = 0;
  106   :hp3.int:ehp3.    C5 = 0;
  107   
  108   :hp3.int:ehp3. esc       = 27;
  109   :hp3.int:ehp3. fs        = 28;
  110   :hp3.int:ehp3. form_feed = 12;
  111   :hp3.int:ehp3. condensed = 15;
  112   :hp3.int:ehp3. cpi_15    = 103;
  113   :hp3.int:ehp3. cpi_10    = 80;
  114   :hp3.int:ehp3. cpi_12    = 77;
  115   :hp3.int:ehp3. reset     = 18;
  116   
  117   :hp1./*---------------------------------------------------------------------------*/:ehp1.
  118   :hp1./*                                                                           */:ehp1.
  119   :hp1./*---------------------------------------------------------------------------*/:ehp1.
  120   
  121   :hp3.char:ehp3. trace_prefix&lbrk.200&rbrk.  = "";
  122   :hp3.int:ehp3.  trace_indent       = 0;
  123   
  124   :hp1./*---------------------------------------------------------------------------*/:ehp1.
  125   :hp1./* Prototypes                                                                */:ehp1.
  126   :hp1./*---------------------------------------------------------------------------*/:ehp1.
  127   
  128   :hp3.void:ehp3.   &fn0000.      (:hp3.void:ehp3.);
  129   :hp3.void:ehp3.   &fn0001.      (:hp3.int:ehp3. NDM,
  130                       :hp3.double:ehp3. *X,
  131                       :hp3.char:ehp3. *title, :hp3.int:ehp3. PRT, :hp3.int:ehp3. *ERR);
  132   :hp3.void:ehp3.   &fn0002.       (:hp3.int:ehp3. *IDL, :hp3.int:ehp3. *IE, :hp3.double:ehp3. *D, :hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX,
  133                       :hp3.double:ehp3. *F, :hp3.double:ehp3. *T, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. III);
  134   :hp3.void:ehp3.   &fn0003.      (:hp3.int:ehp3. J);
  135   :hp3.void:ehp3.   &fn0004.       (:hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.double:ehp3. *TL, :hp3.int:ehp3. *LD, :hp3.double:ehp3. *P,
  136                       :hp3.double:ehp3. *S, :hp3.int:ehp3. *IE, :hp3.double:ehp3. *D, :hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX,
  137                       :hp3.double:ehp3. *F, :hp3.double:ehp3. *T, :hp3.int:ehp3. *JDIAG, :hp3.double:ehp3. *B, :hp3.double:ehp3. *DR,
  138                       CONTROL *CT, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. NST, :hp3.int:ehp3. NEND);
  139   :hp3.void:ehp3.   &fn0005.      (:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NEQ, :hp3.int:ehp3. AFAC, :hp3.int:ehp3. BACK);
  140   :hp3.void:ehp3.   &fn0006.      (:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.double:ehp3. *C, :hp3.double:ehp3. *S, :hp3.double:ehp3. *P,
  141                       :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. *LD, :hp3.int:ehp3. NST, :hp3.int:ehp3. NFL, :hp3.int:ehp3. AFL, :hp3.int:ehp3. BFL, :hp3.int:ehp3. CFL);
  142   :hp3.double:ehp3. &fn0007.         (:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.int:ehp3. N);
  143   :hp3.void:ehp3.   &fn0008.      (:hp3.double:ehp3. *D, :hp3.double:ehp3. *U, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *T, :hp3.double:ehp3. *S,
  144                       :hp3.double:ehp3. *P, :hp3.int:ehp3. I, :hp3.int:ehp3. J, :hp3.int:ehp3. K, :hp3.int:ehp3. ISW);
  145   :hp3.void:ehp3.   &fn0009.      (:hp3.double:ehp3. *DR, :hp3.double:ehp3. *U, :hp3.double:ehp3. *V, :hp3.double:ehp3. *A, :hp3.double:ehp3. *XM,
  146                       :hp3.double:ehp3. DT, :hp3.int:ehp3. NEQ);
  147   :hp3.void:ehp3.   &fn0010.        (:hp3.double:ehp3. *X, :hp3.double:ehp3. *Y, :hp3.int:ehp3. N);
  148   :hp3.int:ehp3.    &fn0011.       (:hp3.double:ehp3. A, :hp3.double:ehp3. B);
  149   :hp3.void:ehp3.   &fn0012.       (:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.double:ehp3. *F, :hp3.double:ehp3. *X, :hp3.double:ehp3. *Y,
  150                       :hp3.double:ehp3. *Z, :hp3.int:ehp3. *ID, :hp3.int:ehp3. *IX,
  151                       :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. DFL);
  152   :hp3.void:ehp3.   &fn0013.       (:hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.double:ehp3. *TL, :hp3.int:ehp3. *LD, :hp3.double:ehp3. *P,
  153                       :hp3.double:ehp3. *S, :hp3.int:ehp3. *IE, :hp3.double:ehp3. *D, :hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX,
  154                       :hp3.double:ehp3. *F, :hp3.double:ehp3. *T, :hp3.int:ehp3. *JDIAG, :hp3.double:ehp3. *B, :hp3.double:ehp3. *A,
  155                       :hp3.double:ehp3. *C, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW,
  156                       :hp3.double:ehp3. *U, :hp3.double:ehp3. *UD, :hp3.int:ehp3. AFL, :hp3.int:ehp3. BFL, :hp3.int:ehp3. CFL, :hp3.int:ehp3. DFL);
  157   :hp3.void:ehp3.   &fn0014.       (:hp3.int:ehp3. *ID, :hp3.double:ehp3. *F, :hp3.double:ehp3. *B, :hp3.int:ehp3. NN, :hp3.double:ehp3. P);
  158   :hp3.void:ehp3.   &fn0015.      (:hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. *ID, :hp3.int:ehp3. *IX, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. *NAD);
  159   :hp3.void:ehp3.   &fn0016.      (:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.double:ehp3. *C, :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NEQ);
  160   :hp3.double:ehp3. &fn0017.      (:hp3.double:ehp3. T, :hp3.int:ehp3. J);
  161   :hp3.void:ehp3.   &fn0018.      (:hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.double:ehp3. *B, :hp3.double:ehp3. *F, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NDF);
  162   :hp3.void:ehp3.   &fn0019.      (:hp3.double:ehp3. *R, :hp3.int:ehp3. NDF);
  163   :hp3.void:ehp3.   &fn0020.       (:hp3.int:ehp3. *NA, :hp3.int:ehp3. *NE, :hp3.int:ehp3. NJ, :hp3.int:ehp3. *AFL);
  164   :hp3.void:ehp3.   &fn0021.       (:hp3.double:ehp3. *V, :hp3.int:ehp3. NN);
  165   :hp3.void:ehp3.   &fn0022.      (:hp3.double:ehp3. *A, :hp3.double:ehp3. *C, :hp3.double:ehp3. *B, :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NEQ,
  166                       :hp3.int:ehp3. AFAC, :hp3.int:ehp3. BACK);
  167   :hp3.void:ehp3.   &fn0023.      (:hp3.double:ehp3. *D, :hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *TL,
  168                       :hp3.double:ehp3. *S, :hp3.double:ehp3. *P, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW);
  169   :hp3.void:ehp3.   &fn0024.      (:hp3.int:ehp3. l, :hp3.int:ehp3. *LINT, :hp3.double:ehp3. *R, :hp3.double:ehp3. *Z, :hp3.double:ehp3. *W);
  170   :hp3.void:ehp3.   &fn0025.      (:hp3.double:ehp3. *SIG, :hp3.double:ehp3. *P1, :hp3.double:ehp3. *P2, :hp3.double:ehp3. *P3);
  171   :hp3.void:ehp3.   &fn0026.       (:hp3.double:ehp3. SS, :hp3.double:ehp3. TT, :hp3.double:ehp3. *X, :hp3.double:ehp3. *SHP, :hp3.double:ehp3. *XSJ,
  172                       :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEL, :hp3.int:ehp3. *IX, :hp3.int:ehp3. FLG);
  173   :hp3.void:ehp3.   &fn0027.       (:hp3.double:ehp3. S, :hp3.double:ehp3. T, :hp3.double:ehp3. *SHP, :hp3.int:ehp3. *IX, :hp3.int:ehp3. NEL);
  174   :hp3.void:ehp3.   &fn0028.      (:hp3.double:ehp3. *D, :hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *TL,
  175                       :hp3.double:ehp3. *S, :hp3.double:ehp3. *P, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW);
  176   :hp3.void:ehp3.   &fn0029.      (:hp3.double:ehp3. *D, :hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *TL, :hp3.double:ehp3. *S,
  177                       :hp3.double:ehp3. *P, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW);
  178   :hp3.int:ehp3.    &fn0030.    (:hp3.char:ehp3. *line, :hp3.int:ehp3. lo, :hp3.int:ehp3. hi);
  179   :hp3.double:ehp3. &fn0031. (:hp3.char:ehp3. *line, :hp3.int:ehp3. lo, :hp3.int:ehp3. hi);
  180   :hp3.char:ehp3.  *&fn0032. (:hp3.char:ehp3. *line, :hp3.int:ehp3. lo, :hp3.int:ehp3. hi, :hp3.char:ehp3. *buffer);
  181   :hp3.char:ehp3.  *&fn0033.       (:hp3.char:ehp3. *line);
  182   :hp3.int:ehp3.    &fn0034.       (:hp3.int:ehp3. a, :hp3.int:ehp3. b);
  183   :hp3.double:ehp3. &fn0035.        (:hp3.double:ehp3. a, :hp3.double:ehp3. b);
  184   :hp3.void:ehp3.   &fn0036.   (:hp3.int:ehp3. n, :hp3.int:ehp3. *JDIAG, :hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.char:ehp3. *format, &period.&period.&period.&cont.
);
  185   :hp3.void:ehp3.   &fn0037.(:hp3.char:ehp3. *name,  :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. row, :hp3.int:ehp3. col);
  186   :hp3.void:ehp3.   &fn0038.(:hp3.char:ehp3. *name,  :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. size);
  187   :hp3.void:ehp3.   &fn0039.(:hp3.int:ehp3. integer, :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. i, :hp3.int:ehp3. j, :hp3.int:ehp3. col);
  188   :hp3.void:ehp3.   &fn0040.(:hp3.int:ehp3. integer, :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. i);
  189   :hp3.void:ehp3.   &fn0041.     (:hp3.char:ehp3. *format, &period.&period.&period.);
  190   :hp3.void:ehp3.   &fn0042.    (:hp3.char:ehp3. *format, &period.&period.&period.);
  191   
.cp 181
  192   :hp1./******************************************************************************
:ehp1.  193:hp1.   *******************************************************************************
:ehp1.  194:hp1.   *******************************************************************************
:ehp1.  195:hp1.   *                                                                             *
:ehp1.  196:hp1.   * CONTROL AND DATA INPUT MODULES                                              *
:ehp1.  197:hp1.   *                                                                             *
:ehp1.  198:hp1.   *******************************************************************************
:ehp1.  199:hp1.   *******************************************************************************
:ehp1.  200:hp1.   ******************************************************************************/:ehp1.
  201                                                                               
  202                                                                               
  203   :hp1./*****************************************************************************/:ehp1.
  204   :hp1./* Finite Element Analysis Program (FEAP) for solution of general            */:ehp1.
  205   :hp1./* problem classes using the finite element method&period. Problem size             */:ehp1.
  206   :hp1./* is controlled by the dimension of blank common and value of MAX           */:ehp1.
  207   :hp1./* as set in main program&period.  ALL arrays must reside in central memory         */:ehp1.
  208   :hp1./*                                                                           */:ehp1.
  209   :hp1./* Programmed in Fortran IV by Prof&period. R&period.L&period. Taylor, Department of&cont.
 Civil        */:ehp1.
  210   :hp1./* Engineering, University of California, Berkeley, California 94720, U&period.S&period.A  */:ehp1.
  211   :hp1./*                                                                           */:ehp1.
  212   :hp1./* Converted to C by Richard Maxwell, IBM Hursley Park UK                    */:ehp1.
  213   :hp1./*****************************************************************************/:ehp1.
  214   
  215   :hp3.int:ehp3. &fn0043.:spot id=sp0043.(:hp3.void:ehp3.)
:subject.main
  216  &bxul.{
  217  &bxv.    CONTROL *CT = NULL;
  218  &bxv.    :hp3.double:ehp3.  *B = NULL, *D = NULL, *UL = NULL, *TL = NULL, *DR = NULL, *P = NULL;
  219  &bxv.    :hp3.double:ehp3.  *S = NULL, *XL = NULL, *X = NULL, *F = NULL, *T = NULL;
  220  &bxv.    :hp3.int:ehp3.     *ID = NULL, *IDL = NULL, *IE = NULL, *IX = NULL, NE = 0;
  221  &bxv.    :hp3.int:ehp3.      NDM = 0, NDF = 0, NEN1 = 0, NST = 0;
  222  &bxv.    :hp3.int:ehp3.     *JDIAG = NULL, more = TRUE;
  223  &bxv.
  224  &bxv.    &fn0044.("%c",   reset);
  225  &bxv.    &fn0044.("%c%c", esc, cpi_10);
  226  &bxv.    &fn0044.("\n");
  227  &bxv.
  228  &bxv.    &fn0041.("main");
  229  &bxv.
  230  &bxv.    :hp3.while:ehp3. (more)
  231  &bxv.   &bxul.{
  232  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
  233  &bxv.   &bxv.    :hp1./* Read a line and compare first 4 chars with macro list             */:ehp1.
  234  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
  235  &bxv.   &bxv.
  236  &bxv.   &bxv.    :hp3.char:ehp3. line&lbrk.LINE_LENGTH + 1&rbrk.&cont.
= "";
  237  &bxv.   &bxv.    :hp3.char:ehp3. *TITL = &fn0045.(line);
  238  &bxv.   &bxv.
  239  &bxv.   &bxv.    :hp3.if:ehp3. (TITL == NULL)
  240  &bxv.   &bxv.   &bxul.{
  241  &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERROR 50** Unexpected end-of-file\n"&cont.
);
  242  &bxv.   &bxv.   &bxv.    more = FALSE;
  243  &bxv.   &bxv.   &bxll.}
  244  &bxv.   &bxv.    :hp3.else:ehp3.
  245  &bxv.   &bxv.   &bxul.{
  246  &bxv.   &bxv.   &bxv.    TITL = &fn0033.(TITL);
  247  &bxv.   &bxv.   &bxv.   
  248  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0046.(TITL, "FEAP", 4) == 0)
  249  &bxv.   &bxv.   &bxv.   &bxul.{
  250  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. N0 = 0, N1 = 0&cont.
, N2 = 0, N3 = 0, N4 = 0, N5 = 0, N6 = 0, N7 = 0;
  251  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. N8 = 0, N9 = 0&cont.
, N10 = 0, N11 = 0, N12 = 0, N13 = 0, N14 = 0;
  252  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. NAD = 0, III =&cont.
 0;
  253  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.char:ehp3. *data = NULL;
  254  &bxv.   &bxv.   &bxv.   &bxv.
  255  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
  256  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Read and print &cont.
control information                        */:ehp1.
  257  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
  258  &bxv.   &bxv.   &bxv.   &bxv.
  259  &bxv.   &bxv.   &bxv.   &bxv.    &fn0047.(HEAD, TITL);
  260  &bxv.   &bxv.   &bxv.   &bxv.    data = &fn0045.(line);
  261  &bxv.   &bxv.   &bxv.   &bxv.
  262  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (data == NULL)
  263  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  264  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     **FATAL ERROR 51** Unexpected end-of-file\n");
  265  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    more = FALSE;
  266  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  267  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
  268  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  269  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NUMNP  = &fn0030.(line,  0,  5);
  270  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NUMEL  = &fn0030.(line,  5, 10);
  271  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NUMMAT = &fn0030.(line, 10, 15);
  272  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NDM    = &fn0030.(line, 15, 20);
  273  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NDF    = &fn0030.(line, 20, 25);
  274  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NEN    = &fn0030.(line, 25, 30);
  275  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NAD    = &fn0030.(line, 30, 35);
  276  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  277  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("%s\n\n", HEAD);
  278  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     Number of nodal points        = %d\n", NUMNP);
  279  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     Number of elements            = %d\n", NUMEL);
  280  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     Number of material sets       = %d\n", NUMMAT);
  281  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     Dimension of coordinate space = %d\n", NDM);
  282  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     Degree of freedom/node        = %d\n", NDF);
  283  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     Nodes per element (maximum)   = %d\n", NEN);
  284  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     Extra D&period.O&period.F&period. to element       = %d\n", NAD);
  285  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  286  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  287  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Set pointers for allocation of data arrays            */:ehp1.
  288  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  289  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  290  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NEN1 = NEN + 1;
  291  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NST = NEN*NDF + NAD;         UL    = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.0&rbrk.&cont.
;
  292  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N0  = 0  + NST*2*IPR;        XL    = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N0&rbrk.&cont.
;
  293  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N1  = N0 + NEN*NDM*IPR;      TL    = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N1&rbrk.&cont.
;
  294  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N2  = N1 + NEN*IPR;          IDL   = (:hp3.int:ehp3.*)    (:hp3.void:ehp3.*) &amp.M&lbrk.N2&rbrk.&cont.
;
  295  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N3  = N2 + NST;              P     = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N3&rbrk.&cont.
;
  296  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N4  = N3 + NST*IPR;          S     = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N4&rbrk.&cont.
;
  297  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N5  = N4 + NST*NST*IPR;      IE    = (:hp3.int:ehp3.*)    (:hp3.void:ehp3.*) &amp.M&lbrk.N5&rbrk.&cont.
;
  298  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N6  = N5 + NUMMAT;           D     = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N6&rbrk.&cont.
;
  299  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N7  = N6 + 10*NUMMAT*IPR;    ID    = (:hp3.int:ehp3.*)    (:hp3.void:ehp3.*) &amp.M&lbrk.N7&rbrk.&cont.
;
  300  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N8  = N7 + NDF*NUMNP;        X     = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N8&rbrk.&cont.
;
  301  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N9  = N8 + NDM*NUMNP*IPR;    IX    = (:hp3.int:ehp3.*)    (:hp3.void:ehp3.*) &amp.M&lbrk.N9&rbrk.&cont.
;
  302  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N10 = N9 + NEN1*NUMEL;       F     = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N10&rbrk.&cont.
;
  303  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N11 = N10 + NDF*NUMNP*IPR;   T     = (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.N11&rbrk.&cont.
;
  304  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N12 = N11 + NUMNP*IPR;       JDIAG = (:hp3.int:ehp3.*)    (:hp3.void:ehp3.*) &amp.M&lbrk.N12&rbrk.&cont.
;
  305  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N13 = N12 + NDF*NUMNP;                                         
  306  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  307  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  308  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Check that sufficient memory exists                   */:ehp1.
  309  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  310  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  311  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0003.(N13);
  312  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0021.(UL, N12);
  313  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  314  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  315  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Call mesh input subroutine to read and print all mesh */:ehp1.
  316  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* data                                                  */:ehp1.
  317  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  318  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  319  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    III = 0;
  320  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0002.(IDL, IE, D, ID, X, IX, F, T, NDF, NDM, NEN1, III);
  321  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  322  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  323  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Establish profile of resulting equations for          */:ehp1.
  324  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* stiffness, mass, etc                                  */:ehp1.
  325  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  326  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  327  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0015.(JDIAG, ID, IX, NDF, NEN1, &amp.NAD);
  328  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  329  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  330  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Set pointers for solution arrays &amp. check for          */:ehp1.
  331  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* sufficient memory                                     */:ehp1.
  332  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
  333  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  334  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N13 = N12 + NEQ;                     B     = (:hp3.double:ehp3.*)  (:hp3.void:ehp3.*) &amp.M&lbrk.N13&rbrk.&cont.
;
  335  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    N14 = N13 + NEQ*IPR;                 DR    = (:hp3.double:ehp3.*)  (:hp3.void:ehp3.*) &amp.M&lbrk.N14&rbrk.&cont.
;
  336  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NE  = N14 + NUMNP*NDF*IPR;           CT    = (CONTROL*) (:hp3.void:ehp3.*) &amp.M&lbrk.NE&rbrk.&cont.
;
  337  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
  338  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0003.(NE);
  339  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0021.(B, NEQ);
  340  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  341  &bxv.   &bxv.   &bxv.   &bxll.}
  342  &bxv.   &bxv.   &bxv.   
  343  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(TITL, "MACR", 4) == 0)
  344  &bxv.   &bxv.   &bxv.   &bxul.{
  345  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
  346  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Call macro solu&cont.
tion module for establishing solution      */:ehp1.
  347  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* algorithm      &cont.
                                           */:ehp1.
  348  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
  349  &bxv.   &bxv.   &bxv.   &bxv.
  350  &bxv.   &bxv.   &bxv.   &bxv.    &fn0004.(UL, XL, TL, IDL, &cont.
P, S, IE, D, ID, X, IX, F, T, JDIAG, B,
  351  &bxv.   &bxv.   &bxv.   &bxv.          DR, CT, NDF,&cont.
 NDM, NEN1, NST, NE);
  352  &bxv.   &bxv.   &bxv.   &bxll.}
  353  &bxv.   &bxv.   &bxv.   
  354  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(TITL, "STOP", 4) == 0)
  355  &bxv.   &bxv.   &bxv.   &bxul.{
  356  &bxv.   &bxv.   &bxv.   &bxv.    more = FALSE;
  357  &bxv.   &bxv.   &bxv.   &bxll.}
  358  &bxv.   &bxv.   &bxv.   
  359  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (*TITL != 0)
  360  &bxv.   &bxv.   &bxv.   &bxul.{
  361  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERR&cont.
OR 52** Unexpected keyword '%s'\n", TITL);
  362  &bxv.   &bxv.   &bxv.   &bxv.    more = FALSE;
  363  &bxv.   &bxv.   &bxv.   &bxll.}
  364  &bxv.   &bxv.   &bxll.}
  365  &bxv.   &bxll.}
  366  &bxv.
  367  &bxv.    &fn0042.("main");
  368  &bxv.    :hp3.return:ehp3. 0;
  369  &bxll.}
  370   
.cp 114
  371   :hp1./*****************************************************************************/:ehp1.
  372   :hp1./*                                                                           */:ehp1.
  373   :hp1./* Generate real data arrays by linear interpolation                         */:ehp1.
  374   :hp1./*                                                                           */:ehp1.
  375   :hp1./*****************************************************************************/:ehp1.
  376   
  377   :hp3.void:ehp3. &fn0001.:spot id=sp0001.(:hp3.int:ehp3. NDM, :hp3.double:ehp3. *X, :hp3.char:ehp3. *title, :hp3.int:ehp3. PRT, :hp3.int:ehp3. *ERR)
:subject.GENVEC
  378  &bxul.{
  379  &bxv.    :hp3.int:ehp3.  more_input = TRUE, more = TRUE;
  380  &bxv.    :hp3.double:ehp3. XL&lbrk.7&rbrk. = {0&period.0};
  381  &bxv.    :hp3.int:ehp3. NN = 0;
  382  &bxv.    :hp3.int:ehp3. NG = 0;
  383  &bxv.
  384  &bxv.    &fn0041.("GENVEC");
  385  &bxv.
  386  &bxv.    *ERR = FALSE;
  387  &bxv.
  388  &bxv.    more_input = TRUE;
  389  &bxv.    :hp3.while:ehp3. (more_input)
  390  &bxv.   &bxul.{
  391  &bxv.   &bxv.    :hp3.char:ehp3. line&lbrk.LINE_LENGTH + 1&rbrk.&cont.
 = "", *data = NULL;
  392  &bxv.   &bxv.    :hp3.int:ehp3.  L = 0, LG = 0, LI = 0, i = 0, l = 0, n = 0;
  393  &bxv.   &bxv.
  394  &bxv.   &bxv.    L  = NN;                         l = L - 1;
  395  &bxv.   &bxv.    LG = NG;
  396  &bxv.   &bxv.
  397  &bxv.   &bxv.    data = &fn0045.(line);
  398  &bxv.   &bxv.    :hp3.if:ehp3. (data == NULL)
  399  &bxv.   &bxv.   &bxul.{
  400  &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERROR 55** Unexpected end-of-file\n"&cont.
);
  401  &bxv.   &bxv.   &bxv.    more_input = FALSE;
  402  &bxv.   &bxv.   &bxll.}
  403  &bxv.   &bxv.    :hp3.else:ehp3.
  404  &bxv.   &bxv.   &bxul.{
  405  &bxv.   &bxv.   &bxv.    NN = &fn0030.(line,  0,  5);     n = NN - 1;
  406  &bxv.   &bxv.   &bxv.    NG = &fn0030.(line,  5, 10);
  407  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < 7; i++)
  408  &bxv.   &bxv.   &bxv.        XL&lbrk.i&rbrk.&cont.
 = &fn0031.(line,  (10+10*i), (20+10*i));
  409  &bxv.   &bxv.   &bxv.   
  410  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. ((NN <= 0) || (NN > NUMNP))
  411  &bxv.   &bxv.   &bxv.        more_input = FALSE;
  412  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
  413  &bxv.   &bxv.   &bxv.   &bxul.{
  414  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < ND&cont.
M; i++)
  415  &bxv.   &bxv.   &bxv.   &bxv.        &fn0048.(X, n, i, NDM,&cont.
 XL&lbrk.i&rbrk.);
  416  &bxv.   &bxv.   &bxv.   &bxv.   
  417  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (LG != 0)
  418  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  419  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    LG = &fn0034.(LG,NN-L);
  420  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    LI =(&fn0049.(NN-L+LG)-1) / &fn0049.(LG);
  421  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  422  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (i = 0; i < NDM; i++)
  423  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
        XL&lbrk.i&rbrk. = ( &fn0050.(X, n, i, NDM) - &fn0050.(X, l, i, NDM) ) / LI;
  424  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  425  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    more = TRUE;
  426  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.while:ehp3. (more)
  427  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
  428  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    L = L + LG;          l = L - 1;
  429  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   
  430  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. ((NN-L)*LG > 0)
  431  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
  432  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.if:ehp3. ((L <= 0) || (L > NUMNP))
  433  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxul.{
  434  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERROR 02** Attempt to generate no&cont.
de %d in %s\n", L, title);
  435  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    *ERR  = TRUE;
  436  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    more = FALSE;
  437  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxll.}
  438  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.else:ehp3.
  439  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxul.{
  440  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NDM; i++)
  441  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.        &fn0048.(X, l, i, NDM, &fn0050.(X, l-LG, i, NDM) + XL&lbrk.&cont.
i&rbrk.);
  442  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxll.}
  443  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
  444  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.else:ehp3.
  445  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.        more = FALSE;
  446  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
  447  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  448  &bxv.   &bxv.   &bxv.   &bxll.}
  449  &bxv.   &bxv.   &bxll.}
  450  &bxv.   &bxll.}
  451  &bxv.
  452  &bxv.    :hp3.if:ehp3. (PRT &amp.&amp. !(*ERR))
  453  &bxv.   &bxul.{
  454  &bxv.   &bxv.    :hp3.int:ehp3. I = 0, J = 0, j = 0, L = 0, l = 0;
  455  &bxv.   &bxv.
  456  &bxv.   &bxv.    :hp3.for:ehp3. (I = 1; I <= NUMNP; I += 50)
  457  &bxv.   &bxv.   &bxul.{
  458  &bxv.   &bxv.   &bxv.    &fn0044.(O);
  459  &bxv.   &bxv.   &bxv.    &fn0044.("%s\n\n     NODAL%s\n\n      NODE", HEAD, title);
  460  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (L = 1; L <= NDM; L++) &fn0044.("%7d%6&period.&cont.
6s", L, title);
  461  &bxv.   &bxv.   &bxv.    &fn0044.("\n");
  462  &bxv.   &bxv.   &bxv.
  463  &bxv.   &bxv.   &bxv.    NN = &fn0051.(NUMNP, I + 49);
  464  &bxv.   &bxv.   &bxv.    
  465  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (J = I, j = J - 1; J <= NN; J++, j = J - 1)
  466  &bxv.   &bxv.   &bxv.   &bxul.{
  467  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0050.(X, j, 0, NDM)&cont.
 == BLANK)
  468  &bxv.   &bxv.   &bxv.   &bxv.        &fn0044.("%d Has not b&cont.
een input or generated\n", J);
  469  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
  470  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  471  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("%10d", J);
  472  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (l = 0; l < NDM; l++) &fn0044.("%13&period.4lf", &fn0050.(X, j, l, NDM));
  473  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("\n");
  474  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  475  &bxv.   &bxv.   &bxv.   &bxll.}
  476  &bxv.   &bxv.   &bxll.}
  477  &bxv.   &bxll.}
  478  &bxv.
  479  &bxv.    &fn0042.("GENVEC");
  480  &bxv.    :hp3.return:ehp3.;
  481  &bxll.}
  482   
.cp 312
  483   :hp1./*****************************************************************************/:ehp1.
  484   :hp1./*                                                                           */:ehp1.
  485   :hp1./* Data input routine for mesh description                                   */:ehp1.
  486   :hp1./*                                                                           */:ehp1.
  487   :hp1./*****************************************************************************/:ehp1.
  488   
  489   :hp3.void:ehp3. &fn0002.:spot id=sp0002.(:hp3.int:ehp3. *IDL, :hp3.int:ehp3. *IE, :hp3.double:ehp3. *D, :hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *F, :hp3.double:ehp3. *T,
:subject.PMESH
  490              :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. III)
  491  &bxul.{
  492  &bxv.    :hp3.int:ehp3.    PRT = TRUE, ERR = FALSE, loop = TRUE;
  493  &bxv.    :hp3.double:ehp3. XL&lbrk.3&rbrk. = {0&period.0}, FL&lbrk.&cont.
6&rbrk. = {0&period.0};
  494  &bxv.    :hp3.int:ehp3.    I = 0, i = 0, J = 0, K = 0, k = 0, L = 0, l = 0, NN = 0, n = 0;
  495  &bxv.    :hp3.char:ehp3.   buffer&lbrk.LINE_LENGTH + 1&rbrk. = "", line&lbrk.&cont.
LINE_LENGTH + 1&rbrk. = "", *XHED = NULL;
  496  &bxv.
  497  &bxv.    &fn0041.("PMESH");
  498  &bxv.
  499  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  500  &bxv.    :hp1./* Initialise arrays                                                     */:ehp1.
  501  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  502  &bxv.
  503  &bxv.    :hp3.if:ehp3. (III >= 0)
  504  &bxv.   &bxul.{
  505  &bxv.   &bxv.    :hp3.for:ehp3. (n = 0; n < NUMNP; n++)
  506  &bxv.   &bxv.   &bxul.{
  507  &bxv.   &bxv.   &bxv.    T&lbrk.n&rbrk.&cont.
 = 0&period.0;
  508  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NDF; i++)
  509  &bxv.   &bxv.   &bxv.   &bxul.{
  510  &bxv.   &bxv.   &bxv.   &bxv.    &fn0048.(ID, n, i, NDF, 0)&cont.
;
  511  &bxv.   &bxv.   &bxv.   &bxv.    &fn0048.(F,  n, i, NDF, 0&period.&cont.
0);
  512  &bxv.   &bxv.   &bxv.   &bxll.}
  513  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NDM; i++)
  514  &bxv.   &bxv.   &bxv.        &fn0048.(X,  n, i, NDM, BLANK);
  515  &bxv.   &bxv.   &bxll.}
  516  &bxv.   &bxll.}
  517  &bxv.
  518  &bxv.    loop = TRUE;
  519  &bxv.    :hp3.while:ehp3. (loop)
  520  &bxv.   &bxul.{
  521  &bxv.   &bxv.    :hp3.char:ehp3. *CC = &fn0045.(line);
  522  &bxv.   &bxv.
  523  &bxv.   &bxv.    :hp3.if:ehp3. (CC == NULL)
  524  &bxv.   &bxv.   &bxul.{
  525  &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERROR 53** Unexpected end-of-file\n"&cont.
);
  526  &bxv.   &bxv.   &bxv.    loop = FALSE;
  527  &bxv.   &bxv.   &bxll.}
  528  &bxv.   &bxv.    :hp3.else:ehp3.
  529  &bxv.   &bxv.   &bxul.{
  530  &bxv.   &bxv.   &bxv.    CC = &fn0033.(CC);
  531  &bxv.   &bxv.   &bxv.
  532  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  533  &bxv.   &bxv.   &bxv.    :hp1./* Nodal coordinate data input                     &cont.
              */:ehp1.
  534  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  535  &bxv.   &bxv.   &bxv.   
  536  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0046.(CC, "COOR", 4) == 0)
  537  &bxv.   &bxv.   &bxv.   &bxul.{
  538  &bxv.   &bxv.   &bxv.   &bxv.    &fn0001.(NDM, X, CD, PRT, &cont.
&amp.ERR);
  539  &bxv.   &bxv.   &bxv.   &bxll.}
  540  &bxv.   &bxv.   &bxv.   
  541  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  542  &bxv.   &bxv.   &bxv.    :hp1./* Element data input                              &cont.
              */:ehp1.
  543  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  544  &bxv.   &bxv.   &bxv.   
  545  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "ELEM", 4) == 0)
  546  &bxv.   &bxv.   &bxv.   &bxul.{
  547  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. LK = 0, LX = 0&cont.
, NX = 0;
  548  &bxv.   &bxv.   &bxv.   &bxv.
  549  &bxv.   &bxv.   &bxv.   &bxv.    L = 0;      l = L &cont.
- 1;
  550  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (I = 1, i = I &cont.
- 1; (I <= NUMEL) &amp.&amp. loop; I += 50, i = I - 1)
  551  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  552  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (PRT)
  553  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
  554  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.(O);
  555  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("%s\n\n     Elements\n\n   Element  Material", HEAD);
  556  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.for:ehp3. (K = 1; K <= NEN; K++) &fn0044.("%3d Node", K);
  557  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("\n");
  558  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
  559  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  560  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    J = &fn0051.(NUMEL, I + 49);
  561  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  562  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (NN = I, n = NN - 1; (NN <= J) &amp.&amp. loop; NN++, n = NN - 1)
  563  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
  564  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. ((L-NN) < 0)
  565  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
  566  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.char:ehp3. *data = &fn0045.(line);
  567  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.
  568  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.if:ehp3. (data == NULL)
  569  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxul.{
  570  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERROR 56** Unexpected end-of-file&cont.
\n");
  571  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    loop = FALSE;
  572  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxll.}
  573  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.else:ehp3.
  574  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxul.{
  575  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    L  = &fn0030.(line,  0,  5);         l = L - 1;
  576  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    LK = &fn0030.(line,  5, 10);
  577  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NEN; k++) IDL&lbrk.&cont.
k&rbrk. = &fn0030.(line, (10+5*k), (15+5*k));
  578  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    LX = &fn0030.(line, (10+5*NEN), (15+5*NEN));
  579  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   
  580  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (L  == 0) { L  = NUMEL + 1;       l = L - 1; &cont.
}
  581  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (LX == 0)   LX = 1;
  582  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. ((L-NN) < 0)
  583  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxul.{
  584  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("     **ERROR &cont.
03** Element %d appears after element %d\n", L, NN);
  585  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.    ERR = TRUE;
  586  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxll.}
  587  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxll.}
  588  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
  589  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   
  590  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. (loop &amp.&amp. ((L-NN) == 0))
  591  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
  592  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    NX = LX;
  593  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   
  594  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NEN; k++)
  595  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.        &fn0048.(IX, l, k, NEN1, IDL&lbrk.k&rbrk.&cont.
);
  596  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.
  597  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    &fn0048.(IX, l, NEN1-1, NEN1, LK);
  598  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
  599  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.
  600  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (loop &amp.&amp. ((L-NN) > 0))
  601  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
  602  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    &fn0048.(IX, n, NEN1-1, NEN1, &fn0050.(IX, n-1, NEN1-1, NEN1));
  603  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.
  604  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NEN; k++)
  605  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxul.{
  606  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0050.(IX, n-1, k, NEN1) == 0)
  607  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.        &fn0048.(IX, n, k, NEN1, 0);
  608  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
  609  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.        &fn0048.(IX, n, k, NEN1, &fn0050.(IX, n-1, k, NEN1) + NX);
  610  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxll.}
  611  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
  612  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.
  613  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. (loop &amp.&amp. PRT &amp.&amp.&cont.
 !ERR)
  614  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
  615  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    &fn0044.("%10d%10d", NN, &fn0050.(IX, n, NEN1-1, NEN1));
  616  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NEN; k++) &fn0044.("%8d", &fn0050.(IX, n, k, NEN1));
  617  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    &fn0044.("\n");
  618  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
  619  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
  620  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  621  &bxv.   &bxv.   &bxv.   &bxll.}
  622  &bxv.   &bxv.   &bxv.   
  623  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  624  &bxv.   &bxv.   &bxv.    :hp1./* Material data input                             &cont.
              */:ehp1.
  625  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  626  &bxv.   &bxv.   &bxv.   
  627  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "MATE", 4) == 0)
  628  &bxv.   &bxv.   &bxv.   &bxul.{
  629  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.(O);
  630  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("%s\n\n     Mater&cont.
ial Properties\n", HEAD);
  631  &bxv.   &bxv.   &bxv.   &bxv.
  632  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (n = 0; n < NU&cont.
MMAT; n++)
  633  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  634  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. ma = 0, NST = 0;
  635  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. DUM = 0&period.0, S = 0&period.0, P = 0&period.0;
  636  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  637  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0045.(line);
  638  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    MA      = &fn0030.   (line,  0,  5);   ma  = MA  - 1;
  639  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    IEL     = &fn0030.   (line,  5, 10);
  640  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    XHED    = &fn0032.(line, 10, 80, buffer);
  641  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  642  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("\n     Material set %d for element type %d - %s\n\n", MA, IEL, &fn0033.(XHED));
  643  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  644  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    IE&lbrk.ma&rbrk. = IEL;
  645  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0008.(&amp.D&lbrk.ma&rbrk., &amp.DUM, X, IX, T, &amp.&cont.
S, &amp.P, NDF, NDM, NST, 1);
  646  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  647  &bxv.   &bxv.   &bxv.   &bxll.}
  648  &bxv.   &bxv.   &bxv.   
  649  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  650  &bxv.   &bxv.   &bxv.    :hp1./* Read in the restraint conditions for each node  &cont.
              */:ehp1.
  651  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  652  &bxv.   &bxv.   &bxv.   
  653  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "BOUN", 4) == 0)
  654  &bxv.   &bxv.   &bxv.   &bxul.{
  655  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. more = TRUE, m&cont.
ore_input = TRUE, found = TRUE, NG = 0, LG = 0;
  656  &bxv.   &bxv.   &bxv.   &bxv.
  657  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (PRT)
  658  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  659  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.(O);
  660  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("%s\n\n     NODAL B&period.C&period.\n\n      NODE", HEAD);
  661  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (I = 1; I <= NDF; I++) &fn0044.("%7d%6&period.6s", I, BC);
  662  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("\n");
  663  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  664  &bxv.   &bxv.   &bxv.   &bxv.
  665  &bxv.   &bxv.   &bxv.   &bxv.    III = 1;
  666  &bxv.   &bxv.   &bxv.   &bxv.    NN   = 0;
  667  &bxv.   &bxv.   &bxv.   &bxv.    NG  = 0;
  668  &bxv.   &bxv.   &bxv.   &bxv.
  669  &bxv.   &bxv.   &bxv.   &bxv.    more_input = TRUE;
  670  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.while:ehp3. (more_input)
  671  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  672  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    L  = NN;          l = L - 1;
  673  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    LG = NG;
  674  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  675  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0045.(line);
  676  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NN  = &fn0030.(line,  0,  5);   n = NN - 1;
  677  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    NG  = &fn0030.(line,  5, 10);
  678  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (i = 0; i < 6; i++)
  679  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
        IDL&lbrk.i&rbrk. = &fn0030.(line, 10 + 5*i, 15 + 5*i);
  680  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
  681  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. ((NN <= 0) || (NN > NUMNP))
  682  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
        more_input = FALSE;
  683  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.else:ehp3.
  684  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
  685  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.for:ehp3. (i = 0; i < NDF; i++)
  686  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
  687  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.if:ehp3. ((L != 0) &amp.&amp. (IDL&lbrk.&cont.
i&rbrk. == 0) &amp.&amp. (&fn0050.(ID, l, i, NDF) < 0))
  688  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.        &fn0048.(ID, n, i, NDF, -1);
  689  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.else:ehp3.
  690  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.        &fn0048.(ID, n, i, NDF, IDL&lbrk.i&rbrk.&cont.
);
  691  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
  692  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   
  693  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    LG = &fn0034.(LG, NN-L);
  694  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   
  695  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    more = TRUE;
  696  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.while:ehp3. (more)
  697  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
  698  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    L = L + LG;          l = L - 1; 
  699  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.
  700  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.if:ehp3. ((NN-L)*LG <= 0)
  701  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.        more = FALSE;
  702  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.else:ehp3.
  703  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxul.{
  704  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NDF; i++)
  705  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.        :hp3.if:ehp3. (&fn0050.(ID, l-LG, i, NDF) < 0)    &fn0048.(ID, l, i, ND&cont.
F, -1);
  706  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxll.}
  707  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
  708  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
  709  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  710  &bxv.   &bxv.   &bxv.   &bxv.       
  711  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (NN = 1, n = N&cont.
N - 1; NN <= NUMNP; NN++, n = NN - 1)
  712  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  713  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    found = FALSE;
  714  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (i = 0; (i < NDF) &amp.&amp. !found; i++)
  715  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
        :hp3.if:ehp3. (&fn0050.(ID, n, i, NDF) != 0) found = TRUE;
  716  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    
  717  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (PRT &amp.&amp. found)
  718  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
  719  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("%10d", NN);
  720  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.for:ehp3. (i = 0; i < NDF; i++)
  721  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.        &fn0044.("%13d", &fn0050.(ID, n, i, NDF));
  722  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("\n");
  723  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
  724  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  725  &bxv.   &bxv.   &bxv.   &bxll.}
  726  &bxv.   &bxv.   &bxv.   
  727  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  728  &bxv.   &bxv.   &bxv.    :hp1./* Force/displacement data input                   &cont.
              */:ehp1.
  729  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  730  &bxv.   &bxv.   &bxv.   
  731  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "FORC", 4) == 0)
  732  &bxv.   &bxv.   &bxv.   &bxul.{
  733  &bxv.   &bxv.   &bxv.   &bxv.    &fn0001.(NDF, F, FD, PRT, &cont.
&amp.ERR);
  734  &bxv.   &bxv.   &bxv.   &bxll.}
  735  &bxv.   &bxv.   &bxv.   
  736  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  737  &bxv.   &bxv.   &bxv.    :hp1./* Temperature data input                          &cont.
              */:ehp1.
  738  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  739  &bxv.   &bxv.   &bxv.   
  740  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "TEMP", 4) == 0)
  741  &bxv.   &bxv.   &bxv.   &bxul.{
  742  &bxv.   &bxv.   &bxv.   &bxv.    &fn0001.(1, T, TE, PRT, &amp.&cont.
ERR);
  743  &bxv.   &bxv.   &bxv.   &bxll.}
  744  &bxv.   &bxv.   &bxv.   
  745  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  746  &bxv.   &bxv.   &bxv.    :hp1./* "END "                                          &cont.
              */:ehp1.
  747  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  748  &bxv.   &bxv.   &bxv.   
  749  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "END", 3) == 0)
  750  &bxv.   &bxv.   &bxv.   &bxul.{
  751  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (ERR) &fn0052.(1);
  752  &bxv.   &bxv.   &bxv.   &bxv.    loop = FALSE;
  753  &bxv.   &bxv.   &bxv.   &bxll.}
  754  &bxv.   &bxv.   &bxv.   
  755  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  756  &bxv.   &bxv.   &bxv.    :hp1./* "PRIN",                                         &cont.
              */:ehp1.
  757  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  758  &bxv.   &bxv.   &bxv.   
  759  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "PRIN", 4) == 0)
  760  &bxv.   &bxv.   &bxv.   &bxul.{
  761  &bxv.   &bxv.   &bxv.   &bxv.    PRT = TRUE;
  762  &bxv.   &bxv.   &bxv.   &bxll.}
  763  &bxv.   &bxv.   &bxv.   
  764  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  765  &bxv.   &bxv.   &bxv.    :hp1./* "NOPR",                                         &cont.
              */:ehp1.
  766  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  767  &bxv.   &bxv.   &bxv.   
  768  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "NOPR", 4) == 0)
  769  &bxv.   &bxv.   &bxv.   &bxul.{
  770  &bxv.   &bxv.   &bxv.   &bxv.    PRT = FALSE;
  771  &bxv.   &bxv.   &bxv.   &bxll.}
  772  &bxv.   &bxv.   &bxv.   
  773  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  774  &bxv.   &bxv.   &bxv.    :hp1./* "PAGE",                                         &cont.
              */:ehp1.
  775  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
  776  &bxv.   &bxv.   &bxv.   
  777  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CC, "PAGE", 4) == 0)
  778  &bxv.   &bxv.   &bxv.   &bxul.{
  779  &bxv.   &bxv.   &bxv.   &bxv.    &fn0047.(O, &fn0033.(&fn0045.(line)));
  780  &bxv.   &bxv.   &bxv.   &bxll.}
  781  &bxv.   &bxv.   &bxv.   
  782  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (*CC != 0)
  783  &bxv.   &bxv.   &bxv.   &bxul.{
  784  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERR&cont.
OR 54** Unexpected keyword '%s'\n", CC);
  785  &bxv.   &bxv.   &bxv.   &bxv.    loop = FALSE;
  786  &bxv.   &bxv.   &bxv.   &bxll.}
  787  &bxv.   &bxv.   &bxll.}
  788  &bxv.   &bxll.}
  789  &bxv.
  790  &bxv.    &fn0042.("PMESH");
  791  &bxll.}
  792   
.cp 23
  793   :hp1./*****************************************************************************/:ehp1.
  794   :hp1./*                                                                           */:ehp1.
  795   :hp1./* Monitor available memory in blank common                                  */:ehp1.
  796   :hp1./*                                                                           */:ehp1.
  797   :hp1./*****************************************************************************/:ehp1.
  798   
  799   :hp3.void:ehp3. &fn0003.:spot id=sp0003.(:hp3.int:ehp3. J)
:subject.SETMEM
  800  &bxul.{
  801  &bxv.    :hp3.int:ehp3. K = J;
  802  &bxv.
  803  &bxv.    :hp3.if:ehp3. (K > MAX)
  804  &bxv.   &bxul.{
  805  &bxv.   &bxv.    &fn0044.("**ERROR 01** Insufficient storage in blank common\n");
  806  &bxv.   &bxv.    &fn0044.("                 required  = %d\n", K);
  807  &bxv.   &bxv.    &fn0044.("                 available = %d\n", MAX);
  808  &bxv.   &bxv.    &fn0052.(1);
  809  &bxv.   &bxll.}
  810  &bxv.
  811  &bxv.    :hp3.return:ehp3.;
  812  &bxll.}
  813   
.cp 561
  814   :hp1./******************************************************************************
:ehp1.  815:hp1.   *******************************************************************************
:ehp1.  816:hp1.   *******************************************************************************
:ehp1.  817:hp1.   *                                                                             *
:ehp1.  818:hp1.   * SOLUTION AND OUTPUT MODULES                                                 *
:ehp1.  819:hp1.   *                                                                             *
:ehp1.  820:hp1.   *******************************************************************************
:ehp1.  821:hp1.   *******************************************************************************
:ehp1.  822:hp1.   ******************************************************************************/:ehp1.
  823    
  824   
  825   
  826   
  827   :hp1./*****************************************************************************/:ehp1.
  828   :hp1./*                                                                           */:ehp1.
  829   :hp1./* Macro instruction subprogram                                              */:ehp1.
  830   :hp1./*                                                                           */:ehp1.
  831   :hp1./* Controls problem solution and output algorithms by order of specifying    */:ehp1.
  832   :hp1./* macro commands in array wd&period.                                               */:ehp1.
  833   :hp1./*                                                                           */:ehp1.
  834   :hp1./*****************************************************************************/:ehp1.
  835   
  836   :hp3.void:ehp3. &fn0004.:spot id=sp0004.(:hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.double:ehp3. *TL, :hp3.int:ehp3. *LD, :hp3.double:ehp3. *P, :hp3.double:ehp3. *S,
:subject.PMACR
  837              :hp3.int:ehp3. *IE, :hp3.double:ehp3. *D, :hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *F, :hp3.double:ehp3. *T,
  838              :hp3.int:ehp3. *JDIAG, :hp3.double:ehp3. *B, :hp3.double:ehp3. *DR, CONTROL *CT, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM,
  839              :hp3.int:ehp3. NEN1, :hp3.int:ehp3. NST, :hp3.int:ehp3. NEND)
  840  &bxul.{
  841  &bxv.    :hp3.int:ehp3.    AFR = 0, BFR = 0, CFR = 0, AFL = 0, BFL = 0, CFL = 0, DFL = 0, EFL = 0, FFL = 0, GFL = 0;
  842  &bxv.    :hp3.char:ehp3.   line&lbrk.LINE_LENGTH + 1&rbrk. = "";
  843  &bxv.    :hp3.double:ehp3. RNMAX = 0&period.0, TOL = 0&period.0, UN = 0&period.&cont.
0;
  844  &bxv.    :hp3.int:ehp3.    LL = 0, ll = 0, NNEQ = 0, NPLD = 0, LMAX = 0, more  = 0;
  845  &bxv.    :hp3.int:ehp3.    LX = 0, L = 0, l = 0, I = 0, K = 0, J = 0, i = 0, LV = 0, lv = 0, lx = 0;
  846  &bxv.    :hp3.int:ehp3.    NA = 0, NC = 1, NM = 0, NN = 0, NV = 0;
  847  &bxv.    :hp3.int:ehp3.    NQ = 0, NR = 0, NE = 0;
  848  &bxv.    :hp3.int:ehp3.    LVE&lbrk.9&rbrk. = {0}, LVS&lbrk.9&rbrk.&cont.
 = {0};
  849  &bxv.
  850  &bxv.    &fn0041.("PMACR");
  851  &bxv.
  852  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  853  &bxv.    :hp1./* Set initial values of parameters                                      */:ehp1.
  854  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  855  &bxv.
  856  &bxv.    DT    = 0&period.0;
  857  &bxv.    PROP  = 1&period.0;
  858  &bxv.    RNMAX = 0&period.0;
  859  &bxv.    TIME  = 0&period.0;
  860  &bxv.    TOL   = 1&period.E-9;
  861  &bxv.    UN    = 0&period.0;
  862  &bxv.    AFL   = TRUE;
  863  &bxv.    AFR   = FALSE;
  864  &bxv.    BFL   = TRUE;
  865  &bxv.    BFR   = FALSE;
  866  &bxv.    CFL   = TRUE;
  867  &bxv.    CFR   = FALSE;
  868  &bxv.    DFL   = TRUE;
  869  &bxv.    EFL   = TRUE;
  870  &bxv.    FFL   = FALSE;
  871  &bxv.    GFL   = TRUE;
  872  &bxv.    NE    = NEND;
  873  &bxv.    NNEQ  = NDF * NUMNP;
  874  &bxv.    NPLD  = 0;
  875  &bxv.
  876  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  877  &bxv.    :hp1./* Read macro cards                                                      */:ehp1.
  878  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  879  &bxv.
  880  &bxv.    &fn0044.(O);
  881  &bxv.    &fn0044.("%s\n\n", HEAD);
  882  &bxv.    &fn0044.("     Macro instructions\n\n");
  883  &bxv.    &fn0044.("     Macro statement     Variable 1     Variable 2\n");
  884  &bxv.
  885  &bxv.    LL = 1;                  ll = LL - 1;
  886  &bxv.    LMAX = 16;
  887  &bxv.    &fn0003.(NE + LMAX*4*IPR);
  888  &bxv.
  889  &bxv.    &fn0047.(CT&lbrk.ll&rbrk.&period.s1, "LOOP");
  890  &bxv.    CT&lbrk.ll&rbrk.&period.d1 = 1&period.&cont.
0;
  891  &bxv.
  892  &bxv.    more = TRUE;
  893  &bxv.    :hp3.while:ehp3. (more)
  894  &bxv.   &bxul.{
  895  &bxv.   &bxv.    :hp3.char:ehp3. *data = NULL;
  896  &bxv.   &bxv.    LL = LL + 1;         ll = LL - 1;
  897  &bxv.   &bxv.
  898  &bxv.   &bxv.    :hp3.if:ehp3. (LL >= LMAX)
  899  &bxv.   &bxv.   &bxul.{
  900  &bxv.   &bxv.   &bxv.    LMAX = LMAX + 16;
  901  &bxv.   &bxv.   &bxv.    &fn0003.(NE + LMAX*4*IPR);
  902  &bxv.   &bxv.   &bxll.}
  903  &bxv.   &bxv.
  904  &bxv.   &bxv.    &fn0053.(line , 0, :hp3.sizeof:ehp3.(line));
  905  &bxv.   &bxv.    data = &fn0045.(line);
  906  &bxv.   &bxv.
  907  &bxv.   &bxv.    :hp3.if:ehp3. (data == NULL)
  908  &bxv.   &bxv.   &bxul.{
  909  &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERROR 57** Unexpected end-of-file\n"&cont.
);
  910  &bxv.   &bxv.   &bxv.    more = FALSE;
  911  &bxv.   &bxv.   &bxll.}
  912  &bxv.   &bxv.    :hp3.else:ehp3.
  913  &bxv.   &bxv.   &bxul.{
  914  &bxv.   &bxv.   &bxv.    &fn0053.(&amp.CT&lbrk.&cont.
ll&rbrk., 0, :hp3.sizeof:ehp3.(CONTROL));
  915  &bxv.   &bxv.   &bxv.    &fn0054.(CT&lbrk.ll&rbrk.&cont.
&period.s1, &amp.line&lbrk.0&rbrk., 4);
  916  &bxv.   &bxv.   &bxv.    &fn0054.(CT&lbrk.ll&rbrk.&cont.
&period.s2, &amp.line&lbrk.5&rbrk., 4);
  917  &bxv.   &bxv.   &bxv.    CT&lbrk.ll&rbrk.&cont.
&period.d1 = &fn0030.(line, 10, 25);
  918  &bxv.   &bxv.   &bxv.    CT&lbrk.ll&rbrk.&cont.
&period.d2 = &fn0030.(line, 25, 40);
  919  &bxv.   &bxv.   &bxv.   
  920  &bxv.   &bxv.   &bxv.    &fn0044.("          %-4&period.4s %-4&cont.
&period.4s %15&period.5lf %15&period.5lf\n", CT&lbrk.ll&rbrk.&cont.
&period.s1, CT&lbrk.ll&rbrk.&period.s2, CT&lbrk.&cont.
ll&rbrk.&period.d1, CT&lbrk.ll&rbrk.&period.&cont.
d2);
  921  &bxv.   &bxv.   &bxv.   
  922  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0046.(CT&lbrk.ll&rbrk.&cont.
&period.s1, "END", 3) == 0)   more = FALSE;
  923  &bxv.   &bxv.   &bxll.}
  924  &bxv.   &bxll.}
  925  &bxv.
  926  &bxv.    &fn0047.(CT&lbrk.ll&rbrk.&period.s1, "NEXT");
  927  &bxv.
  928  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  929  &bxv.    :hp1./* Set loop markers                                                      */:ehp1.
  930  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  931  &bxv.
  932  &bxv.    NE = NE + LMAX * 4 * IPR;
  933  &bxv.    LX = LL - 1;
  934  &bxv.    :hp3.for:ehp3. (L = 1, l = L - 1; L <= LX; L++, l = L - 1)
  935  &bxv.   &bxul.{
  936  &bxv.   &bxv.    :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "LOOP", 4) == 0)
  937  &bxv.   &bxv.   &bxul.{
  938  &bxv.   &bxv.   &bxv.    J = 1;
  939  &bxv.   &bxv.   &bxv.    K = L + 1;
  940  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (I = K, i = I - 1; (I <= LL) &amp.&cont.
&amp. (J != 0); I++, i = I - 1)
  941  &bxv.   &bxv.   &bxv.   &bxul.{
  942  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3.      (&fn0046.(CT&lbrk.&cont.
i&rbrk.&period.s1, "LOOP", 4) == 0) J = J + 1;
  943  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.&cont.
i&rbrk.&period.s1, "NEXT", 4) == 0) J = J - 1;
  944  &bxv.   &bxv.   &bxv.   &bxv.   
  945  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (J > 9)
  946  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
  947  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     **FATAL ERROR 11** Loops nested deeper than 8\n");
  948  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.return:ehp3.;
  949  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
  950  &bxv.   &bxv.   &bxv.   &bxll.}
  951  &bxv.   &bxv.   &bxv.
  952  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (J != 0)
  953  &bxv.   &bxv.   &bxv.   &bxul.{
  954  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERR&cont.
OR 10** Unbalanced loop/next macros\n");
  955  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.return:ehp3.;
  956  &bxv.   &bxv.   &bxv.   &bxll.}
  957  &bxv.   &bxv.   &bxv.
  958  &bxv.   &bxv.   &bxv.    CT&lbrk.i&rbrk.&cont.
&period.d2 = (:hp3.double:ehp3.) L;
  959  &bxv.   &bxv.   &bxv.    CT&lbrk.l&rbrk.&cont.
&period.d2 = (:hp3.double:ehp3.) I;
  960  &bxv.   &bxv.   &bxll.}
  961  &bxv.   &bxll.}
  962  &bxv.
  963  &bxv.    J = 0;
  964  &bxv.
  965  &bxv.    :hp3.for:ehp3. (l = 0; l < LL; l++)
  966  &bxv.   &bxul.{
  967  &bxv.   &bxv.    :hp3.if:ehp3.      (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "LOOP", 4) == 0) J = J + 1;
  968  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "NEXT", 4) == 0) J = J - 1;
  969  &bxv.   &bxll.}
  970  &bxv.
  971  &bxv.    :hp3.if:ehp3. (J != 0)
  972  &bxv.   &bxul.{
  973  &bxv.   &bxv.    &fn0044.("     **FATAL ERROR 10** Unbalanced loop/next macros\n");
  974  &bxv.   &bxv.    :hp3.return:ehp3.;
  975  &bxv.   &bxll.}
  976  &bxv.
  977  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  978  &bxv.    :hp1./* Execute macro instruction program                                     */:ehp1.
  979  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
  980  &bxv.
  981  &bxv.    LV = 0;
  982  &bxv.    L  = 1;                            l = L - 1;
  983  &bxv.
  984  &bxv.    more = TRUE;
  985  &bxv.    :hp3.while:ehp3. (more)
  986  &bxv.   &bxul.{
  987  &bxv.   &bxv.    I = L - 1;                     i = I - 1;
  988  &bxv.   &bxv.  
  989  &bxv.   &bxv.    :hp3.if:ehp3. ((L != 1) &amp.&amp. (L != LL))
  990  &bxv.   &bxv.   &bxul.{
  991  &bxv.   &bxv.   &bxv.    &fn0044.("  **Macro instruction %4d executed**  ", I);
  992  &bxv.   &bxv.   &bxv.    &fn0044.("  %-4&period.4s %-4&period.&cont.
4s %15&period.5lf %15&period.5lf\n", CT&lbrk.l&rbrk.&period.&cont.
s1, CT&lbrk.l&rbrk.&period.s2, CT&lbrk.l&rbrk.&cont.
&period.d1, CT&lbrk.l&rbrk.&period.d2);
  993  &bxv.   &bxv.   &bxll.}
  994  &bxv.   &bxv.
  995  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
  996  &bxv.   &bxv.    :hp1./* Set solution tolerance                                            */:ehp1.
  997  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
  998  &bxv.   &bxv.  
  999  &bxv.   &bxv.    :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "TOL", 3) == 0)
 1000  &bxv.   &bxv.   &bxul.{
 1001  &bxv.   &bxv.   &bxv.    TOL = CT&lbrk.l&rbrk.&cont.
&period.d1;
 1002  &bxv.   &bxv.   &bxll.}
 1003  &bxv.   &bxv.  
 1004  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1005  &bxv.   &bxv.    :hp1./* Set time increment                                                */:ehp1.
 1006  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1007  &bxv.   &bxv.
 1008  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "DT", 2) == 0)
 1009  &bxv.   &bxv.   &bxul.{
 1010  &bxv.   &bxv.   &bxv.    DT = CT&lbrk.l&rbrk.&cont.
&period.d1;
 1011  &bxv.   &bxv.   &bxll.}
 1012  &bxv.   &bxv.  
 1013  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1014  &bxv.   &bxv.    :hp1./* Print stress values                                               */:ehp1.
 1015  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1016  &bxv.   &bxv.  
 1017  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "STRE", 4) == 0)
 1018  &bxv.   &bxv.   &bxul.{
 1019  &bxv.   &bxv.   &bxv.    LX = LVE&lbrk.lv&rbrk.&cont.
;              lx = LX - 1;
 1020  &bxv.   &bxv.   &bxv.
 1021  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0035.(CT&lbrk.lx&rbrk.&cont.
&period.d1, &fn0055.(CT&lbrk.l&rbrk.&period.d1, 1&period.&cont.
0)) == 0&period.0)
 1022  &bxv.   &bxv.   &bxv.   &bxul.{
 1023  &bxv.   &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P&cont.
, S, IE, D, ID, X, IX, F, T, JDIAG, DR, DR, DR,
 1024  &bxv.   &bxv.   &bxv.   &bxv.          NDF, NDM, NE&cont.
N1, NST, 4, B, (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.NV&rbrk., FALSE, FALSE, FALSE, FA&cont.
LSE);
 1025  &bxv.   &bxv.   &bxv.   &bxll.}
 1026  &bxv.   &bxv.   &bxll.}
 1027  &bxv.   &bxv.  
 1028  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1029  &bxv.   &bxv.    :hp1./* Print displacement                                                */:ehp1.
 1030  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1031  &bxv.   &bxv.  
 1032  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "DISP", 4) == 0)
 1033  &bxv.   &bxv.   &bxul.{
 1034  &bxv.   &bxv.   &bxv.    LX = LVE&lbrk.lv&rbrk.&cont.
;              lx = LX - 1;
 1035  &bxv.   &bxv.   &bxv.
 1036  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0035.(CT&lbrk.lx&rbrk.&cont.
&period.d1, &fn0055.(CT&lbrk.l&rbrk.&period.d1, 1&period.&cont.
0)) == 0&period.0)
 1037  &bxv.   &bxv.   &bxv.   &bxul.{
 1038  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.(O);
 1039  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("%s\n\n", HEAD);
 1040  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("          Time %&cont.
13&period.5lf\n\n", TIME);
 1041  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("     Proportiona&cont.
l Load %13&period.5lf\n", PROP);
 1042  &bxv.   &bxv.   &bxv.   &bxv.
 1043  &bxv.   &bxv.   &bxv.   &bxv.    &fn0018.(ID, X, B, F, NDM,&cont.
 NDF);
 1044  &bxv.   &bxv.   &bxv.   &bxll.}
 1045  &bxv.   &bxv.   &bxll.}
 1046  &bxv.   &bxv.  
 1047  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1048  &bxv.   &bxv.    :hp1./* Form tangent stiffness                                            */:ehp1.
 1049  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1050  &bxv.   &bxv.  
 1051  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "TANG", 4) == 0)
 1052  &bxv.   &bxv.   &bxul.{
 1053  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (J == 5) CFR = FALSE;
 1054  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (GFL)    &fn0020.(&amp.NA, &amp.&cont.
NE, JDIAG&lbrk.NEQ-1&rbrk.*IPR, &amp.GFL);
 1055  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (NPLD > 0) PROP = &fn0017.(TIME, 0);
 1056  &bxv.   &bxv.   &bxv.    &fn0021.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.&cont.
NA&rbrk., JDIAG&lbrk.NEQ-1&rbrk.);
 1057  &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P, S, IE, D, ID, X, IX, F, T, JDIA&cont.
G, DR,
 1058  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NA&rbrk., (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.NC&rbrk.&cont.
,
 1059  &bxv.   &bxv.   &bxv.          NDF, NDM, NEN1, NST, 3, B, (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &cont.
&amp.M&lbrk.NV&rbrk., TRUE, FALSE, CFR, FALSE);
 1060  &bxv.   &bxv.   &bxv.    AFR = TRUE;
 1061  &bxv.   &bxv.   &bxll.}
 1062  &bxv.   &bxv.  
 1063  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "UTAN", 4) == 0)
 1064  &bxv.   &bxv.   &bxul.{
 1065  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (CFL)    &fn0020.(&amp.NC, &amp.&cont.
NE, JDIAG&lbrk.NEQ-1&rbrk.*IPR, &amp.CFL);
 1066  &bxv.   &bxv.   &bxv.    &fn0021.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.&cont.
NC&rbrk., JDIAG&lbrk.NEQ-1&rbrk.);
 1067  &bxv.   &bxv.   &bxv.    CFR = TRUE;
 1068  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (J == 5) CFR = FALSE;
 1069  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (GFL)    &fn0020.(&amp.NA, &amp.&cont.
NE, JDIAG&lbrk.NEQ-1&rbrk.*IPR, &amp.GFL);
 1070  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (NPLD > 0) PROP = &fn0017.(TIME, 0);
 1071  &bxv.   &bxv.   &bxv.    &fn0021.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.&cont.
NA&rbrk., JDIAG&lbrk.NEQ-1&rbrk.);
 1072  &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P, S, IE, D, ID, X, IX, F, T, JDIA&cont.
G, DR, 
 1073  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NA&rbrk., (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.NC&rbrk.&cont.
,
 1074  &bxv.   &bxv.   &bxv.          NDF, NDM, NEN1, NST, 3, B, (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &cont.
&amp.M&lbrk.NV&rbrk., TRUE, FALSE, CFR, FALSE);
 1075  &bxv.   &bxv.   &bxv.    AFR = TRUE;
 1076  &bxv.   &bxv.   &bxll.}
 1077  &bxv.   &bxv.  
 1078  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1079  &bxv.   &bxv.    :hp1./* Form out of balance force for time step/iteration                 */:ehp1.
 1080  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1081  &bxv.   &bxv.  
 1082  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "FORM", 4) == 0)
 1083  &bxv.   &bxv.   &bxul.{
 1084  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. RN = 0&period.0;
 1085  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. n = 0;
 1086  &bxv.   &bxv.   &bxv.
 1087  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (NPLD > 0) PROP = &fn0017.(TIME, 0);
 1088  &bxv.   &bxv.   &bxv.    &fn0014.(ID, F, DR, NNEQ, PROP);
 1089  &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P, S, IE, D, ID, X, IX, F, T, JDIA&cont.
G, DR, DR, DR,
 1090  &bxv.   &bxv.   &bxv.          NDF, NDM, NEN1, NST, 6, B, (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &cont.
&amp.M&lbrk.NV&rbrk., FALSE, TRUE, FALSE, FALSE);
 1091  &bxv.   &bxv.   &bxv.    BFR = TRUE;
 1092  &bxv.   &bxv.   &bxv.
 1093  &bxv.   &bxv.   &bxv.    RN = 0&period.0;
 1094  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (n = 0; n < NEQ; n++)
 1095  &bxv.   &bxv.   &bxv.        RN = RN + DR&lbrk.n&rbrk.&cont.
 * DR&lbrk.n&rbrk.;
 1096  &bxv.   &bxv.   &bxv.    RN = &fn0056.(RN);
 1097  &bxv.   &bxv.   &bxv.       
 1098  &bxv.   &bxv.   &bxv.    RNMAX = &fn0055.(RNMAX, RN);
 1099  &bxv.   &bxv.   &bxv.
 1100  &bxv.   &bxv.   &bxv.    &fn0044.("     Force Convergence Test\n");
 1101  &bxv.   &bxv.   &bxv.    &fn0044.("          RNMAX = %15&period.&cont.
5lf     RN    = %15&period.5lf     TOL   = %15&period.5lf\n", RNMAX,RN,TOL);
 1102  &bxv.   &bxv.   &bxv.
 1103  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (RN < RNMAX*TOL)
 1104  &bxv.   &bxv.   &bxv.   &bxul.{
 1105  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. L0 = 0, l0 = 0&cont.
;
 1106  &bxv.   &bxv.   &bxv.   &bxv.
 1107  &bxv.   &bxv.   &bxv.   &bxv.    LX = LVE&lbrk.&cont.
lv&rbrk.;          lx = LX - 1;
 1108  &bxv.   &bxv.   &bxv.   &bxv.    L0 = LVS&lbrk.&cont.
lv&rbrk.;          l0 = L0 - 1;
 1109  &bxv.   &bxv.   &bxv.   &bxv.    CT&lbrk.&cont.
lx&rbrk.&period.d1 = CT&lbrk.l0&rbrk.&period.&cont.
d1;
 1110  &bxv.   &bxv.   &bxv.   &bxv.    L = LX - 1;       &cont.
     l  = L  - 1;
 1111  &bxv.   &bxv.   &bxv.   &bxll.}
 1112  &bxv.   &bxv.   &bxll.}
 1113  &bxv.   &bxv.  
 1114  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1115  &bxv.   &bxv.    :hp1./* Set loop start indicators                                         */:ehp1.
 1116  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1117  &bxv.   &bxv.  
 1118  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "LOOP", 4) == 0)
 1119  &bxv.   &bxv.   &bxul.{
 1120  &bxv.   &bxv.   &bxv.    LV = LV + 1;                         lv = LV - 1;
 1121  &bxv.   &bxv.   &bxv.    LX = (:hp3.int:ehp3.) (0&period.5 + CT&lbrk.&cont.
l&rbrk.&period.d2);         lx = LX - 1;
 1122  &bxv.   &bxv.   &bxv.    LVS&lbrk.lv&rbrk.&cont.
 = L;
 1123  &bxv.   &bxv.   &bxv.    LVE&lbrk.lv&rbrk.&cont.
 = LX;
 1124  &bxv.   &bxv.   &bxv.    CT&lbrk.lx&rbrk.&cont.
&period.d1 = 1&period.0;
 1125  &bxv.   &bxv.   &bxll.}
 1126  &bxv.   &bxv.  
 1127  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1128  &bxv.   &bxv.    :hp1./* Loop terminator control                                           */:ehp1.
 1129  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1130  &bxv.   &bxv.  
 1131  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "NEXT", 4) == 0)
 1132  &bxv.   &bxv.   &bxul.{
 1133  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. n = 0;
 1134  &bxv.   &bxv.   &bxv.
 1135  &bxv.   &bxv.   &bxv.    NN = (:hp3.int:ehp3.) CT&lbrk.l&rbrk.&cont.
&period.d2;                           n  = NN  - 1;
 1136  &bxv.   &bxv.   &bxv.    CT&lbrk.l&rbrk.&cont.
&period.d1 = CT&lbrk.l&rbrk.&period.d1 + 1&period.&cont.
0;
 1137  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (CT&lbrk.l&rbrk.&cont.
&period.d1 >  CT&lbrk.n&rbrk.&period.d1) LV = LV - 1;      &cont.
   lv = LV - 1;
 1138  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (CT&lbrk.l&rbrk.&cont.
&period.d1 <= CT&lbrk.n&rbrk.&period.d1) L  = NN;          &cont.
   l  = L  - 1;
 1139  &bxv.   &bxv.   &bxll.}
 1140  &bxv.   &bxv.  
 1141  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1142  &bxv.   &bxv.    :hp1./* Input proportional load table                                     */:ehp1.
 1143  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1144  &bxv.   &bxv.  
 1145  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "PROP", 4) == 0)
 1146  &bxv.   &bxv.   &bxul.{
 1147  &bxv.   &bxv.   &bxv.    NPLD = (:hp3.int:ehp3.) CT&lbrk.l&rbrk.&cont.
&period.d1;
 1148  &bxv.   &bxv.   &bxv.    PROP = &fn0017.(0&period.0, NPLD);
 1149  &bxv.   &bxv.   &bxll.}
 1150  &bxv.   &bxv.  
 1151  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1152  &bxv.   &bxv.    :hp1./* Read commands                                                     */:ehp1.
 1153  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1154  &bxv.   &bxv.  
 1155  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "DATA", 4) == 0)
 1156  &bxv.   &bxv.   &bxul.{
 1157  &bxv.   &bxv.   &bxv.    CONTROL CTL = {{0}};
 1158  &bxv.   &bxv.   &bxv.
 1159  &bxv.   &bxv.   &bxv.    &fn0045.(line);
 1160  &bxv.   &bxv.   &bxv.    &fn0053.(&amp.CTL, 0, :hp3.sizeof:ehp3.(CONTR&cont.
OL));
 1161  &bxv.   &bxv.   &bxv.    &fn0054.(CTL&period.s1, &amp.&cont.
line&lbrk.0&rbrk., 4);
 1162  &bxv.   &bxv.   &bxv.    &fn0054.(CTL&period.s2, &amp.&cont.
line&lbrk.5&rbrk., 4);
 1163  &bxv.   &bxv.   &bxv.    CTL&period.d1 = &fn0030.(line, 10, 25&cont.
);
 1164  &bxv.   &bxv.   &bxv.    CTL&period.d2 = &fn0030.(line, 25, 40&cont.
);
 1165  &bxv.   &bxv.   &bxv.
 1166  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0057.(CT&lbrk.l&rbrk.&cont.
&period.s2, CTL&period.s1) != 0)
 1167  &bxv.   &bxv.   &bxv.   &bxul.{
 1168  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("**FATAL ERROR 12&cont.
** Macro label mismatch on a read command\n");
 1169  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.return:ehp3.;
 1170  &bxv.   &bxv.   &bxv.   &bxll.}
 1171  &bxv.   &bxv.   &bxv.
 1172  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0046.(CTL&period.s1, "TOL", 3)&cont.
 == 0) TOL = CTL&period.d1;
 1173  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (&fn0046.(CTL&period.s1, "DT",  2)&cont.
 == 0) DT  = CTL&period.d1;
 1174  &bxv.   &bxv.   &bxll.}
 1175  &bxv.   &bxv.  
 1176  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1177  &bxv.   &bxv.    :hp1./* Increment time                                                    */:ehp1.
 1178  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1179  &bxv.   &bxv.  
 1180  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "TIME", 4) == 0)
 1181  &bxv.   &bxv.   &bxul.{
 1182  &bxv.   &bxv.   &bxv.    TIME  = TIME + DT;
 1183  &bxv.   &bxv.   &bxv.    RNMAX = 0&period.0;
 1184  &bxv.   &bxv.   &bxv.    UN    = 0&period.0;
 1185  &bxv.   &bxv.   &bxll.}
 1186  &bxv.   &bxv.  
 1187  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1188  &bxv.   &bxv.    :hp1./* Compute convergence test                                          */:ehp1.
 1189  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1190  &bxv.   &bxv.  
 1191  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "CONV", 4) == 0)
 1192  &bxv.   &bxv.   &bxul.{
 1193  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. RN = 0&period.0, CN = &cont.
0&period.0;
 1194  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. n = 0, L0 = 0, l0 = 0;
 1195  &bxv.   &bxv.   &bxv.
 1196  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (n = 0; n < NEQ; n++)
 1197  &bxv.   &bxv.   &bxv.   &bxul.{
 1198  &bxv.   &bxv.   &bxv.   &bxv.    UN = UN + B&lbrk.&cont.
n&rbrk.  * B&lbrk.n&rbrk.;
 1199  &bxv.   &bxv.   &bxv.   &bxv.    RN = RN + DR&lbrk.&cont.
n&rbrk. * DR&lbrk.n&rbrk.;
 1200  &bxv.   &bxv.   &bxv.   &bxll.}
 1201  &bxv.   &bxv.   &bxv.
 1202  &bxv.   &bxv.   &bxv.    UN = &fn0055.(UN, RN);
 1203  &bxv.   &bxv.   &bxv.    CN = &fn0056.(UN);
 1204  &bxv.   &bxv.   &bxv.    RN = &fn0056.(RN);
 1205  &bxv.   &bxv.   &bxv.
 1206  &bxv.   &bxv.   &bxv.    &fn0044.("     Displacement Convergence Test\n");
 1207  &bxv.   &bxv.   &bxv.    &fn0044.("          UNMAX = %15&period.&cont.
5lf     UN    = %15&period.5lf      TOL   = %15&period.5lf\n", CN, RN, TOL);
 1208  &bxv.   &bxv.   &bxv.
 1209  &bxv.   &bxv.   &bxv.    LX = LVE&lbrk.lv&rbrk.&cont.
;                                  lx = LX - 1;
 1210  &bxv.   &bxv.   &bxv.    L0 = LVS&lbrk.lv&rbrk.&cont.
;                                  l0 = L0 - 1;
 1211  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (RN < CN*TOL) CT&lbrk.lx&cont.
&rbrk.&period.d1 = CT&lbrk.l0&rbrk.&period.&cont.
d1;
 1212  &bxv.   &bxv.   &bxll.}
 1213  &bxv.   &bxv.
 1214  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1215  &bxv.   &bxv.    :hp1./* Solve the equations                                               */:ehp1.
 1216  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1217  &bxv.   &bxv.  
 1218  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "SOLV", 4) == 0)
 1219  &bxv.   &bxv.   &bxul.{
 1220  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (CFR)
 1221  &bxv.   &bxv.   &bxv.        &fn0022.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NA&rbrk., (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.NC&rbrk.&cont.
, DR, JDIAG, NEQ, AFR, BFR);
 1222  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 1223  &bxv.   &bxv.   &bxv.        &fn0005.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NA&rbrk., (:hp3.double:ehp3.*) DR, JDIAG, NEQ, AFR, BFR);
 1224  &bxv.   &bxv.   &bxv.
 1225  &bxv.   &bxv.   &bxv.    AFR = FALSE;
 1226  &bxv.   &bxv.   &bxv.
 1227  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (BFR)
 1228  &bxv.   &bxv.   &bxv.   &bxul.{
 1229  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. n = 0;
 1230  &bxv.   &bxv.   &bxv.   &bxv.
 1231  &bxv.   &bxv.   &bxv.   &bxv.    BFR = FALSE;
 1232  &bxv.   &bxv.   &bxv.   &bxv.
 1233  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (n = 0; n < NE&cont.
Q; n++)
 1234  &bxv.   &bxv.   &bxv.   &bxv.        B&lbrk.&cont.
n&rbrk. = B&lbrk.n&rbrk. + DR&lbrk.n&rbrk.&cont.
;
 1235  &bxv.   &bxv.   &bxv.   &bxll.}
 1236  &bxv.   &bxv.   &bxll.}
 1237  &bxv.   &bxv.
 1238  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1239  &bxv.   &bxv.    :hp1./* Form a lumped mass approximation                                  */:ehp1.
 1240  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1241  &bxv.   &bxv.  
 1242  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "LMAS", 4) == 0)
 1243  &bxv.   &bxv.   &bxul.{
 1244  &bxv.   &bxv.   &bxv.
 1245  &bxv.   &bxv.   &bxv.    AFL = FALSE;
 1246  &bxv.   &bxv.   &bxv.    BFL = TRUE;
 1247  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (EFL) &fn0020.(&amp.NN, &amp.&cont.
NE, NEQ*IPR, &amp.EFL);
 1248  &bxv.   &bxv.   &bxv.    &fn0021.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.&cont.
NN&rbrk., NEQ);
 1249  &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P, S, IE, D, ID, X, IX, F, T, JDIA&cont.
G, 
 1250  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NN&rbrk., (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.NM&rbrk.&cont.
,
 1251  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NM&rbrk., NDF, NDM, NEN1, NST, 5, B,
 1252  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NV&rbrk., AFL, BFL, FALSE, FALSE);
 1253  &bxv.   &bxv.   &bxll.}
 1254  &bxv.   &bxv.
 1255  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1256  &bxv.   &bxv.    :hp1./* Form a consistent mass approximation                              */:ehp1.
 1257  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1258  &bxv.   &bxv.  
 1259  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "CMAS", 4) == 0)
 1260  &bxv.   &bxv.   &bxul.{
 1261  &bxv.   &bxv.   &bxv.    AFL = TRUE;
 1262  &bxv.   &bxv.   &bxv.    BFL = FALSE;
 1263  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (DFL)     &fn0020.(&amp.NM, &amp.&cont.
NE, JDIAG&lbrk.NEQ-1&rbrk.*IPR, &amp.DFL);
 1264  &bxv.   &bxv.   &bxv.    &fn0021.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.&cont.
NM&rbrk., JDIAG&lbrk.NEQ-1&rbrk.);
 1265  &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P, S, IE, D, ID, X, IX, F, T, JDIA&cont.
G,
 1266  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NN&rbrk., (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.NM&rbrk.&cont.
,
 1267  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NM&rbrk., NDF, NDM, NEN1, NST, 5, B,
 1268  &bxv.   &bxv.   &bxv.          (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NV&rbrk., AFL, BFL, FALSE, FALSE);
 1269  &bxv.   &bxv.   &bxll.}
 1270  &bxv.   &bxv.
 1271  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "MESH", 4) == 0)
 1272  &bxv.   &bxv.   &bxul.{
 1273  &bxv.   &bxv.   &bxv.    I = -1;
 1274  &bxv.   &bxv.   &bxv.    &fn0002.(LD, IE, D, ID, X, IX, F, T, NDF, NDM, NEN1, I);
 1275  &bxv.   &bxv.   &bxv.
 1276  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (I > 0)
 1277  &bxv.   &bxv.   &bxv.   &bxul.{
 1278  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERR&cont.
OR 14** Attempt to change boundary restraint codfs during macro execution\n");
 1279  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.return:ehp3.;
 1280  &bxv.   &bxv.   &bxv.   &bxll.}
 1281  &bxv.   &bxv.   &bxll.}
 1282  &bxv.   &bxv.
 1283  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "EIGE", 4) == 0)
 1284  &bxv.   &bxv.   &bxul.{
 1285  &bxv.   &bxv.   &bxv.    J = NM;
 1286  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (DFL) J = NN;
 1287  &bxv.   &bxv.   &bxv.
 1288  &bxv.   &bxv.   &bxv.    &fn0012.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.&cont.
NA&rbrk., (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.J&rbrk., F, X,&cont.
 B, DR, 
 1289  &bxv.   &bxv.   &bxv.          ID, IX, JDIAG, NDF, NDM, NEN1, DFL);
 1290  &bxv.   &bxv.   &bxll.}
 1291  &bxv.   &bxv.
 1292  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "EXCD", 4) == 0)
 1293  &bxv.   &bxv.   &bxul.{
 1294  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (!FFL)
 1295  &bxv.   &bxv.   &bxv.   &bxul.{
 1296  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 1297  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Macro *EXCD* ex&cont.
plicit integration of equations of motion  */:ehp1.
 1298  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 1299  &bxv.   &bxv.   &bxv.   &bxv.   
 1300  &bxv.   &bxv.   &bxv.   &bxv.    NQ = NE;
 1301  &bxv.   &bxv.   &bxv.   &bxv.    NV = NQ + NEQ*IPR;
 1302  &bxv.   &bxv.   &bxv.   &bxv.    NR = NV + NDF*NUMN&cont.
P*IPR;
 1303  &bxv.   &bxv.   &bxv.   &bxv.    NE = NR + NEQ*IPR;
 1304  &bxv.   &bxv.   &bxv.   &bxv.    &fn0003.(NE+1);
 1305  &bxv.   &bxv.   &bxv.   &bxv.    &fn0021.((:hp3.double:ehp3.*) (:hp3.void:ehp3.*)&cont.
 &amp.M&lbrk.NQ&rbrk., NE-NQ);
 1306  &bxv.   &bxv.   &bxv.   &bxv.    FFL = TRUE;
 1307  &bxv.   &bxv.   &bxv.   &bxll.}
 1308  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (!BFR || EFL)
 1309  &bxv.   &bxv.   &bxv.   &bxul.{
 1310  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("     **FATAL ERR&cont.
OR 13** Macro exed must be preceded by lmas and form\n");
 1311  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.return:ehp3.;
 1312  &bxv.   &bxv.   &bxv.   &bxll.}
 1313  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 1314  &bxv.   &bxv.   &bxv.        &fn0009.(DR, B, (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NQ&rbrk., (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.M&lbrk.NR&rbrk.&cont.
, 
 1315  &bxv.   &bxv.   &bxv.               (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NN&rbrk., DT, NEQ);
 1316  &bxv.   &bxv.   &bxll.}
 1317  &bxv.   &bxv.
 1318  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1319  &bxv.   &bxv.    :hp1./* Compute reactions and print                                       */:ehp1.
 1320  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1321  &bxv.   &bxv.  
 1322  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "REAC", 4) == 0)
 1323  &bxv.   &bxv.   &bxul.{
 1324  &bxv.   &bxv.   &bxv.    &fn0021.(DR, NNEQ);
 1325  &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P, S, IE, D, ID, X, IX, F, T, JDIA&cont.
G, DR, DR, DR,
 1326  &bxv.   &bxv.   &bxv.          NDF, NDM, NEN1, NST, 6, B, (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &cont.
&amp.M&lbrk.NV&rbrk., FALSE, TRUE, FALSE, TRUE);
 1327  &bxv.   &bxv.   &bxv.    &fn0019.(DR, NDF);
 1328  &bxv.   &bxv.   &bxll.}
 1329  &bxv.   &bxv.
 1330  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "CHEC", 4) == 0)
 1331  &bxv.   &bxv.   &bxul.{
 1332  &bxv.   &bxv.   &bxv.    &fn0013.(UL, XL, TL, LD, P, S, IE, D, ID, X, IX, F, T, JDIA&cont.
G, DR, DR, DR,
 1333  &bxv.   &bxv.   &bxv.       NDF, NDM, NEN1, NST, 2, B, F, FALSE, FALSE, FALS&cont.
E, FALSE);
 1334  &bxv.   &bxv.   &bxll.}
 1335  &bxv.   &bxv.  
 1336  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1337  &bxv.   &bxv.    :hp1./* Output the JDIAG array                                            */:ehp1.
 1338  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1339  &bxv.   &bxv.  
 1340  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "OUTJ", 4) == 0)
 1341  &bxv.   &bxv.   &bxul.{
 1342  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. j = 0;
 1343  &bxv.   &bxv.   &bxv.
 1344  &bxv.   &bxv.   &bxv.    &fn0044.(O);
 1345  &bxv.   &bxv.   &bxv.    &fn0044.("%s\n\n     The JDIAG array\n\n", HEAD);
 1346  &bxv.   &bxv.   &bxv.
 1347  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NEQ; j++)
 1348  &bxv.   &bxv.   &bxv.   &bxul.{
 1349  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("    %4d&colon.&cont.
 %7d\n", j+1, JDIAG&lbrk.j&rbrk.);
 1350  &bxv.   &bxv.   &bxv.   &bxll.}
 1351  &bxv.   &bxv.   &bxll.}
 1352  &bxv.   &bxv.  
 1353  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1354  &bxv.   &bxv.    :hp1./* Output the assembled matrix                                       */:ehp1.
 1355  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1356  &bxv.   &bxv.  
 1357  &bxv.   &bxv.    :hp3.else:ehp3. :hp3.if:ehp3. (&fn0046.(CT&lbrk.l&rbrk.&period.&cont.
s1, "OUTP", 4) == 0)
 1358  &bxv.   &bxv.   &bxul.{
 1359  &bxv.   &bxv.   &bxv.    &fn0044.("%c",     form_feed);
 1360  &bxv.   &bxv.   &bxv.    &fn0044.("%s\n", HEAD);
 1361  &bxv.   &bxv.   &bxv.
 1362  &bxv.   &bxv.   &bxv.    &fn0036.(NEQ, JDIAG, (:hp3.double:ehp3.*) (:hp3.void:ehp3.*) &amp.&cont.
M&lbrk.NA&rbrk., (:hp3.double:ehp3.*) DR, "Macro command 'OUTP'");
 1363  &bxv.   &bxv.   &bxll.}
 1364  &bxv.   &bxv.  
 1365  &bxv.   &bxv.    L = L + 1;                  l = L - 1;
 1366  &bxv.   &bxv.    :hp3.if:ehp3. (L > LL) more = FALSE;
 1367  &bxv.   &bxll.}
 1368  &bxv.
 1369  &bxv.    &fn0042.("PMACR");
 1370  &bxv.    :hp3.return:ehp3.;
 1371  &bxll.}
 1372   
.cp 184
 1373   :hp1./*****************************************************************************/:ehp1.
 1374   :hp1./*                                                                           */:ehp1.
 1375   :hp1./* Active column profile symmetric equation solver                           */:ehp1.
 1376   :hp1./*                                                                           */:ehp1.
 1377   :hp1./*****************************************************************************/:ehp1.
 1378   
 1379   :hp3.void:ehp3. &fn0005.:spot id=sp0005.(:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NEQ, :hp3.int:ehp3. AFAC, :hp3.int:ehp3. BACK)
:subject.ACTCOL
 1380  &bxul.{
 1381  &bxv.    :hp3.double:ehp3. D = 0&period.0;
 1382  &bxv.    :hp3.int:ehp3. jh = 0, ie = 0, ir = 0, ih = 0;
 1383  &bxv.    :hp3.int:ehp3. j = 0, k = 0, is = 0, id = 0, i = 0, jd = 0, jr = 0;
 1384  &bxv.
 1385  &bxv.    &fn0041.("ACTCOL");
 1386  &bxv.
 1387  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1388  &bxv.    :hp1./* Factor A to UT*D*U, reduce B                                          */:ehp1.
 1389  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1390  &bxv.
 1391  &bxv.    &fn0044.("-----------------------------------------------------------------\n");
 1392  &bxv.
 1393  &bxv.    AENGY = 0&period.0;
 1394  &bxv.    jr = -1;
 1395  &bxv.    :hp3.for:ehp3. (j = 0; j < NEQ; j++)
 1396  &bxv.   &bxul.{
 1397  &bxv.   &bxv.    &fn0044.("j = %d\n\n", j);
 1398  &bxv.   &bxv.
 1399  &bxv.   &bxv.    jd = JDIAG&lbrk.j&rbrk. - 1;
 1400  &bxv.   &bxv.    jh = jd - jr;
 1401  &bxv.   &bxv.    is = j - jh + 2;
 1402  &bxv.   &bxv.
 1403  &bxv.   &bxv.    :hp3.if:ehp3. ((jh-2 > 0) &amp.&amp. AFAC)
 1404  &bxv.   &bxv.   &bxul.{
 1405  &bxv.   &bxv.   &bxv.    ie = j;
 1406  &bxv.   &bxv.   &bxv.    k = jr + 2;
 1407  &bxv.   &bxv.   &bxv.    id = JDIAG&lbrk.is - 1&rbrk.&cont.
 - 1;
 1408  &bxv.   &bxv.   &bxv.
 1409  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 1410  &bxv.   &bxv.   &bxv.    :hp1./* Reduce all equations except diagonal            &cont.
              */:ehp1.
 1411  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 1412  &bxv.   &bxv.   &bxv. 
 1413  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = is; i < ie; i++)
 1414  &bxv.   &bxv.   &bxv.   &bxul.{
 1415  &bxv.   &bxv.   &bxv.   &bxv.    ir = id;
 1416  &bxv.   &bxv.   &bxv.   &bxv.    id = JDIAG&lbrk.&cont.
i&rbrk. - 1;
 1417  &bxv.   &bxv.   &bxv.   &bxv.    ih = &fn0051.(id-ir-1, i-i&cont.
s+1);
 1418  &bxv.   &bxv.   &bxv.   &bxv.
 1419  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (ih > 0)
 1420  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 1421  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. dot = &fn0007.(&amp.A&lbrk.k-ih&rbrk., &amp.A&lbrk.&cont.
id-ih&rbrk., ih);
 1422  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. x = A&lbrk.k&rbrk. - dot;
 1423  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1424  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("A&lbrk.%d&rbrk. = A&lbrk.%d&rbrk. - DOT(&amp.&cont.
A&lbrk.%d&rbrk., &amp.A&lbrk.%d&rbrk.&cont.
, %d)\n", k, k, k-ih, id-ih, ih);
 1425  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     = %7&period.3lf - %7&period.3lf = %7&period.3lf\n\n", A&lbrk.&cont.
k&rbrk., dot, x);
 1426  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1427  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    A&lbrk.k&rbrk. = x;
 1428  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 1429  &bxv.   &bxv.   &bxv.   &bxv.
 1430  &bxv.   &bxv.   &bxv.   &bxv.    k = k + 1;
 1431  &bxv.   &bxv.   &bxv.   &bxll.}
 1432  &bxv.   &bxv.   &bxll.}
 1433  &bxv.   &bxv.
 1434  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1435  &bxv.   &bxv.    :hp1./* Reduce diagonal term                                              */:ehp1.
 1436  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1437  &bxv.   &bxv.
 1438  &bxv.   &bxv.    :hp3.if:ehp3. ((jh-2 >= 0) &amp.&amp. AFAC)
 1439  &bxv.   &bxv.   &bxul.{
 1440  &bxv.   &bxv.   &bxv.    ir = jr + 1;
 1441  &bxv.   &bxv.   &bxv.    ie = jd;
 1442  &bxv.   &bxv.   &bxv.    k  = j - jd - 1;
 1443  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = ir; i < ie; i++)
 1444  &bxv.   &bxv.   &bxv.   &bxul.{
 1445  &bxv.   &bxv.   &bxv.   &bxv.    id = JDIAG&lbrk.&cont.
k+i+1&rbrk. - 1;
 1446  &bxv.   &bxv.   &bxv.   &bxv.
 1447  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (A&lbrk.&cont.
id&rbrk. != 0&period.0)
 1448  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 1449  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. x = A&lbrk.i&rbrk. / A&lbrk.id&rbrk.;
 1450  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    D = A&lbrk.i&rbrk.;
 1451  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1452  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("A&lbrk.%d&rbrk. = A&lbrk.%d&rbrk. / A&lbrk.&cont.
%d&rbrk.\n", i, i, id);
 1453  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     = %7&period.3lf / %7&period.3lf = %7&period.3lf\n\n", A&lbrk.&cont.
i&rbrk., A&lbrk.id&rbrk., x);
 1454  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1455  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    A&lbrk.i&rbrk. = x;
 1456  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    x = A&lbrk.jd&rbrk. - D*A&lbrk.i&rbrk.;
 1457  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1458  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("A&lbrk.%d&rbrk. = A&lbrk.%d&rbrk. - D*A&lbrk.&cont.
%d&rbrk.\n", jd, jd, i);
 1459  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     = %7&period.3lf - (%7&period.3lf * %7&period.3lf) = %7&period.&cont.
3lf\n\n", A&lbrk.jd&rbrk., D, A&lbrk.i&rbrk., x);
 1460  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1461  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    A&lbrk.jd&rbrk. = x;
 1462  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 1463  &bxv.   &bxv.   &bxv.   &bxll.}
 1464  &bxv.   &bxv.   &bxll.}
 1465  &bxv.   &bxv.
 1466  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1467  &bxv.   &bxv.    :hp1./* Reduce RHS                                                        */:ehp1.
 1468  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1469  &bxv.   &bxv.
 1470  &bxv.   &bxv.    :hp3.if:ehp3. (BACK)
 1471  &bxv.   &bxv.   &bxul.{
 1472  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. dot = &fn0007.(&amp.A&lbrk.&cont.
jr+1&rbrk., &amp.B&lbrk.is-1&rbrk., jh-1);
 1473  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. x   = B&lbrk.j&rbrk.&cont.
 - dot;
 1474  &bxv.   &bxv.   &bxv.
 1475  &bxv.   &bxv.   &bxv.    &fn0044.("--------------------\n");
 1476  &bxv.   &bxv.   &bxv.
 1477  &bxv.   &bxv.   &bxv.    &fn0044.("B&lbrk.%d&rbrk.&cont.
 = B&lbrk.%d&rbrk. - DOT(&amp.A&lbrk.%d&rbrk.&cont.
, &amp.B&lbrk.%d&rbrk., %d)\n", j, j, jr+1, is-1, jh-1);
 1478  &bxv.   &bxv.   &bxv.    &fn0044.("     = %7&period.3lf - %7&period.&cont.
3lf = %7&period.3lf\n\n", B&lbrk.j&rbrk., dot, x);
 1479  &bxv.   &bxv.   &bxv.
 1480  &bxv.   &bxv.   &bxv.    B&lbrk.j&rbrk.&cont.
 = x;
 1481  &bxv.   &bxv.   &bxll.}
 1482  &bxv.   &bxv.
 1483  &bxv.   &bxv.    jr = jd;
 1484  &bxv.   &bxv.    &fn0044.("--------------------\n");
 1485  &bxv.   &bxv.    &fn0036.(NEQ, JDIAG, A, B, "Subroutine 'ACTCOL'");
 1486  &bxv.   &bxv.    &fn0044.("-----------------------------------------------------------------\n");
 1487  &bxv.   &bxll.}
 1488  &bxv.
 1489  &bxv.    :hp3.if:ehp3. ( ! BACK) :hp3.return:ehp3.;
 1490  &bxv.
 1491  &bxv.    &fn0044.("Divide by diagonal pivots\n\n");
 1492  &bxv.
 1493  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1494  &bxv.    :hp1./* Divide by diagonal pivots                                             */:ehp1.
 1495  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1496  &bxv.
 1497  &bxv.    :hp3.for:ehp3. (i = 0; i < NEQ; i++)
 1498  &bxv.   &bxul.{
 1499  &bxv.   &bxv.    id = JDIAG&lbrk.i&rbrk. - 1;
 1500  &bxv.   &bxv.
 1501  &bxv.   &bxv.    :hp3.if:ehp3. (A&lbrk.id&rbrk. != 0&period.&cont.
0)
 1502  &bxv.   &bxv.   &bxul.{
 1503  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. x = B&lbrk.i&rbrk.&cont.
 / A&lbrk.id&rbrk.;
 1504  &bxv.   &bxv.   &bxv.
 1505  &bxv.   &bxv.   &bxv.    &fn0044.("B&lbrk.%d&rbrk.&cont.
 = B&lbrk.%d&rbrk. / A&lbrk.%d&rbrk.\n", i, i, id);
 1506  &bxv.   &bxv.   &bxv.    &fn0044.("     = %7&period.3lf / %7&period.&cont.
3lf = %7&period.3lf\n\n", B&lbrk.i&rbrk., A&lbrk.id&rbrk.&cont.
, x);
 1507  &bxv.   &bxv.   &bxv.
 1508  &bxv.   &bxv.   &bxv.    B&lbrk.i&rbrk.&cont.
 = x;
 1509  &bxv.   &bxv.   &bxll.}
 1510  &bxv.   &bxv.
 1511  &bxv.   &bxv.    AENGY = AENGY + B&lbrk.i&rbrk. * B&lbrk.&cont.
i&rbrk. * A&lbrk.id&rbrk.;
 1512  &bxv.   &bxll.}
 1513  &bxv.
 1514  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1515  &bxv.    :hp1./* Backsubstitute                                                        */:ehp1.
 1516  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1517  &bxv.
 1518  &bxv.    j = NEQ - 1;  
 1519  &bxv.    jd = JDIAG&lbrk.j&rbrk. - 1;
 1520  &bxv.
 1521  &bxv.    &fn0044.("Backsubstitute\n\n");
 1522  &bxv.
 1523  &bxv.    :hp3.while:ehp3. (j >= 0)
 1524  &bxv.   &bxul.{
 1525  &bxv.   &bxv.    D = B&lbrk.j&rbrk.;
 1526  &bxv.   &bxv.    j = j - 1;
 1527  &bxv.   &bxv.
 1528  &bxv.   &bxv.    :hp3.if:ehp3. (j >= 0)
 1529  &bxv.   &bxv.   &bxul.{
 1530  &bxv.   &bxv.   &bxv.    jr = JDIAG&lbrk.j&rbrk.&cont.
 - 1;
 1531  &bxv.   &bxv.   &bxv.   
 1532  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (jd-jr > 1)
 1533  &bxv.   &bxv.   &bxv.   &bxul.{
 1534  &bxv.   &bxv.   &bxv.   &bxv.    is = j - jd + jr +&cont.
 2;
 1535  &bxv.   &bxv.   &bxv.   &bxv.    k = jr - is;
 1536  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = is; i <= &cont.
j; i++)
 1537  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 1538  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. x = B&lbrk.i&rbrk. - A&lbrk.i+k+1&rbrk. * D;
 1539  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1540  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("B&lbrk.%d&rbrk. = B&lbrk.%d&rbrk. - A&lbrk.&cont.
%d&rbrk. * D\n", i, i, i+k+1);
 1541  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("     = %7&period.3lf - (%7&period.3lf * %7&period.3lf)  = %7&period.&cont.
3lf\n\n", B&lbrk.i&rbrk., A&lbrk.i+k+1&rbrk., D , x);
 1542  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1543  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    B&lbrk.i&rbrk. = x;
 1544  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 1545  &bxv.   &bxv.   &bxv.   &bxll.}
 1546  &bxv.   &bxv.   &bxv.   
 1547  &bxv.   &bxv.   &bxv.    jd = jr;
 1548  &bxv.   &bxv.   &bxll.}
 1549  &bxv.   &bxll.}
 1550  &bxv.
 1551  &bxv.    &fn0042.("ACTCOL");
 1552  &bxv.    :hp3.return:ehp3.;
 1553  &bxll.}
 1554   
.cp 63
 1555   :hp1./*****************************************************************************/:ehp1.
 1556   :hp1./*                                                                           */:ehp1.
 1557   :hp1./* Assemble global arrays                                                    */:ehp1.
 1558   :hp1./*                                                                           */:ehp1.
 1559   :hp1./*****************************************************************************/:ehp1.
 1560   
 1561   :hp3.void:ehp3. &fn0006.:spot id=sp0006.(:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.double:ehp3. *C, :hp3.double:ehp3. *S, :hp3.double:ehp3. *P,
:subject.ADDSTF
 1562               :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. *LD, :hp3.int:ehp3. NST, :hp3.int:ehp3. NFL, :hp3.int:ehp3. AFL, :hp3.int:ehp3. BFL, :hp3.int:ehp3. CFL)
 1563  &bxul.{
 1564  &bxv.    :hp3.int:ehp3. i = NFL, j = 0, k = 0;
 1565  &bxv.
 1566  &bxv.    &fn0041.("ADDSTF&colon. NST = %d, NFL = %d, AFL = %d, BFL = %d, CFL = %d", NST, NFL, AFL, BFL, CFL);
 1567  &bxv.
 1568  &bxv.    :hp3.for:ehp3. (j = 0; j < NST; j++)
 1569  &bxv.   &bxul.{
 1570  &bxv.   &bxv.    k = LD&lbrk.j&rbrk. - 1;
 1571  &bxv.   &bxv.
 1572  &bxv.   &bxv.    :hp3.if:ehp3. (k >= 0)
 1573  &bxv.   &bxv.   &bxul.{
 1574  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (BFL)     B&lbrk.k&rbrk.&cont.
 = B&lbrk.k&rbrk. + P&lbrk.j&rbrk.;
 1575  &bxv.   &bxv.   &bxv.
 1576  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (AFL || CFL)
 1577  &bxv.   &bxv.   &bxv.   &bxul.{
 1578  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. l = JDIAG&lbrk.&cont.
k&rbrk. - k - 1;
 1579  &bxv.   &bxv.   &bxv.   &bxv.
 1580  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NS&cont.
T; i++)
 1581  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 1582  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. m = LD&lbrk.i&rbrk. - 1;
 1583  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1584  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. ((m <= k) &amp.&amp. (m >= 0))
 1585  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 1586  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.int:ehp3. n = l + m;
 1587  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.int:ehp3. height = k - m + 1;
 1588  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.int:ehp3. max_height = JDIAG&lbrk.k&rbrk. - l;
 1589  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.
 1590  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. (height > max_height)
 1591  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.        &fn0044.("----> ERROR&colon. ");
 1592  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.else:ehp3.
 1593  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.        &fn0044.("----> OK&colon.    ");
 1594  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.
 1595  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("j = %2d, k = %2d, i = %2d, m = %2d, n = %2d", j, k, i, m, n);
 1596  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.(", height = %2d",                              k - m + 1);
 1597  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.(", max_height = JDIAG&lbrk.%2d&rbrk. - l",               k);
 1598  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.(" = %3d - %3d",                                JDIAG&lbrk.k&rbrk.&cont.
, l);
 1599  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.(" = %3d",                                      JDIAG&lbrk.k&rbrk.&cont.
 - l);
 1600  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("&colon. S&lbrk.%d&rbrk.&lbrk.&cont.
%d&rbrk. = %12&period.6lf\n",                     j, i, &fn0050.(S, j, i, NST));
 1601  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.
 1602  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. (AFL) A&lbrk.n&rbrk. = A&lbrk.n&rbrk.&cont.
 + &fn0050.(S, j, i, NST);
 1603  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. (CFL) C&lbrk.n&rbrk. = C&lbrk.n&rbrk.&cont.
 + &fn0050.(S, i, j, NST);
 1604  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 1605  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 1606  &bxv.   &bxv.   &bxv.   &bxll.}
 1607  &bxv.   &bxv.   &bxll.}
 1608  &bxv.   &bxll.}
 1609  &bxv.
 1610  &bxv.    &fn0036.(NEQ, JDIAG, A, B, "ADDSTF");
 1611  &bxv.
 1612  &bxv.    &fn0042.("ADDSTF");
 1613  &bxv.    :hp3.return:ehp3.;
 1614  &bxll.}
 1615   
.cp 19
 1616   :hp1./*****************************************************************************/:ehp1.
 1617   :hp1./*                                                                           */:ehp1.
 1618   :hp1./* Vector dot product                                                        */:ehp1.
 1619   :hp1./*                                                                           */:ehp1.
 1620   :hp1./*****************************************************************************/:ehp1.
 1621   
 1622   :hp3.double:ehp3. &fn0007.:spot id=sp0007.(:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.int:ehp3. NN)
:subject.DOT
 1623  &bxul.{
 1624  &bxv.    :hp3.int:ehp3. i = 0;
 1625  &bxv.    :hp3.double:ehp3. dot = 0&period.0;
 1626  &bxv.
 1627  &bxv.    :hp3.for:ehp3. (i = 0; i < NN; i++)
 1628  &bxv.      dot += A&lbrk.i&rbrk. * B&lbrk.i&rbrk.&cont.
;
 1629  &bxv.
 1630  &bxv.    :hp3.return:ehp3. dot;
 1631  &bxll.}
 1632   
.cp 42
 1633   :hp1./*****************************************************************************/:ehp1.
 1634   :hp1./*                                                                           */:ehp1.
 1635   :hp1./* Element library                                                           */:ehp1.
 1636   :hp1./*                                                                           */:ehp1.
 1637   :hp1./*****************************************************************************/:ehp1.
 1638   
 1639   :hp3.void:ehp3. &fn0008.:spot id=sp0008.(:hp3.double:ehp3. *D, :hp3.double:ehp3. *U, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *T, :hp3.double:ehp3. *S,
:subject.ELMLIB
 1640               :hp3.double:ehp3. *P, :hp3.int:ehp3. I, :hp3.int:ehp3. J, :hp3.int:ehp3. K, :hp3.int:ehp3. ISW)
 1641  &bxul.{
 1642  &bxv.    &fn0041.("ELMLIB&colon. ISW = %d, IEL = %d", ISW, IEL);
 1643  &bxv.
 1644  &bxv.    :hp3.if:ehp3. (ISW >= 3)
 1645  &bxv.   &bxul.{
 1646  &bxv.   &bxv.    :hp3.int:ehp3. l = 0;
 1647  &bxv.   &bxv.
 1648  &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < K; l++)
 1649  &bxv.   &bxv.   &bxul.{
 1650  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. m = 0;
 1651  &bxv.   &bxv.   &bxv.
 1652  &bxv.   &bxv.   &bxv.    P&lbrk.l&rbrk.&cont.
 = 0&period.0;
 1653  &bxv.   &bxv.   &bxv.   
 1654  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (m = 0; m < K; m++)
 1655  &bxv.   &bxv.   &bxv.        &fn0048.(S, m, l, K, 0&period.0);
 1656  &bxv.   &bxv.   &bxll.}
 1657  &bxv.   &bxll.}
 1658  &bxv.
 1659  &bxv.    :hp3.switch:ehp3. (IEL)
 1660  &bxv.   &bxul.{
 1661  &bxv.   &bxv.:hp3.case:ehp3. 1&colon.    &fn0023.(D,U,X,IX,T,S,P,I,J,K,ISW);    :hp3.break:ehp3.;
 1662  &bxv.   &bxv.:hp3.case:ehp3. 2&colon.    &fn0028.(D,U,X,IX,T,S,P,I,J,K,ISW);    :hp3.break:ehp3.;
 1663  &bxv.   &bxv.:hp3.case:ehp3. 3&colon.    &fn0029.(D,U,X,IX,T,S,P,I,J,K,ISW);    :hp3.break:ehp3.;
 1664  &bxv.   &bxv.:hp3.default:ehp3.&colon.  
 1665  &bxv.   &bxv.    &fn0044.("    **FATAL ERROR 04** Element class number %d  input\n", IEL);
 1666  &bxv.   &bxv.    &fn0052.(0);
 1667  &bxv.   &bxll.}
 1668  &bxv.
 1669  &bxv.    &fn0042.("ELMLIB");
 1670  &bxv.    :hp3.return:ehp3.;
 1671  &bxll.}
 1672   
.cp 29
 1673   :hp1./*****************************************************************************/:ehp1.
 1674   :hp1./*                                                                           */:ehp1.
 1675   :hp1./* Update solution using explicit central differences                        */:ehp1.
 1676   :hp1./*                                                                           */:ehp1.
 1677   :hp1./*****************************************************************************/:ehp1.
 1678   
 1679   :hp3.void:ehp3. &fn0009.:spot id=sp0009.(:hp3.double:ehp3. *DR, :hp3.double:ehp3. *U, :hp3.double:ehp3. *V, :hp3.double:ehp3. *A, :hp3.double:ehp3. *XM, :hp3.double:ehp3. DT, :hp3.int:ehp3. NEQ)
:subject.EUPDAT
 1680  &bxul.{
 1681  &bxv.    :hp3.double:ehp3. DTHP = 0&period.0;
 1682  &bxv.    :hp3.double:ehp3. DTH  = DT / 2&period.0;
 1683  &bxv.    :hp3.double:ehp3. DTAV = DTH + DTHP;
 1684  &bxv.    :hp3.int:ehp3. n = 0;
 1685  &bxv.
 1686  &bxv.    &fn0041.("EUPDAT");
 1687  &bxv.    DTHP = DTH;
 1688  &bxv.
 1689  &bxv.    :hp3.for:ehp3. (n = 0; n < NEQ; n++)
 1690  &bxv.   &bxul.{
 1691  &bxv.   &bxv.    A&lbrk.n&rbrk. = DR&lbrk.&cont.
n&rbrk. / XM&lbrk.n&rbrk.;
 1692  &bxv.   &bxv.    V&lbrk.n&rbrk. = V&lbrk.&cont.
n&rbrk. + DTAV * A&lbrk.n&rbrk.;
 1693  &bxv.   &bxv.    U&lbrk.n&rbrk. = U&lbrk.&cont.
n&rbrk. + DT   * V&lbrk.n&rbrk.;
 1694  &bxv.   &bxll.}
 1695  &bxv.
 1696  &bxv.    &fn0042.("EUPDAT");
 1697  &bxv.    :hp3.return:ehp3.;
 1698  &bxll.}
 1699   
.cp 22
 1700   :hp1./*****************************************************************************/:ehp1.
 1701   :hp1./*                                                                           */:ehp1.
 1702   :hp1./* Normalize vector Y to unit vector X                                       */:ehp1.
 1703   :hp1./*                                                                           */:ehp1.
 1704   :hp1./*****************************************************************************/:ehp1.
 1705   
 1706   :hp3.void:ehp3. &fn0010.:spot id=sp0010.(:hp3.double:ehp3. *X, :hp3.double:ehp3. *Y, :hp3.int:ehp3. NN)
:subject.NORM
 1707  &bxul.{
 1708  &bxv.    :hp3.double:ehp3. SCALE = &fn0056.(&fn0007.(Y, Y, NN));
 1709  &bxv.    :hp3.int:ehp3. i = 0;
 1710  &bxv.
 1711  &bxv.    &fn0041.("NORM");
 1712  &bxv.
 1713  &bxv.    :hp3.for:ehp3. (i = 0; i < NN; i++)
 1714  &bxv.        X&lbrk.i&rbrk. = Y&lbrk.i&rbrk.&cont.
 / SCALE;
 1715  &bxv.
 1716  &bxv.    &fn0042.("NORM");
 1717  &bxv.    :hp3.return:ehp3.;
 1718  &bxll.}
 1719   
.cp 14
 1720   :hp1./*****************************************************************************/:ehp1.
 1721   :hp1./*                                                                           */:ehp1.
 1722   :hp1./* It may be necessary to replace the following alphanumeric                 */:ehp1.
 1723   :hp1./* comparison statement if computer produces an overflow                     */:ehp1.
 1724   :hp1./*                                                                           */:ehp1.
 1725   :hp1./*****************************************************************************/:ehp1.
 1726   
 1727   :hp3.int:ehp3. &fn0011.:spot id=sp0011.(:hp3.double:ehp3. A, :hp3.double:ehp3. B)
:subject.PCOMP
 1728  &bxul.{
 1729  &bxv.    :hp3.return:ehp3. (A == B);
 1730  &bxll.}
 1731   
.cp 80
 1732   :hp1./*****************************************************************************/:ehp1.
 1733   :hp1./*                                                                           */:ehp1.
 1734   :hp1./* Compute dominant eiganvalue by inverse iteration                          */:ehp1.
 1735   :hp1./*                                                                           */:ehp1.
 1736   :hp1./*****************************************************************************/:ehp1.
 1737   
 1738   :hp3.void:ehp3. &fn0012.:spot id=sp0012.(:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.double:ehp3. *F, :hp3.double:ehp3. *X, :hp3.double:ehp3. *Y, :hp3.double:ehp3. *Z, :hp3.int:ehp3. *ID, :hp3.int:ehp3. *IX,
:subject.PEIGS
 1739              :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. DFL)
 1740  &bxul.{
 1741  &bxv.    :hp3.int:ehp3.    ITS  = 100;
 1742  &bxv.    :hp3.double:ehp3. TOL  = 1&period.E-9;
 1743  &bxv.    :hp3.double:ehp3. EIGP = 0&period.0;
 1744  &bxv.    :hp3.double:ehp3. EIG  = 0&period.0;
 1745  &bxv.    :hp3.int:ehp3.    converged = FALSE;
 1746  &bxv.    :hp3.int:ehp3.    i = NEN1;
 1747  &bxv.    :hp3.int:ehp3.    j = *IX;
 1748  &bxv.
 1749  &bxv.    &fn0041.("PEIGS");
 1750  &bxv.
 1751  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1752  &bxv.    :hp1./* Get start vector from diagonal of mass matrix                         */:ehp1.
 1753  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1754  &bxv.
 1755  &bxv.    :hp3.for:ehp3. (i = 0; i < NEQ; i++)
 1756  &bxv.   &bxul.{
 1757  &bxv.   &bxv.    :hp3.if:ehp3. (DFL)
 1758  &bxv.   &bxv.        j = 0;
 1759  &bxv.   &bxv.    :hp3.else:ehp3.
 1760  &bxv.   &bxv.        j = JDIAG&lbrk.i&rbrk. - 1;
 1761  &bxv.   &bxv.
 1762  &bxv.   &bxv.    Y&lbrk.i&rbrk. = B&lbrk.&cont.
j&rbrk.;
 1763  &bxv.   &bxll.}
 1764  &bxv.
 1765  &bxv.    EIGP = 0&period.0;
 1766  &bxv.    &fn0005.(A, Z, JDIAG, NEQ, TRUE, FALSE);
 1767  &bxv.
 1768  &bxv.    :hp3.for:ehp3. (i = 0; (i < ITS) &amp.&amp. !converged; i++)
 1769  &bxv.   &bxul.{
 1770  &bxv.   &bxv.    &fn0021.(Z, NEQ);
 1771  &bxv.   &bxv.    &fn0016.(B, Y, Z, JDIAG, NEQ);
 1772  &bxv.   &bxv.
 1773  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1774  &bxv.   &bxv.    :hp1./* Rayleigh quotient                                                 */:ehp1.
 1775  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1776  &bxv.   &bxv.
 1777  &bxv.   &bxv.    EIG = AENGY / &fn0007.(Y, Z, NEQ);
 1778  &bxv.   &bxv.
 1779  &bxv.   &bxv.    :hp3.if:ehp3. (&fn0058.(EIG-EIGP) < TOL * &fn0058.(EIG))
 1780  &bxv.   &bxv.        converged = TRUE;
 1781  &bxv.   &bxv.    :hp3.else:ehp3.
 1782  &bxv.   &bxv.   &bxul.{
 1783  &bxv.   &bxv.   &bxv.    &fn0010.(Y, Z, NEQ);
 1784  &bxv.   &bxv.   &bxv.    EIGP = EIG;
 1785  &bxv.   &bxv.   &bxv.
 1786  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 1787  &bxv.   &bxv.   &bxv.    :hp1./* Inverse iteration                               &cont.
              */:ehp1.
 1788  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 1789  &bxv.   &bxv.   &bxv.
 1790  &bxv.   &bxv.   &bxv.    &fn0005.(A, Y, JDIAG, NEQ, FALSE, TRUE);
 1791  &bxv.   &bxv.   &bxll.}
 1792  &bxv.   &bxll.}
 1793  &bxv.
 1794  &bxv.    :hp3.if:ehp3. (converged)
 1795  &bxv.   &bxul.{
 1796  &bxv.   &bxv.    &fn0044.(O);
 1797  &bxv.   &bxv.    &fn0044.("%s\n\n", HEAD);
 1798  &bxv.   &bxv.    &fn0044.("     Eigenvalue =  %13&period.4lf\n", EIG);
 1799  &bxv.   &bxv.    &fn0044.("     Iterations =  %d\n\n", i);
 1800  &bxv.   &bxv.    &fn0010.(Z, Y, NEQ);
 1801  &bxv.   &bxv.    &fn0018.(ID, X, Z, F, NDM, NDF);
 1802  &bxv.   &bxll.}
 1803  &bxv.    :hp3.else:ehp3.
 1804  &bxv.        &fn0044.("     **FATAL ERROR 09** No convergence in eigenvalues, ITS =  %d\n", ITS);
 1805  &bxv.
 1806  &bxv.    &fn0042.("PEIGS");
 1807  &bxv.    :hp3.return:ehp3.;
 1808  &bxll.}
 1809   
.cp 112
 1810   :hp1./*****************************************************************************/:ehp1.
 1811   :hp1./*                                                                           */:ehp1.
 1812   :hp1./* Compute element arrays and assemble global arrays                         */:ehp1.
 1813   :hp1./*                                                                           */:ehp1.
 1814   :hp1./*****************************************************************************/:ehp1.
 1815   
 1816   :hp3.void:ehp3. &fn0013.:spot id=sp0013.(:hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.double:ehp3. *TL, :hp3.int:ehp3. *LD, :hp3.double:ehp3. *P, :hp3.double:ehp3. *S, :hp3.int:ehp3. *IE,
:subject.PFORM
 1817              :hp3.double:ehp3. *D, :hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *F, :hp3.double:ehp3. *T, :hp3.int:ehp3. *JDIAG,
 1818              :hp3.double:ehp3. *B, :hp3.double:ehp3. *A, :hp3.double:ehp3. *C, :hp3.int:ehp3. NDF,
 1819              :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW, :hp3.double:ehp3. *U, :hp3.double:ehp3. *UD,
 1820              :hp3.int:ehp3. AFL, :hp3.int:ehp3. BFL, :hp3.int:ehp3. CFL, :hp3.int:ehp3. DFL)
 1821  &bxul.{
 1822  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1823  &bxv.    :hp1./* Loop on elements                                                      */:ehp1.
 1824  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1825  &bxv.
 1826  &bxv.    :hp3.int:ehp3. n = 0, i = 0, j = 0;
 1827  &bxv.
 1828  &bxv.    &fn0041.("PFORM");
 1829  &bxv.
 1830  &bxv.    :hp3.for:ehp3. (n = 0; n < NUMEL; n++)
 1831  &bxv.   &bxul.{
 1832  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1833  &bxv.   &bxv.    :hp1./* Set up local arrays                                               */:ehp1.
 1834  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1835  &bxv.   &bxv.   
 1836  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NEN; i++)
 1837  &bxv.   &bxv.   &bxul.{
 1838  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. II = &fn0050.(IX, n, i, NEN1), ii = II - 1;
 1839  &bxv.   &bxv.   &bxv.
 1840  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (II == 0)
 1841  &bxv.   &bxv.   &bxv.   &bxul.{
 1842  &bxv.   &bxv.   &bxv.   &bxv.    TL&lbrk.&cont.
i&rbrk. = 0&period.0;
 1843  &bxv.   &bxv.   &bxv.   &bxv.  
 1844  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < ND&cont.
M; j++)
 1845  &bxv.   &bxv.   &bxv.   &bxv.        &fn0048.(XL, i, j, NDM&cont.
, 0&period.0);
 1846  &bxv.   &bxv.   &bxv.   &bxv.  
 1847  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < ND&cont.
F; j++)
 1848  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 1849  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(UL, i,       j, NDF, 0&period.0);
 1850  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(UL, i + NEN, j, NDF, 0&period.0);
 1851  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(LD, i,       j, NDF, 0  );
 1852  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 1853  &bxv.   &bxv.   &bxv.   &bxll.}
 1854  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 1855  &bxv.   &bxv.   &bxv.   &bxul.{
 1856  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. IID = II * NDF&cont.
 - NDF;
 1857  &bxv.   &bxv.   &bxv.   &bxv.    NEL = i + 1;
 1858  &bxv.   &bxv.   &bxv.   &bxv.    TL&lbrk.&cont.
i&rbrk. = T&lbrk.ii&rbrk.;
 1859  &bxv.   &bxv.   &bxv.   &bxv.   
 1860  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < ND&cont.
M; j++)
 1861  &bxv.   &bxv.   &bxv.   &bxv.        &fn0048.(XL, i, j, NDM&cont.
, &fn0050.(X, ii, j, NDM));
 1862  &bxv.   &bxv.   &bxv.   &bxv.   
 1863  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < ND&cont.
F; j++)
 1864  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 1865  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. K = &fn0059.(&fn0050.(ID, ii, j, NDF));
 1866  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(UL, i,       j, NDF, &fn0050.(F,  ii, j, NDF) * PROP);
 1867  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(UL, i + NEN, j, NDF, &fn0050.(UD, ii, j, NDF));
 1868  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (K > 0) &fn0048.(UL, i, j, NDF, U&lbrk.K&rbrk.);
 1869  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (DFL) K = IID + j + 1;
 1870  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(LD, i, j, NDF, K);
 1871  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 1872  &bxv.   &bxv.   &bxv.   &bxll.}
 1873  &bxv.   &bxv.   &bxll.}
 1874  &bxv.   &bxv.
 1875  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1876  &bxv.   &bxv.    :hp1./* Dump the local arrays for element "1"                             */:ehp1.
 1877  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1878  &bxv.   &bxv.   
 1879  &bxv.   &bxv.    :hp3.if:ehp3. (n == 0)
 1880  &bxv.   &bxv.   &bxul.{
 1881  &bxv.   &bxv.   &bxv.    &fn0044.("ISW = %d, n = %d\n", ISW, n);
 1882  &bxv.   &bxv.   &bxv.    &fn0037.("D",  D,  "%12&period.2lf", &cont.
10,    NUMMAT);
 1883  &bxv.   &bxv.   &bxv.    &fn0037.("UL", UL, "%12&period.2lf", &cont.
NEN,   NDF);
 1884  &bxv.   &bxv.   &bxv.    &fn0037.("XL", XL, "%12&period.2lf", &cont.
NEN,   NDM);
 1885  &bxv.   &bxv.   &bxv.    &fn0037.("IX", IX, "%2d",     NUMEL, NEN1);
 1886  &bxv.   &bxv.   &bxv.    &fn0038.("TL", TL, "%lf",     NEN);
 1887  &bxv.   &bxv.   &bxv.    &fn0037.("LD", LD, "%2d",     NEN,   NDF);
 1888  &bxv.   &bxv.   &bxv.
 1889  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NEN; i++)
 1890  &bxv.   &bxv.   &bxv.   &bxul.{
 1891  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. ii = &fn0050.(IX, n, i&cont.
, NEN1);
 1892  &bxv.   &bxv.   &bxv.   &bxv.
 1893  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("         i = %d,&cont.
 ii = %d", i, ii);
 1894  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (ii != 0) &fn0044.(", T&cont.
&lbrk.%d&rbrk. = %10&period.4lf\n", ii, T&lbrk.ii&rbrk.&cont.
);
 1895  &bxv.   &bxv.   &bxv.   &bxll.}
 1896  &bxv.   &bxv.   &bxll.}
 1897  &bxv.   &bxv.
 1898  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1899  &bxv.   &bxv.    :hp1./* Form element array                                                */:ehp1.
 1900  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1901  &bxv.   &bxv.   
 1902  &bxv.   &bxv.    MA = &fn0050.(IX, n, NEN1-1, NEN1);
 1903  &bxv.   &bxv.    :hp3.if:ehp3. (IE&lbrk.MA-1&rbrk. != IEL) MCT =&cont.
 0;
 1904  &bxv.   &bxv.    IEL = IE&lbrk.MA-1&rbrk.;
 1905  &bxv.   &bxv.    &fn0008.(&amp.&fn0050.(D, MA-1, 0, 10), UL, XL, &amp.&fn0050.&cont.
(IX, n, 0, NEN1), TL, S, P, NDF, NDM, NST, ISW);
 1906  &bxv.   &bxv.   
 1907  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1908  &bxv.   &bxv.    :hp1./* Add to total array                                                */:ehp1.
 1909  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 1910  &bxv.   &bxv.   
 1911  &bxv.   &bxv.    :hp3.if:ehp3. (AFL || BFL || CFL)   &fn0006.(A, B, C, S, P, JDIAG, LD, NST, NEL*NDF, AFL, BFL, CFL);
 1912  &bxv.   &bxv.
 1913  &bxv.   &bxv.    :hp3.if:ehp3. (n == 0)   &fn0036.(NEQ, JDIAG, A, B, "PFORM");
 1914  &bxv.   &bxll.}
 1915  &bxv.
 1916  &bxv.    &fn0042.("PFORM");
 1917  &bxv.    :hp3.return:ehp3.;
 1918  &bxll.}
 1919   
.cp 25
 1920   :hp1./*****************************************************************************/:ehp1.
 1921   :hp1./*                                                                           */:ehp1.
 1922   :hp1./* Form load vector in compact form                                          */:ehp1.
 1923   :hp1./*                                                                           */:ehp1.
 1924   :hp1./*****************************************************************************/:ehp1.
 1925   
 1926   :hp3.void:ehp3. &fn0014.:spot id=sp0014.(:hp3.int:ehp3. *ID, :hp3.double:ehp3. *F, :hp3.double:ehp3. *B, :hp3.int:ehp3. NN, :hp3.double:ehp3. P)
:subject.PLOAD
 1927  &bxul.{
 1928  &bxv.    :hp3.int:ehp3. n = 0;
 1929  &bxv.
 1930  &bxv.    &fn0041.("PLOAD");
 1931  &bxv.    :hp3.for:ehp3. (n = 0; n < NN; n++)
 1932  &bxv.   &bxul.{
 1933  &bxv.   &bxv.    :hp3.int:ehp3. j = ID&lbrk.n&rbrk. - 1;
 1934  &bxv.   &bxv.
 1935  &bxv.   &bxv.    :hp3.if:ehp3. (j >= 0)    B&lbrk.j&rbrk. = F&lbrk.&cont.
n&rbrk. * P;
 1936  &bxv.   &bxll.}
 1937  &bxv.
 1938  &bxv.    &fn0042.("PLOAD");
 1939  &bxv.
 1940  &bxv.    :hp3.return:ehp3.;
 1941  &bxll.}
 1942   
.cp 98
 1943   :hp1./*****************************************************************************/:ehp1.
 1944   :hp1./*                                                                           */:ehp1.
 1945   :hp1./* Compute profile of global arrays                                          */:ehp1.
 1946   :hp1./*                                                                           */:ehp1.
 1947   :hp1./*****************************************************************************/:ehp1.
 1948   
 1949   :hp3.void:ehp3. &fn0015.:spot id=sp0015.(:hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. *ID, :hp3.int:ehp3. *IX, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NEN1, :hp3.int:ehp3. *NAD)
:subject.PROFIL
 1950  &bxul.{
 1951  &bxv.    :hp3.int:ehp3. i = 0, j = 0, k = 0, l = 0, n = 0, ii = 0, jj = 0;
 1952  &bxv.
 1953  &bxv.    &fn0041.("PROFIL");
 1954  &bxv.
 1955  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1956  &bxv.    :hp1./* Set up the equation numbers                                           */:ehp1.
 1957  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1958  &bxv.
 1959  &bxv.    NEQ = 0;
 1960  &bxv.
 1961  &bxv.    :hp3.for:ehp3. (n = 0; n < NUMNP; n++)
 1962  &bxv.   &bxul.{
 1963  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NDF; i++)
 1964  &bxv.   &bxv.   &bxul.{
 1965  &bxv.   &bxv.   &bxv.    j = &fn0050.(ID, n, i, NDF);
 1966  &bxv.   &bxv.   &bxv.     
 1967  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (j == 0)
 1968  &bxv.   &bxv.   &bxv.   &bxul.{
 1969  &bxv.   &bxv.   &bxv.   &bxv.    NEQ = NEQ + 1;
 1970  &bxv.   &bxv.   &bxv.   &bxv.    &fn0048.(ID, n, i, NDF, NE&cont.
Q);
 1971  &bxv.   &bxv.   &bxv.   &bxv.    JDIAG&lbrk.&cont.
NEQ-1&rbrk. = 0;
 1972  &bxv.   &bxv.   &bxv.   &bxll.}
 1973  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 1974  &bxv.   &bxv.   &bxv.        &fn0048.(ID, n, i, NDF, 0);
 1975  &bxv.   &bxv.   &bxll.}
 1976  &bxv.   &bxll.}
 1977  &bxv.                          
 1978  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1979  &bxv.    :hp1./* Compute column heights                                                */:ehp1.
 1980  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 1981  &bxv.
 1982  &bxv.    :hp3.for:ehp3. (n = 0; n < NUMEL; n++)
 1983  &bxv.   &bxul.{
 1984  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NEN; i++)
 1985  &bxv.   &bxv.   &bxul.{
 1986  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. II = &fn0050.(IX, n, i, NEN1);                         &cont.
ii = II - 1;
 1987  &bxv.   &bxv.   &bxv.
 1988  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (II != 0)
 1989  &bxv.   &bxv.   &bxv.   &bxul.{
 1990  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < ND&cont.
F; k++)
 1991  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 1992  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. KK = &fn0050.(ID, ii, k, NDF);
 1993  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 1994  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (KK != 0)
 1995  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 1996  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.for:ehp3. (j = i; j < NEN; j++)
 1997  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
 1998  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.int:ehp3. JJ = &fn0050.(IX, n, j, NEN1);         jj = JJ - 1;
 1999  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.
 2000  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.if:ehp3. (JJ != 0)
 2001  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxul.{
 2002  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < NDF; l++)
 2003  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxul.{
 2004  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. LL = &fn0050.(ID, j&cont.
j, l, NDF);
 2005  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.
 2006  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (LL != 0)
 2007  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2008  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. MM = &fn0055.(KK, LL),     mm = MM - 1;
 2009  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    JDIAG&lbrk.mm&rbrk. = &fn0055.(JDIAG&lbrk.mm&rbrk., &fn0049.(KK-LL)&cont.
);
 2010  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2011  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxv.   &bxll.}
 2012  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.   &bxll.}
 2013  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
 2014  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 2015  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2016  &bxv.   &bxv.   &bxv.   &bxll.}
 2017  &bxv.   &bxv.   &bxll.}
 2018  &bxv.   &bxll.}
 2019  &bxv.
 2020  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2021  &bxv.    :hp1./* Compute diagonal pointers for profile                                 */:ehp1.
 2022  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2023  &bxv.
 2024  &bxv.    *NAD = 1;
 2025  &bxv.    JDIAG&lbrk.0&rbrk. = 1;
 2026  &bxv.
 2027  &bxv.    :hp3.if:ehp3. (NEQ > 1)
 2028  &bxv.   &bxul.{
 2029  &bxv.   &bxv.    :hp3.for:ehp3. (n = 1; n < NEQ; n++)
 2030  &bxv.   &bxv.        JDIAG&lbrk.n&rbrk. = JDIAG&lbrk.&cont.
n&rbrk. + JDIAG&lbrk.n-1&rbrk. + 1;
 2031  &bxv.   &bxv.
 2032  &bxv.   &bxv.    *NAD = JDIAG&lbrk.NEQ -1&rbrk.;
 2033  &bxv.   &bxll.}
 2034  &bxv.
 2035  &bxv.    &fn0042.("PROFIL");
 2036  &bxv.    :hp3.return:ehp3.;
 2037  &bxll.}
 2038   
.cp 48
 2039   :hp1./*****************************************************************************/:ehp1.
 2040   :hp1./*                                                                           */:ehp1.
 2041   :hp1./* Routine to form C = C + A*B where A is a symmetric square matrix          */:ehp1.
 2042   :hp1./* stored in profile form, B,C are vectors, and JDIAG locates the            */:ehp1.
 2043   :hp1./* diagonals in A&period.                                                           */:ehp1.
 2044   :hp1./*                                                                           */:ehp1.
 2045   :hp1./*****************************************************************************/:ehp1.
 2046   
 2047   :hp3.void:ehp3. &fn0016.:spot id=sp0016.(:hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.double:ehp3. *C, :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NEQ)
:subject.PROMUL
 2048  &bxul.{
 2049  &bxv.    :hp3.int:ehp3. j = 0, js = 0;
 2050  &bxv.
 2051  &bxv.    &fn0041.("PROMUL");
 2052  &bxv.
 2053  &bxv.    :hp3.for:ehp3. (j = 0; j < NEQ; j++)
 2054  &bxv.   &bxul.{
 2055  &bxv.   &bxv.    :hp3.int:ehp3. jd = JDIAG&lbrk.j&rbrk. - 1;
 2056  &bxv.   &bxv.
 2057  &bxv.   &bxv.    :hp3.if:ehp3. (js <= jd)
 2058  &bxv.   &bxv.   &bxul.{
 2059  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. BJ = B&lbrk.j&rbrk.&cont.
;
 2060  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. AB = A&lbrk.jd&rbrk.&cont.
 * BJ;
 2061  &bxv.   &bxv.   &bxv.
 2062  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (js != jd)
 2063  &bxv.   &bxv.   &bxv.   &bxul.{
 2064  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. jb = j - jd;
 2065  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. je = jd + 2;
 2066  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. jj = 0;
 2067  &bxv.   &bxv.   &bxv.   &bxv.   
 2068  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (jj = js; jj <&cont.
 je; jj++)
 2069  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2070  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    AB       += A&lbrk.jj&rbrk. * B&lbrk.jj+jb&rbrk.;
 2071  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    C&lbrk.jj+jb&rbrk. += A&lbrk.jj&rbrk. * BJ;
 2072  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2073  &bxv.   &bxv.   &bxv.   &bxv.   
 2074  &bxv.   &bxv.   &bxv.   &bxv.    C&lbrk.&cont.
j&rbrk. = C&lbrk.j&rbrk. + AB;
 2075  &bxv.   &bxv.   &bxv.   &bxll.}
 2076  &bxv.   &bxv.   &bxv.
 2077  &bxv.   &bxv.   &bxv.    js = jd + 1;
 2078  &bxv.   &bxv.   &bxll.}
 2079  &bxv.   &bxll.}
 2080  &bxv.
 2081  &bxv.    &fn0042.("PROMUL");
 2082  &bxv.    :hp3.return:ehp3.;
 2083  &bxll.}
 2084   
.cp 62
 2085   :hp1./*****************************************************************************/:ehp1.
 2086   :hp1./*                                                                           */:ehp1.
 2087   :hp1./* Proprotional load table (one load card only)                              */:ehp1.
 2088   :hp1./*                                                                           */:ehp1.
 2089   :hp1./*****************************************************************************/:ehp1.
 2090   
 2091   :hp3.double:ehp3. &fn0017.:spot id=sp0017.(:hp3.double:ehp3. T, :hp3.int:ehp3. J)
:subject.PROPLD
 2092  &bxul.{
 2093  &bxv.    :hp3.static:ehp3. :hp3.int:ehp3.    K     = 0;
 2094  &bxv.    :hp3.static:ehp3. :hp3.int:ehp3.    L     = 0;
 2095  &bxv.    :hp3.static:ehp3. :hp3.double:ehp3. value = 0&period.0;
 2096  &bxv.    :hp3.static:ehp3. :hp3.double:ehp3. TMIN  = 0&period.0;
 2097  &bxv.    :hp3.static:ehp3. :hp3.double:ehp3. TMAX  = 0&period.0;
 2098  &bxv.    :hp3.static:ehp3. :hp3.double:ehp3. A&lbrk.5&rbrk.  = {0&period.0};
 2099  &bxv.
 2100  &bxv.    &fn0041.("PROPLD");
 2101  &bxv.
 2102  &bxv.    :hp3.if:ehp3. (J <= 0)
 2103  &bxv.   &bxul.{
 2104  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2105  &bxv.   &bxv.    :hp1./* Compute value at time T                                           */:ehp1.
 2106  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2107  &bxv.   &bxv.
 2108  &bxv.   &bxv.    :hp3.if:ehp3. ((T >= TMIN) &amp.&amp. (T <= T&cont.
MAX))
 2109  &bxv.   &bxv.   &bxul.{                                          
 2110  &bxv.   &bxv.   &bxv.    L = &fn0055.(L, 1);
 2111  &bxv.   &bxv.   &bxv.    value = A&lbrk.0&rbrk.&cont.
 + A&lbrk.1&rbrk. * T + &fn0060.(A&lbrk.2&rbrk.*(&fn0061.(A&lbrk.&cont.
3&rbrk.*T+A&lbrk.4&rbrk.)), (:hp3.double:ehp3.) L);
 2112  &bxv.   &bxv.   &bxll.}
 2113  &bxv.   &bxll.}
 2114  &bxv.    :hp3.else:ehp3.
 2115  &bxv.   &bxul.{
 2116  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2117  &bxv.   &bxv.    :hp1./* Input table of proportional loads                                 */:ehp1.
 2118  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2119  &bxv.   &bxv.
 2120  &bxv.   &bxv.    :hp3.int:ehp3.  I = 1;
 2121  &bxv.   &bxv.    :hp3.char:ehp3. line&lbrk.LINE_LENGTH + 1&rbrk.&cont.
 = "";
 2122  &bxv.   &bxv.
 2123  &bxv.   &bxv.    &fn0045.(line);
 2124  &bxv.   &bxv.    K    = &fn0030.   (line,   0,  5);
 2125  &bxv.   &bxv.    L    = &fn0030.   (line,   5, 10);
 2126  &bxv.   &bxv.    TMIN = &fn0031.(line,  10, 20);
 2127  &bxv.   &bxv.    TMAX = &fn0031.(line,  20, 30);
 2128  &bxv.   &bxv.    A&lbrk.0&rbrk. = &fn0031.(line,  30, 40);
 2129  &bxv.   &bxv.    A&lbrk.1&rbrk. = &fn0031.(line,  40, 50);
 2130  &bxv.   &bxv.    A&lbrk.2&rbrk. = &fn0031.(line,  50, 60);
 2131  &bxv.   &bxv.    A&lbrk.3&rbrk. = &fn0031.(line,  60, 70);
 2132  &bxv.   &bxv.    A&lbrk.4&rbrk. = &fn0031.(line,  70, 80);
 2133  &bxv.   &bxv.                              
 2134  &bxv.   &bxv.    &fn0044.("     Proportional load table\n\n");
 2135  &bxv.   &bxv.    &fn0044.("  Number    Type    Exp&period.   Minimum time    Maximum ti&cont.
me      "
 2136  &bxv.   &bxv.           "A0             A1             A2             A3             A4\n");
 2137  &bxv.   &bxv.    &fn0044.("%8ld %8ld %8ld %15&period.5lf %15&period.&cont.
5lf %15&period.5lf %15&period.5lf %15&period.5lf %15&period.5lf&cont.
 %15&period.5lf\n",
 2138  &bxv.   &bxv.            I, K, L, TMIN, TMAX, A&lbrk.0&rbrk.&cont.
, A&lbrk.1&rbrk., A&lbrk.2&rbrk., A&lbrk.&cont.
3&rbrk., A&lbrk.4&rbrk.);
 2139  &bxv.   &bxll.}
 2140  &bxv.
 2141  &bxv.    &fn0042.("PROPLD");
 2142  &bxv.    :hp3.return:ehp3. value;
 2143  &bxll.}
 2144   
.cp 50
 2145   :hp1./*****************************************************************************/:ehp1.
 2146   :hp1./*                                                                           */:ehp1.
 2147   :hp1./* Output nodal values                                                       */:ehp1.
 2148   :hp1./*                                                                           */:ehp1.
 2149   :hp1./*****************************************************************************/:ehp1.
 2150   
 2151   :hp3.void:ehp3. &fn0018.:spot id=sp0018.(:hp3.int:ehp3. *ID, :hp3.double:ehp3. *X, :hp3.double:ehp3. *B, :hp3.double:ehp3. *F, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NDF)
:subject.PRTDIS
 2152  &bxul.{
 2153  &bxv.    :hp3.int:ehp3. i = 0, ii = 0, j = 0, jj = 0, k = 0, n = 0;
 2154  &bxv.    :hp3.double:ehp3. UL&lbrk.6&rbrk. = {0};
 2155  &bxv.
 2156  &bxv.    &fn0041.("PRTDIS");
 2157  &bxv.
 2158  &bxv.    :hp3.for:ehp3. (ii = 0; ii < NUMNP; ii += 50)
 2159  &bxv.   &bxul.{
 2160  &bxv.   &bxv.    &fn0044.(O);
 2161  &bxv.   &bxv.    &fn0044.("%s\n\n", HEAD);
 2162  &bxv.   &bxv.    &fn0044.("     Nodal Displacements     Time %13&period.5lf\n\n        &cont.
 Node", TIME);
 2163  &bxv.   &bxv.
 2164  &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NDM; j++)    &fn0044.("%7d %s",  j+1, CD);
 2165  &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NDF; j++)    &fn0044.("%14d %s", j+1, DI&lbrk.0&rbrk.&cont.
);
 2166  &bxv.   &bxv.    &fn0044.("\n");
 2167  &bxv.   &bxv.
 2168  &bxv.   &bxv.    jj = &fn0051.(NUMNP, ii+49);
 2169  &bxv.   &bxv.
 2170  &bxv.   &bxv.    :hp3.for:ehp3. (n = ii; n < jj; n++)
 2171  &bxv.   &bxv.   &bxul.{                                    
 2172  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. ( ! &fn0011.(&fn0050.(X, n, 0, NDM), BLANK))
 2173  &bxv.   &bxv.   &bxv.   &bxul.{
 2174  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < ND&cont.
F; i++)
 2175  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2176  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    UL&lbrk.i&rbrk. = &fn0050.(F, n , i, NDF) * PROP;
 2177  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    k = &fn0049.(&fn0050.(ID, n, i, NDF));
 2178  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (k > 0) UL&lbrk.i&rbrk. = B&lbrk.k&rbrk.;
 2179  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2180  &bxv.   &bxv.   &bxv.   &bxv.   
 2181  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("%13d", n+1);
 2182  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < ND&cont.
M; i++)    &fn0044.("%20&period.4lf", &fn0050.(X, n, i, NDM));
 2183  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < ND&cont.
F; i++)    &fn0044.("%20&period.4lf", UL&lbrk.i&rbrk.);
 2184  &bxv.   &bxv.   &bxv.   &bxv.    &fn0044.("\n");
 2185  &bxv.   &bxv.   &bxv.   &bxll.}
 2186  &bxv.   &bxv.   &bxll.}
 2187  &bxv.   &bxll.}
 2188  &bxv.
 2189  &bxv.    &fn0042.("PRTDIS");
 2190  &bxv.    :hp3.return:ehp3.;
 2191  &bxll.}
 2192   
.cp 63
 2193   :hp1./*****************************************************************************/:ehp1.
 2194   :hp1./*                                                                           */:ehp1.
 2195   :hp1./* Print Nodal Reactions                                                     */:ehp1.
 2196   :hp1./*                                                                           */:ehp1.
 2197   :hp1./*****************************************************************************/:ehp1.
 2198   
 2199   :hp3.void:ehp3. &fn0019.:spot id=sp0019.(:hp3.double:ehp3. *R, :hp3.int:ehp3. NDF)
:subject.PRTREA
 2200  &bxul.{
 2201  &bxv.    :hp3.int:ehp3. k = 0, n = 0, i = 0, j = 0;
 2202  &bxv.    :hp3.double:ehp3. RSUM&lbrk.6&rbrk. = {0&period.0};
 2203  &bxv.    :hp3.double:ehp3. ASUM&lbrk.6&rbrk. = {0&period.0};
 2204  &bxv.
 2205  &bxv.    &fn0041.("PRTREA");
 2206  &bxv.
 2207  &bxv.    :hp3.for:ehp3. (k = 0; k < NDF; k++)
 2208  &bxv.   &bxul.{
 2209  &bxv.   &bxv.    RSUM&lbrk.k&rbrk. = 0&period.&cont.
0;
 2210  &bxv.   &bxv.    ASUM&lbrk.k&rbrk. = 0&period.&cont.
0;
 2211  &bxv.   &bxll.}
 2212  &bxv.
 2213  &bxv.    :hp3.for:ehp3. (n = 0; n < NUMNP; n += 50)
 2214  &bxv.   &bxul.{
 2215  &bxv.   &bxv.    j = &fn0051.(NUMNP, n + 50);
 2216  &bxv.   &bxv.
 2217  &bxv.   &bxv.    &fn0044.(O);
 2218  &bxv.   &bxv.    &fn0044.("%s\n\n     Nodal Reactions\n\n      Node", HEAD);
 2219  &bxv.   &bxv.
 2220  &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NDF; k++)
 2221  &bxv.   &bxv.        &fn0044.("%9d DOF", k+1);
 2222  &bxv.   &bxv.
 2223  &bxv.   &bxv.    :hp3.for:ehp3. (i = n; i < j; i++)
 2224  &bxv.   &bxv.   &bxul.{
 2225  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NDF; k++)
 2226  &bxv.   &bxv.   &bxv.   &bxul.{
 2227  &bxv.   &bxv.   &bxv.   &bxv.    &fn0048.(R, i, k, NDF, -&fn0050.(R&cont.
, i, k, NDF));
 2228  &bxv.   &bxv.   &bxv.   &bxv.    RSUM&lbrk.&cont.
k&rbrk. = RSUM&lbrk.k&rbrk. + &fn0050.(R, i, k, NDF);
 2229  &bxv.   &bxv.   &bxv.   &bxv.    ASUM&lbrk.&cont.
k&rbrk. = ASUM&lbrk.k&rbrk. + &fn0058.(&fn0050.(R, i, k, NDF));
 2230  &bxv.   &bxv.   &bxv.   &bxll.}
 2231  &bxv.   &bxv.   &bxv.
 2232  &bxv.   &bxv.   &bxv.    &fn0044.("%10d", i+1);
 2233  &bxv.   &bxv.   &bxv.
 2234  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NDF; k++)
 2235  &bxv.   &bxv.   &bxv.        &fn0044.("%13&period.4lf", &fn0050.(R, i,&cont.
 k, NDF));
 2236  &bxv.   &bxv.   &bxll.}
 2237  &bxv.   &bxll.}
 2238  &bxv.
 2239  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2240  &bxv.    :hp1./* Print Statics Check                                                   */:ehp1.
 2241  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2242  &bxv.
 2243  &bxv.    :hp3.for:ehp3. (k = 0; k < NDF; n++)
 2244  &bxv.        &fn0044.("       Sum %13&period.4\n", RSUM&lbrk.k&rbrk.&cont.
);
 2245  &bxv.
 2246  &bxv.    :hp3.for:ehp3. (k = 0; k < NDF; n++)
 2247  &bxv.        &fn0044.("       Abs sum %13&period.4\n", ASUM&lbrk.k&rbrk.&cont.
);
 2248  &bxv.
 2249  &bxv.
 2250  &bxv.    &fn0042.("PRTREA");
 2251  &bxv.    :hp3.return:ehp3.;
 2252  &bxll.}
 2253   
.cp 21
 2254   :hp1./*****************************************************************************/:ehp1.
 2255   :hp1./*                                                                           */:ehp1.
 2256   :hp1./* Set Pointer For Arrays                                                    */:ehp1.
 2257   :hp1./*                                                                           */:ehp1.
 2258   :hp1./*****************************************************************************/:ehp1.
 2259   
 2260   :hp3.void:ehp3. &fn0020.:spot id=sp0020.(:hp3.int:ehp3. *NA, :hp3.int:ehp3. *NE, :hp3.int:ehp3. NJ, :hp3.int:ehp3. *AFL)
:subject.PSETM
 2261  &bxul.{
 2262  &bxv.    &fn0041.("PSETM");
 2263  &bxv.
 2264  &bxv.    *NA  = *NE;
 2265  &bxv.    *NE  = *NE + NJ;
 2266  &bxv.    *AFL = FALSE;
 2267  &bxv.    &fn0003.(*NE);
 2268  &bxv.
 2269  &bxv.    &fn0042.("PSETM");
 2270  &bxv.    :hp3.return:ehp3.;
 2271  &bxll.}
 2272   
.cp 21
 2273   :hp1./*****************************************************************************/:ehp1.
 2274   :hp1./*                                                                           */:ehp1.
 2275   :hp1./* Zero Real Array                                                           */:ehp1.
 2276   :hp1./*                                                                           */:ehp1.
 2277   :hp1./*****************************************************************************/:ehp1.
 2278   
 2279   :hp3.void:ehp3. &fn0021.:spot id=sp0021.(:hp3.double:ehp3. *V, :hp3.int:ehp3. NN)
:subject.PZERO
 2280  &bxul.{
 2281  &bxv.    :hp3.int:ehp3. n = 0;
 2282  &bxv.
 2283  &bxv.    &fn0041.("PZERO");
 2284  &bxv.
 2285  &bxv.    :hp3.for:ehp3. (n = 0; n < NN; n++)
 2286  &bxv.        V&lbrk.n&rbrk. = 0&period.0;
 2287  &bxv.
 2288  &bxv.    &fn0042.("PZERO");
 2289  &bxv.    :hp3.return:ehp3.;
 2290  &bxll.}
 2291   
.cp 113
 2292   :hp1./*****************************************************************************/:ehp1.
 2293   :hp1./*                                                                           */:ehp1.
 2294   :hp1./* Unsymmetric, Active Column Profile Equation Solver                        */:ehp1.
 2295   :hp1./*                                                                           */:ehp1.
 2296   :hp1./*****************************************************************************/:ehp1.
 2297   
 2298   :hp3.void:ehp3. &fn0022.:spot id=sp0022.(:hp3.double:ehp3. *A, :hp3.double:ehp3. *C, :hp3.double:ehp3. *B, :hp3.int:ehp3. *JDIAG, :hp3.int:ehp3. NEQ, :hp3.int:ehp3. AFAC, :hp3.int:ehp3. BACK)
:subject.UACTCL
 2299  &bxul.{
 2300  &bxv.    :hp3.int:ehp3. i = 0, j = 0, k = 0;
 2301  &bxv.    :hp3.int:ehp3. id = 0, ie = 0, ih = 0, ir = 0, is = 0, jd = 0, jh = 0, jr = 0;
 2302  &bxv.
 2303  &bxv.    &fn0041.("UACTCOL");
 2304  &bxv.
 2305  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2306  &bxv.    :hp1./* Factor A to UT*D*U, reduce B to Y                                     */:ehp1.
 2307  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2308  &bxv.
 2309  &bxv.    jr = 0;
 2310  &bxv.
 2311  &bxv.    :hp3.for:ehp3. (j = 0; j < NEQ; j++)
 2312  &bxv.   &bxul.{
 2313  &bxv.   &bxv.    jd = JDIAG&lbrk.j&rbrk.;
 2314  &bxv.   &bxv.    jh = jd - jr;
 2315  &bxv.   &bxv.   
 2316  &bxv.   &bxv.    :hp3.if:ehp3. (jh > 1)
 2317  &bxv.   &bxv.   &bxul.{
 2318  &bxv.   &bxv.   &bxv.    is = j + 1 - jh;
 2319  &bxv.   &bxv.   &bxv.    ie = j - 1;
 2320  &bxv.   &bxv.   &bxv.   
 2321  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (AFAC)
 2322  &bxv.   &bxv.   &bxv.   &bxul.{
 2323  &bxv.   &bxv.   &bxv.   &bxv.    k = jr + 1;
 2324  &bxv.   &bxv.   &bxv.   &bxv.    id = 0;
 2325  &bxv.   &bxv.   &bxv.   &bxv.  
 2326  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2327  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Reduce all equa&cont.
tions except diagonal                      */:ehp1.
 2328  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2329  &bxv.   &bxv.   &bxv.   &bxv.  
 2330  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = is; i <= &cont.
ie; i++)
 2331  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2332  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    ir = id;
 2333  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    id = JDIAG&lbrk.i&rbrk.;
 2334  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    ih = &fn0051.(id - ir - 1, i - is);
 2335  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2336  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (ih != 0)
 2337  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 2338  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    A&lbrk.k&rbrk. = A&lbrk.k&rbrk.&cont.
 - &fn0007.(&amp.A&lbrk.k-ih&rbrk., &amp.C&lbrk.&cont.
id-ih&rbrk., ih);
 2339  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    C&lbrk.k&rbrk. = C&lbrk.k&rbrk.&cont.
 - &fn0007.(&amp.C&lbrk.k-ih&rbrk., &amp.A&lbrk.&cont.
id-ih&rbrk., ih);
 2340  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.
 2341  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.if:ehp3. (A&lbrk.id&rbrk. != 0&period.0) C&lbrk.&cont.
k&rbrk. = C&lbrk.k&rbrk. / A&lbrk.id&rbrk.&cont.
;
 2342  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 2343  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2344  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    k = k + 1;
 2345  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2346  &bxv.   &bxv.   &bxv.   &bxv.  
 2347  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2348  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Reduce diagonal&cont.
 term                                      */:ehp1.
 2349  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2350  &bxv.   &bxv.   &bxv.   &bxv.  
 2351  &bxv.   &bxv.   &bxv.   &bxv.      A&lbrk.&cont.
jd&rbrk. = A&lbrk.jd&rbrk. - &fn0007.(&amp.A&lbrk.&cont.
jr+1&rbrk., &amp.C&lbrk.jr+1&rbrk., jh-1);
 2352  &bxv.   &bxv.   &bxv.   &bxll.}
 2353  &bxv.   &bxv.   &bxv.   
 2354  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2355  &bxv.   &bxv.   &bxv.    :hp1./* Forward reduce the R&period.&cont.
H&period.S                                      */:ehp1.
 2356  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2357  &bxv.   &bxv.   &bxv.   
 2358  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (BACK) B&lbrk.j&rbrk.&cont.
 = B&lbrk.j&rbrk. - &fn0007.(&amp.C&lbrk.jr+1&rbrk.&cont.
, &amp.B&lbrk.is&rbrk., jh-1);
 2359  &bxv.   &bxv.   &bxll.}
 2360  &bxv.   &bxv.   
 2361  &bxv.   &bxv.    jr = jd;
 2362  &bxv.   &bxll.}
 2363  &bxv.
 2364  &bxv.    :hp3.if:ehp3. (BACK)
 2365  &bxv.   &bxul.{
 2366  &bxv.   &bxv.    :hp3.double:ehp3. D = 0&period.0;
 2367  &bxv.   &bxv.
 2368  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2369  &bxv.   &bxv.    :hp1./* Back substitution                                                 */:ehp1.
 2370  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2371  &bxv.   &bxv.   
 2372  &bxv.   &bxv.    j  = NEQ - 1;
 2373  &bxv.   &bxv.    jd = JDIAG&lbrk.j&rbrk.;
 2374  &bxv.   &bxv.   
 2375  &bxv.   &bxv.    :hp3.while:ehp3. (j >= 0)
 2376  &bxv.   &bxv.   &bxul.{
 2377  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (A&lbrk.jd&rbrk.&cont.
 != 0&period.0)   B&lbrk.j&rbrk. = B&lbrk.j&rbrk.&cont.
 / A&lbrk.jd&rbrk.;
 2378  &bxv.   &bxv.   &bxv.
 2379  &bxv.   &bxv.   &bxv.    D = B&lbrk.j&rbrk.&cont.
;
 2380  &bxv.   &bxv.   &bxv.    j = j - 1;
 2381  &bxv.   &bxv.   &bxv.   
 2382  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (j >= 0)
 2383  &bxv.   &bxv.   &bxv.   &bxul.{
 2384  &bxv.   &bxv.   &bxv.   &bxv.    jr = JDIAG&lbrk.&cont.
j&rbrk.;
 2385  &bxv.   &bxv.   &bxv.   &bxv.   
 2386  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (jd - jr > 1)
 2387  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2388  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    is = j - jd + jr + 2;
 2389  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    k = jr - is + 1;
 2390  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2391  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (i = is; i <= j; i++)
 2392  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
        B&lbrk.i&rbrk. = B&lbrk.i&rbrk. - A&lbrk.&cont.
i+k&rbrk. * D;
 2393  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2394  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    jd = jr;
 2395  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2396  &bxv.   &bxv.   &bxv.   &bxll.}
 2397  &bxv.   &bxv.   &bxll.}
 2398  &bxv.   &bxll.}
 2399  &bxv.
 2400  &bxv.    &fn0042.("UACTCOL");
 2401  &bxll.}
 2402   
.cp 383
 2403   :hp1./******************************************************************************
:ehp1. 2404:hp1.   *******************************************************************************
:ehp1. 2405:hp1.   *******************************************************************************
:ehp1. 2406:hp1.   *                                                                             *
:ehp1. 2407:hp1.   C ELEMENT MODULES
:ehp1. 2408:hp1.   *                                                                             *
:ehp1. 2409:hp1.   *******************************************************************************
:ehp1. 2410:hp1.   *******************************************************************************
:ehp1. 2411:hp1.   ******************************************************************************/:ehp1.
 2412    
 2413   
 2414   
 2415   
 2416   :hp1./*****************************************************************************/:ehp1.
 2417   :hp1./*                                                                           */:ehp1.
 2418   :hp1./* Plane Linear Elastic Element Routine                                      */:ehp1.
 2419   :hp1./*                                                                           */:ehp1.
 2420   :hp1./*****************************************************************************/:ehp1.
 2421   
 2422   :hp3.void:ehp3. &fn0023.:spot id=sp0023.(:hp3.double:ehp3. *D, :hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *TL, :hp3.double:ehp3. *S,
:subject.ELMT01
 2423               :hp3.double:ehp3. *P, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW)
 2424  &bxul.{
 2425  &bxv.    :hp3.double:ehp3. SHP&lbrk.9&rbrk.&lbrk.3&rbrk.&cont.
 = {{0&period.0}};
 2426  &bxv.
 2427  &bxv.    :hp3.static:ehp3. :hp3.int:ehp3.    LINT = 0;
 2428  &bxv.    :hp3.static:ehp3. :hp3.double:ehp3. SG&lbrk.9&rbrk. = {0&period.0}, T&cont.
G&lbrk.9&rbrk. = {0&period.0}, WG&lbrk.9&rbrk.&cont.
 = {0&period.0};
 2429  &bxv.
 2430  &bxv.    &fn0041.("ELMT01");
 2431  &bxv.
 2432  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2433  &bxv.    :hp1./* Go to correct array processor                                         */:ehp1.
 2434  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2435  &bxv.
 2436  &bxv.    :hp3.switch:ehp3. (ISW)
 2437  &bxv.   &bxul.{
 2438  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2439  &bxv.   &bxv.:hp1./* Input material properties                                             */:ehp1.
 2440  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2441  &bxv.   &bxv.
 2442  &bxv.   &bxv.:hp3.case:ehp3. 1&colon.
 2443  &bxv.   &bxv.   &bxul.{
 2444  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3.    I = 0, K = 0, L = 0;
 2445  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. E = 0&period.0, XNU = &cont.
0&period.0;
 2446  &bxv.   &bxv.   &bxv.    :hp3.char:ehp3.  *WD = NULL;
 2447  &bxv.   &bxv.   &bxv.
 2448  &bxv.   &bxv.   &bxv.    :hp3.char:ehp3. line&lbrk.LINE_LENGTH &cont.
+ 1&rbrk. = "";
 2449  &bxv.   &bxv.   &bxv.    &fn0045.(line);
 2450  &bxv.   &bxv.   &bxv.    E    = &fn0031.(line,  0, 10);
 2451  &bxv.   &bxv.   &bxv.    XNU  = &fn0031.(line, 10, 20);
 2452  &bxv.   &bxv.   &bxv.    D&lbrk.3&rbrk.&cont.
 = &fn0031.(line, 20, 30);
 2453  &bxv.   &bxv.   &bxv.    L    = &fn0030.   (line, 30, 35);
 2454  &bxv.   &bxv.   &bxv.    K    = &fn0030.   (line, 35, 40);
 2455  &bxv.   &bxv.   &bxv.    I    = &fn0030.   (line, 35, 40);
 2456  &bxv.   &bxv.   &bxv.
 2457  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (I == 0)
 2458  &bxv.   &bxv.   &bxv.        { I = 2;    WD = "Plane Strain"; }
 2459  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 2460  &bxv.   &bxv.   &bxv.        { I = 1;    WD = "Plane Stress"; }
 2461  &bxv.   &bxv.   &bxv.
 2462  &bxv.   &bxv.   &bxv.    D&lbrk.0&rbrk.&cont.
 = E * (1&period.0 + (1&period.0 - I) * XNU) / (1&period.0 + XNU) / (1&period.&cont.
0 - I * XNU);
 2463  &bxv.   &bxv.   &bxv.    D&lbrk.1&rbrk.&cont.
 = XNU * D&lbrk.0&rbrk. / (1&period.0 + (1&period.0 - I) * &cont.
XNU);
 2464  &bxv.   &bxv.   &bxv.    D&lbrk.2&rbrk.&cont.
 = 0&period.5 * E / (1&period.0 + XNU);
 2465  &bxv.   &bxv.   &bxv.    L = &fn0051.(3, &fn0055.(1, L));
 2466  &bxv.   &bxv.   &bxv.    D&lbrk.4&rbrk.&cont.
 = L;
 2467  &bxv.   &bxv.   &bxv.    K = &fn0051.(3, &fn0055.(1, K));
 2468  &bxv.   &bxv.   &bxv.    D&lbrk.5&rbrk.&cont.
 = K;
 2469  &bxv.   &bxv.   &bxv.    LINT = 0;
 2470  &bxv.   &bxv.   &bxv.
 2471  &bxv.   &bxv.   &bxv.    &fn0044.("     %s Linear Elastic Element\n",     WD);
 2472  &bxv.   &bxv.   &bxv.    &fn0044.("\n");
 2473  &bxv.   &bxv.   &bxv.    &fn0044.("          Modulus %18&period.&cont.
5lf\n",          E);
 2474  &bxv.   &bxv.   &bxv.    &fn0044.("          Poisson Ratio     %8&period.&cont.
5lf\n", XNU);
 2475  &bxv.   &bxv.   &bxv.    &fn0044.("          Density %18&period.&cont.
5lf\n",          D&lbrk.3&rbrk.);
 2476  &bxv.   &bxv.   &bxv.    &fn0044.("          Gauss pts/dir %6d\n",        L);
 2477  &bxv.   &bxv.   &bxv.    &fn0044.("          Stress pts    %6ld\n",       K);
 2478  &bxv.   &bxv.   &bxv.    &fn0044.("\n");
 2479  &bxv.   &bxv.   &bxv.    &fn0044.("          D&lbrk.%d&rbrk.&cont.
 = {%lf, %lf, %lf, %lf, %lf, %lf}\n\n",
 2480  &bxv.   &bxv.   &bxv.                      6, D&lbrk.&cont.
0&rbrk., D&lbrk.1&rbrk., D&lbrk.2&rbrk.&cont.
, D&lbrk.3&rbrk., D&lbrk.4&rbrk., D&lbrk.&cont.
5&rbrk.);
 2481  &bxv.   &bxv.   &bxv.    :hp3.break:ehp3.;
 2482  &bxv.   &bxv.   &bxll.}
 2483  &bxv.   &bxv.
 2484  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2485  &bxv.   &bxv.:hp1./* Compute Jacobiabs, etc&period. to check an element for errors  &cont.
              */:ehp1.
 2486  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2487  &bxv.   &bxv.
 2488  &bxv.   &bxv.:hp3.case:ehp3. 2&colon.
 2489  &bxv.   &bxv.    :hp3.break:ehp3.;
 2490  &bxv.   &bxv.
 2491  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2492  &bxv.   &bxv.:hp1./* Compute element (tangent) stiffness matrix                            */:ehp1.
 2493  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2494  &bxv.   &bxv.
 2495  &bxv.   &bxv.:hp3.case:ehp3. 3&colon.
 2496  &bxv.   &bxv.   &bxul.{
 2497  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. l = 0, j = 0, k = 0, NSL = 0;
 2498  &bxv.   &bxv.   &bxv.
 2499  &bxv.   &bxv.   &bxv.    :hp1./*----------------------------*/:ehp1.
 2500  &bxv.   &bxv.   &bxv.
 2501  &bxv.   &bxv.   &bxv.    &fn0038.("D",  D,  "%lf",     6);
 2502  &bxv.   &bxv.   &bxv.    &fn0037.("UL", UL, "%12&period.2lf", &cont.
NEN, NDF);
 2503  &bxv.   &bxv.   &bxv.    &fn0037.("XL", XL, "%12&period.2lf", &cont.
NEN, NDM);
 2504  &bxv.   &bxv.   &bxv.    &fn0038.("IX", IX, "%d",      NEN+1);
 2505  &bxv.   &bxv.   &bxv.    &fn0038.("TL", TL, "%lf",     NEN);
 2506  &bxv.   &bxv.   &bxv.
 2507  &bxv.   &bxv.   &bxv.    :hp1./*----------------------------*/:ehp1.
 2508  &bxv.   &bxv.   &bxv.
 2509  &bxv.   &bxv.   &bxv.    l = (:hp3.int:ehp3.) D&lbrk.4&rbrk.&cont.
;
 2510  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (l*l != LINT)     &fn0024.(l, &amp.&cont.
LINT, SG, TG, WG);
 2511  &bxv.   &bxv.   &bxv.
 2512  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2513  &bxv.   &bxv.   &bxv.    :hp1./* Fast stiffness computation,  compute integrals o&cont.
f shape       */:ehp1.
 2514  &bxv.   &bxv.   &bxv.    :hp1./* functions                                       &cont.
              */:ehp1.
 2515  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2516  &bxv.   &bxv.   &bxv.
 2517  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < LINT; l++)
 2518  &bxv.   &bxv.   &bxv.   &bxul.{
 2519  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. jj = 0;
 2520  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. XSJ = *TL; &cont.
                    :hp1./* dummy use of TL !!! */:ehp1.
 2521  &bxv.   &bxv.   &bxv.   &bxv.
 2522  &bxv.   &bxv.   &bxv.   &bxv.    &fn0026.(SG&lbrk.&cont.
l&rbrk., TG&lbrk.l&rbrk., XL, SHP&lbrk.0&rbrk.&cont.
, &amp.XSJ, NDM, NEL, IX, FALSE);
 2523  &bxv.   &bxv.   &bxv.   &bxv.
 2524  &bxv.   &bxv.   &bxv.   &bxv.    XSJ = XSJ * WG&lbrk.&cont.
l&rbrk.;
 2525  &bxv.   &bxv.   &bxv.   &bxv.   
 2526  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2527  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Loop over rows &cont.
                                           */:ehp1.
 2528  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2529  &bxv.   &bxv.   &bxv.   &bxv.   
 2530  &bxv.   &bxv.   &bxv.   &bxv.    jj = 0;
 2531  &bxv.   &bxv.   &bxv.   &bxv.   
 2532  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NE&cont.
L; j++)
 2533  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2534  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. k1 = 0;
 2535  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. W11 = SHP&lbrk.j&rbrk.&lbrk.0&rbrk. * XSJ;
 2536  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. W12 = SHP&lbrk.j&rbrk.&lbrk.1&rbrk. * XSJ;
 2537  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2538  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2539  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Loop over columns (symmetry noted)                    */:ehp1.
 2540  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2541  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2542  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    k1 = jj;
 2543  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2544  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (k = j; k < NEL; k++)
 2545  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 2546  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1  , jj  , NST, &fn0050.(S, k1  , jj  , NST) + W11 * SHP&lbrk.k&rbrk.&cont.
&lbrk.0&rbrk.);
 2547  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1+1, jj  , NST, &fn0050.(S, k1+1, jj  , NST) + W11 * SHP&lbrk.k&rbrk.&cont.
&lbrk.1&rbrk.);
 2548  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1  , jj+1, NST, &fn0050.(S, k1  , jj+1, NST) + W12 * SHP&lbrk.k&rbrk.&cont.
&lbrk.0&rbrk.);
 2549  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1+1, jj+1, NST, &fn0050.(S, k1+1, jj+1, NST) + W12 * SHP&lbrk.k&rbrk.&cont.
&lbrk.1&rbrk.);
 2550  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    k1 = k1 + NDF;
 2551  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 2552  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2553  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    jj = jj + NDF;
 2554  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2555  &bxv.   &bxv.   &bxv.   &bxll.}
 2556  &bxv.   &bxv.   &bxv.
 2557  &bxv.   &bxv.   &bxv.    &fn0037.("S", S, "%12&period.2lf", NS&cont.
T, NST);
 2558  &bxv.   &bxv.   &bxv.
 2559  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2560  &bxv.   &bxv.   &bxv.    :hp1./* Assemble the stiffness matrix from integrals and&cont.
 material     */:ehp1.
 2561  &bxv.   &bxv.   &bxv.    :hp1./* props&period.             &cont.
                                           */:ehp1.
 2562  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2563  &bxv.   &bxv.   &bxv.
 2564  &bxv.   &bxv.   &bxv.    NSL = NEL * NDF;
 2565  &bxv.   &bxv.   &bxv.
 2566  &bxv.   &bxv.   &bxv.    &fn0044.("    NSL = %d, NEL = %d, NDF = %d, NST = %d, LINT &cont.
= %d\n", NSL, NEL, NDF, NST, LINT);
 2567  &bxv.   &bxv.   &bxv.
 2568  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NSL; j += NDF)
 2569  &bxv.   &bxv.   &bxv.   &bxul.{
 2570  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = j; k < NS&cont.
L; k += NDF)
 2571  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2572  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. W11 = &fn0050.(S, k,   j,   NST);
 2573  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. W12 = &fn0050.(S, k+1, j,   NST);
 2574  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. W21 = &fn0050.(S, k,   j+1, NST);
 2575  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. W22 = &fn0050.(S, k+1, j+1, NST);
 2576  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2577  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, k,   j,   NST, D&lbrk.0&rbrk.*W11 + D&lbrk.2&rbrk.&cont.
*W22);
 2578  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, k+1, j,   NST, D&lbrk.1&rbrk.*W12 + D&lbrk.2&rbrk.&cont.
*W21);
 2579  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, k,   j+1, NST, D&lbrk.1&rbrk.*W21 + D&lbrk.2&rbrk.&cont.
*W12);
 2580  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, k+1, j+1, NST, D&lbrk.0&rbrk.*W22 + D&lbrk.2&rbrk.&cont.
*W11);
 2581  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2582  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2583  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Form lower part by symmetry                           */:ehp1.
 2584  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2585  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2586  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j,   k,   NST, &fn0050.(S, k,   j,   NST));
 2587  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j+1, k,   NST, &fn0050.(S, k,   j+1, NST));
 2588  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j,   k+1, NST, &fn0050.(S, k+1, j,   NST));
 2589  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j+1, k+1, NST, &fn0050.(S, k+1, j+1, NST));
 2590  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2591  &bxv.   &bxv.   &bxv.   &bxll.}
 2592  &bxv.   &bxv.   &bxv.
 2593  &bxv.   &bxv.   &bxv.    :hp1./*----------------------------*/:ehp1.
 2594  &bxv.   &bxv.   &bxv.
 2595  &bxv.   &bxv.   &bxv.    &fn0037.("S", S, "%12&period.2lf", NS&cont.
T, NST);
 2596  &bxv.   &bxv.   &bxv.
 2597  &bxv.   &bxv.   &bxv.    :hp1./*----------------------------*/:ehp1.
 2598  &bxv.   &bxv.   &bxv.
 2599  &bxv.   &bxv.   &bxv.    :hp3.break:ehp3.;
 2600  &bxv.   &bxv.   &bxll.}
 2601  &bxv.   &bxv.
 2602  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2603  &bxv.   &bxv.:hp1./* Compute and output element quantities (eg&period. stresses)    &cont.
              */:ehp1.
 2604  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2605  &bxv.   &bxv.
 2606  &bxv.   &bxv.:hp3.case:ehp3. 4&colon.
 2607  &bxv.   &bxv.:hp3.case:ehp3. 6&colon.
 2608  &bxv.   &bxv.   &bxul.{
 2609  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. l = 0, j = 0;
 2610  &bxv.   &bxv.   &bxv.
 2611  &bxv.   &bxv.   &bxv.    l = (:hp3.int:ehp3.) D&lbrk.4&rbrk.&cont.
;
 2612  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (ISW == 4) l = (:hp3.int:ehp3.) D&lbrk.&cont.
5&rbrk.;
 2613  &bxv.   &bxv.   &bxv.
 2614  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (l*l != LINT)     &fn0024.(l, &amp.&cont.
LINT, SG, TG, WG);
 2615  &bxv.   &bxv.   &bxv.
 2616  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2617  &bxv.   &bxv.   &bxv.    :hp1./* Compute element stresses, strains, and forces   &cont.
              */:ehp1.
 2618  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2619  &bxv.   &bxv.   &bxv.
 2620  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < LINT; l++)
 2621  &bxv.   &bxv.   &bxv.   &bxul.{
 2622  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3.    i = 0;
 2623  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. EPS&lbrk.&cont.
3&rbrk. = {0&period.0};
 2624  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. SIG&lbrk.&cont.
6&rbrk. = {0&period.0};
 2625  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. XX = 0&period.&cont.
0, YY = 0&period.0;
 2626  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. XSJ = *TL; &cont.
                    :hp1./* dummy use of TL !!! */:ehp1.
 2627  &bxv.   &bxv.   &bxv.   &bxv.
 2628  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2629  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Compute element&cont.
 shape functions                           */:ehp1.
 2630  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2631  &bxv.   &bxv.   &bxv.   &bxv.   
 2632  &bxv.   &bxv.   &bxv.   &bxv.    &fn0026.(SG&lbrk.&cont.
l&rbrk., TG&lbrk.l&rbrk., XL, SHP&lbrk.0&rbrk.&cont.
, &amp.XSJ, NDM, NEL, IX, FALSE);
 2633  &bxv.   &bxv.   &bxv.   &bxv.   
 2634  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2635  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Compute strains&cont.
 and coordinates                           */:ehp1.
 2636  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2637  &bxv.   &bxv.   &bxv.   &bxv.   
 2638  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < 3;&cont.
 i++)
 2639  &bxv.   &bxv.   &bxv.   &bxv.        EPS&lbrk.&cont.
i&rbrk. = 0&period.0;
 2640  &bxv.   &bxv.   &bxv.   &bxv.
 2641  &bxv.   &bxv.   &bxv.   &bxv.    XX = 0&period.&cont.
0;
 2642  &bxv.   &bxv.   &bxv.   &bxv.    YY = 0&period.&cont.
0;
 2643  &bxv.   &bxv.   &bxv.   &bxv.
 2644  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NE&cont.
L; j++)
 2645  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2646  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    XX = XX + SHP&lbrk.j&rbrk.&lbrk.2&rbrk. * &fn0050.(XL, j, 0&cont.
, NDM);
 2647  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    YY = YY + SHP&lbrk.j&rbrk.&lbrk.2&rbrk. * &fn0050.(XL, j, 1&cont.
, NDM);
 2648  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2649  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    EPS&lbrk.0&rbrk. = EPS&lbrk.0&rbrk. + SHP&lbrk.&cont.
j&rbrk.&lbrk.0&rbrk. * &fn0050.(UL, j, 0, NDF);
 2650  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    EPS&lbrk.2&rbrk. = EPS&lbrk.2&rbrk. + SHP&lbrk.&cont.
j&rbrk.&lbrk.1&rbrk. * &fn0050.(UL, j, 1, NDF);
 2651  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    EPS&lbrk.1&rbrk. = EPS&lbrk.1&rbrk. + SHP&lbrk.&cont.
j&rbrk.&lbrk.0&rbrk. * &fn0050.(UL, j, 1, NDF) + SHP&lbrk.j&rbrk.&cont.
&lbrk.1&rbrk. * &fn0050.(UL, j, 0, NDF);
 2652  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2653  &bxv.   &bxv.   &bxv.   &bxv.
 2654  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2655  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Compute stresse&cont.
s                                          */:ehp1.
 2656  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2657  &bxv.   &bxv.   &bxv.   &bxv.   
 2658  &bxv.   &bxv.   &bxv.   &bxv.    SIG&lbrk.&cont.
0&rbrk. = D&lbrk.0&rbrk. * EPS&lbrk.0&rbrk.&cont.
 + D&lbrk.1&rbrk. * EPS&lbrk.2&rbrk.;
 2659  &bxv.   &bxv.   &bxv.   &bxv.    SIG&lbrk.&cont.
2&rbrk. = D&lbrk.1&rbrk. * EPS&lbrk.0&rbrk.&cont.
 + D&lbrk.0&rbrk. * EPS&lbrk.2&rbrk.;
 2660  &bxv.   &bxv.   &bxv.   &bxv.    SIG&lbrk.&cont.
1&rbrk. = D&lbrk.2&rbrk. * EPS&lbrk.1&rbrk.&cont.
;
 2661  &bxv.   &bxv.   &bxv.   &bxv.
 2662  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (ISW != 6)
 2663  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2664  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0025.(SIG, &amp.SIG&lbrk.3&rbrk., &amp.SIG&lbrk.&cont.
4&rbrk., &amp.SIG&lbrk.5&rbrk.);
 2665  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2666  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2667  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Output stresses and strains                           */:ehp1.
 2668  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2669  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2670  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    MCT = MCT - 2;
 2671  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2672  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.if:ehp3. (MCT <= 0)
 2673  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 2674  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.(O);
 2675  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("%s\n\n     Element stresses\n\n", HEAD);
 2676  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("   Element  material      1-Coord      2-Coord    "
 2677  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.           "11-Stress    12-Stress    22-Stress    1-Stress    2-Stress   Angle\n");
 2678  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0044.("                                                  "
 2679  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.           "11-Strain    12-Strain    22-Strain\n");
 2680  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.
 2681  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    MCT = 50;
 2682  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 2683  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2684  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("%10d %10d %13&period.4lf %13&period.4lf %13&period.4lf %13&period.&cont.
4lf %13&period.4lf %13&period.4lf %13&period.4lf %8&period.2lf\&cont.
n",
 2685  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
            N, MA, XX, YY, SIG&lbrk.0&rbrk., SIG&lbrk.1&rbrk.&cont.
, SIG&lbrk.2&rbrk., SIG&lbrk.3&rbrk., SIG&lbrk.&cont.
4&rbrk., SIG&lbrk.5&rbrk.);
 2686  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0044.("                                              %13&period.4lf %13&period.4lf %13&period.&cont.
4lf\n",
 2687  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
            EPS&lbrk.0&rbrk., EPS&lbrk.1&rbrk., EPS&lbrk.&cont.
2&rbrk.);
 2688  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2689  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 2690  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2691  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2692  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Compute internal forces                               */:ehp1.
 2693  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2694  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 2695  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. DV = XSJ * WG&lbrk.l&rbrk.;
 2696  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. jj = 1;
 2697  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 2698  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (j = 0; j < NEL; j++)
 2699  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 2700  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    P&lbrk.jj&rbrk.   = P&lbrk.jj&rbrk.&cont.
   - (SHP&lbrk.j&rbrk.&lbrk.0&rbrk. * SIG&lbrk.&cont.
0&rbrk. + SHP&lbrk.j&rbrk.&lbrk.1&rbrk.&cont.
 * SIG&lbrk.1&rbrk.) * DV;
 2701  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    P&lbrk.jj+1&rbrk. = P&lbrk.jj+1&rbrk.&cont.
 - (SHP&lbrk.j&rbrk.&lbrk.0&rbrk. * SIG&lbrk.&cont.
1&rbrk. + SHP&lbrk.j&rbrk.&lbrk.1&rbrk.&cont.
 * SIG&lbrk.2&rbrk.) * DV;
 2702  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    jj = jj + NDF;
 2703  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 2704  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2705  &bxv.   &bxv.   &bxv.   &bxll.}
 2706  &bxv.   &bxv.   &bxv.    :hp3.break:ehp3.;
 2707  &bxv.   &bxv.   &bxll.}
 2708  &bxv.   &bxv.
 2709  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2710  &bxv.   &bxv.:hp1./* Compute constistent mass matrix                                       */:ehp1.
 2711  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2712  &bxv.   &bxv.
 2713  &bxv.   &bxv.:hp3.case:ehp3. 5&colon.
 2714  &bxv.   &bxv.   &bxul.{
 2715  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. l = 0, j = 0, k = 0, NSL = 0;
 2716  &bxv.   &bxv.   &bxv.
 2717  &bxv.   &bxv.   &bxv.    l = (:hp3.int:ehp3.)  D&lbrk.4&rbrk.&cont.
;
 2718  &bxv.   &bxv.   &bxv.
 2719  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (l*l != LINT)      &fn0024.(l, &amp.&cont.
LINT, SG, TG, WG);
 2720  &bxv.   &bxv.   &bxv.
 2721  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < LINT; l++)
 2722  &bxv.   &bxv.   &bxv.   &bxul.{
 2723  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. DV = 0&period.&cont.
0;
 2724  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. XSJ = *TL; &cont.
                    :hp1./* dummy use of TL !!! */:ehp1.
 2725  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3.    jj = 0;
 2726  &bxv.   &bxv.   &bxv.   &bxv.
 2727  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2728  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Compute shape f&cont.
unctions                                   */:ehp1.
 2729  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2730  &bxv.   &bxv.   &bxv.   &bxv.   
 2731  &bxv.   &bxv.   &bxv.   &bxv.    &fn0026.(SG&lbrk.&cont.
l&rbrk., TG&lbrk.l&rbrk., XL, SHP&lbrk.0&rbrk.&cont.
, &amp.XSJ, NDM, NEL, IX, FALSE);
 2732  &bxv.   &bxv.   &bxv.   &bxv.    DV = WG&lbrk.&cont.
l&rbrk. * XSJ * D&lbrk.3&rbrk.;
 2733  &bxv.   &bxv.   &bxv.   &bxv.   
 2734  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2735  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* For each node J&cont.
 compute DB = RHO*SHAPE*DV                 */:ehp1.
 2736  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 2737  &bxv.   &bxv.   &bxv.   &bxv.   
 2738  &bxv.   &bxv.   &bxv.   &bxv.    jj = 0;
 2739  &bxv.   &bxv.   &bxv.   &bxv.   
 2740  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NE&cont.
L; j++)
 2741  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2742  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. W11 = SHP&lbrk.j&rbrk.&lbrk.2&rbrk. * DV;
 2743  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
 2744  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2745  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* For each node K compute mass matrix (upper triangular */:ehp1.
 2746  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* part)                                                 */:ehp1.
 2747  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 2748  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
 2749  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. k1 = jj;
 2750  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
 2751  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (k = j; k < NEL; k++)
 2752  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 2753  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1, jj, NST, &fn0050.(S, k1, jj, NST) + SHP&lbrk.j&rbrk.&lbrk.&cont.
2&rbrk. * W11);
 2754  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    k1 = k1 + NDF;
 2755  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 2756  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
 
 2757  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    jj = jj + NDF;
 2758  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2759  &bxv.   &bxv.   &bxv.   &bxll.}
 2760  &bxv.   &bxv.   &bxv.
 2761  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2762  &bxv.   &bxv.   &bxv.    :hp1./* Compute missing parts and lower part by symmetri&cont.
es            */:ehp1.
 2763  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 2764  &bxv.   &bxv.   &bxv.
 2765  &bxv.   &bxv.   &bxv.    NSL = NEL * NDF;
 2766  &bxv.   &bxv.   &bxv.
 2767  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NSL; j+= NDF)
 2768  &bxv.   &bxv.   &bxv.   &bxul.{
 2769  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = j; k < NS&cont.
L; k += NDF)
 2770  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 2771  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, k+1, j+1, NST, &fn0050.(S, k, j, NST));
 2772  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j,   k,   NST, &fn0050.(S, k, j, NST));
 2773  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j+1, k+1, NST, &fn0050.(S, k, j, NST));
 2774  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 2775  &bxv.   &bxv.   &bxv.   &bxll.}
 2776  &bxv.   &bxv.   &bxv.    :hp3.break:ehp3.;
 2777  &bxv.   &bxv.   &bxll.}
 2778  &bxv.   &bxll.}
 2779  &bxv.
 2780  &bxv.    &fn0042.("ELMT01");
 2781  &bxv.    :hp3.return:ehp3.;
 2782  &bxll.}
 2783   
.cp 72
 2784   :hp1./*****************************************************************************/:ehp1.
 2785   :hp1./*                                                                           */:ehp1.
 2786   :hp1./* Gauss points and weights for two dimensions                               */:ehp1.
 2787   :hp1./*                                                                           */:ehp1.
 2788   :hp1./*****************************************************************************/:ehp1.
 2789   
 2790   :hp3.void:ehp3. &fn0024.:spot id=sp0024.(:hp3.int:ehp3. l, :hp3.int:ehp3. *LINT, :hp3.double:ehp3. *R, :hp3.double:ehp3. *Z, :hp3.double:ehp3. *W)
:subject.PGAUSS
 2791  &bxul.{
 2792  &bxv.    :hp3.int:ehp3. LR&lbrk.9&rbrk. = {-1,  1,  1, -1,  0,  1,  0, -1,  0};
 2793  &bxv.    :hp3.int:ehp3. LZ&lbrk.9&rbrk. = {-1, -1,  1,  1, -1,  0,  1,  0,  0};
 2794  &bxv.    :hp3.int:ehp3. LW&lbrk.9&rbrk. = {25, 25, 25, 25, 40, 40, 40, 40, 64};
 2795  &bxv.    :hp3.int:ehp3. i = 0;
 2796  &bxv.    :hp3.double:ehp3. G = 0&period.0, H = 0&period.0;
 2797  &bxv.
 2798  &bxv.    &fn0041.("PGAUSS&colon. l = %d", l);
 2799  &bxv.
 2800  &bxv.    *LINT = l * l;
 2801  &bxv.
 2802  &bxv.    :hp3.switch:ehp3. (l)
 2803  &bxv.   &bxul.{
 2804  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2805  &bxv.   &bxv.:hp1./* 1X1 Integration                                                       */:ehp1.
 2806  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2807  &bxv.   &bxv.
 2808  &bxv.   &bxv.:hp3.case:ehp3. 1&colon.
 2809  &bxv.   &bxv.    R&lbrk.0&rbrk. = 0&period.&cont.
0;
 2810  &bxv.   &bxv.    Z&lbrk.0&rbrk. = 0&period.&cont.
0;
 2811  &bxv.   &bxv.    W&lbrk.0&rbrk. = 4&period.&cont.
0;
 2812  &bxv.   &bxv.    :hp3.break:ehp3.;
 2813  &bxv.   &bxv.
 2814  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2815  &bxv.   &bxv.:hp1./* 2X2 Integration                                                       */:ehp1.
 2816  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2817  &bxv.   &bxv.
 2818  &bxv.   &bxv.:hp3.case:ehp3. 2&colon.
 2819  &bxv.   &bxv.    G = 1&period.0 / &fn0056.(3&period.0);
 2820  &bxv.   &bxv.
 2821  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < 4; i++)
 2822  &bxv.   &bxv.   &bxul.{
 2823  &bxv.   &bxv.   &bxv.    R&lbrk.i&rbrk.&cont.
 = G * LR&lbrk.i&rbrk.;
 2824  &bxv.   &bxv.   &bxv.    Z&lbrk.i&rbrk.&cont.
 = G * LZ&lbrk.i&rbrk.;
 2825  &bxv.   &bxv.   &bxv.    W&lbrk.i&rbrk.&cont.
 = 1&period.0;
 2826  &bxv.   &bxv.   &bxll.}
 2827  &bxv.   &bxv.    :hp3.break:ehp3.;
 2828  &bxv.   &bxv.
 2829  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2830  &bxv.   &bxv.:hp1./* 3X3 Integration                                                       */:ehp1.
 2831  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 2832  &bxv.   &bxv.
 2833  &bxv.   &bxv.:hp3.case:ehp3. 3&colon.
 2834  &bxv.   &bxv.    G = &fn0056.(0&period.6);
 2835  &bxv.   &bxv.    H = 1&period.0 / 81&period.0;
 2836  &bxv.   &bxv.
 2837  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < 9; i++)
 2838  &bxv.   &bxv.   &bxul.{
 2839  &bxv.   &bxv.   &bxv.    R&lbrk.i&rbrk.&cont.
 = G * LR&lbrk.i&rbrk.;
 2840  &bxv.   &bxv.   &bxv.    Z&lbrk.i&rbrk.&cont.
 = G * LZ&lbrk.i&rbrk.;
 2841  &bxv.   &bxv.   &bxv.    W&lbrk.i&rbrk.&cont.
 = H * LW&lbrk.i&rbrk.;
 2842  &bxv.   &bxv.   &bxll.}
 2843  &bxv.   &bxv.    :hp3.break:ehp3.;
 2844  &bxv.   &bxll.}
 2845  &bxv.
 2846  &bxv.    &fn0038.("R",  R,  "%lf", *LINT);
 2847  &bxv.    &fn0038.("Z",  Z,  "%lf", *LINT);
 2848  &bxv.    &fn0038.("W",  W,  "%lf", *LINT);
 2849  &bxv.
 2850  &bxv.    &fn0042.("PGAUSS");
 2851  &bxv.    :hp3.return:ehp3.;
 2852  &bxll.}
 2853   
.cp 31
 2854   :hp1./*****************************************************************************/:ehp1.
 2855   :hp1./*                                                                           */:ehp1.
 2856   :hp1./* Compute principle stresses (2 dimensioons)                                */:ehp1.
 2857   :hp1./*                                                                           */:ehp1.
 2858   :hp1./*****************************************************************************/:ehp1.
 2859   
 2860   :hp3.void:ehp3. &fn0025.:spot id=sp0025.(:hp3.double:ehp3. *SIG, :hp3.double:ehp3. *P1, :hp3.double:ehp3. *P2, :hp3.double:ehp3. *P3)
:subject.PSTRES
 2861  &bxul.{
 2862  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2863  &bxv.    :hp1./* Stresses must be stored in array SIG&lbrk.3&rbrk. in the order    &cont.
              */:ehp1.
 2864  &bxv.    :hp1./* tau-xx, tau-XY, tau-YY                                                */:ehp1.
 2865  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2866  &bxv. 
 2867  &bxv.    :hp3.double:ehp3. XI1 = (SIG&lbrk.0&rbrk. + SIG&lbrk.2&rbrk.&cont.
) / 2&period.0;
 2868  &bxv.    :hp3.double:ehp3. XI2 = (SIG&lbrk.0&rbrk. - SIG&lbrk.2&rbrk.&cont.
) / 2&period.0;
 2869  &bxv.    :hp3.double:ehp3. RHO = &fn0056.(XI2*XI2 + SIG&lbrk.1&rbrk.*SIG&lbrk.&cont.
1&rbrk.);
 2870  &bxv.
 2871  &bxv.    &fn0041.("PSTRES");
 2872  &bxv.
 2873  &bxv.    *P1 = XI1 + RHO;
 2874  &bxv.    *P2 = XI1 - RHO;
 2875  &bxv.    *P3 = 45&period.0;
 2876  &bxv.                                         
 2877  &bxv.    :hp3.if:ehp3. (XI2 != 0&period.0)   *P3 = 22&period.5 * &fn0062.(SIG&lbrk.&cont.
1&rbrk., XI2) / &fn0063.(1&period.0);
 2878  &bxv.
 2879  &bxv.    &fn0042.("PSTRES");
 2880  &bxv.    :hp3.return:ehp3.;
 2881  &bxll.}
 2882   
.cp 99
 2883   :hp1./*****************************************************************************/:ehp1.
 2884   :hp1./*                                                                           */:ehp1.
 2885   :hp1./* Shape function routine for two dimensions                                 */:ehp1.
 2886   :hp1./*                                                                           */:ehp1.
 2887   :hp1./*****************************************************************************/:ehp1.
 2888   
 2889   :hp3.void:ehp3. &fn0026.:spot id=sp0026.(:hp3.double:ehp3. SS, :hp3.double:ehp3. TT, :hp3.double:ehp3. *X, :hp3.double:ehp3. *SHP, :hp3.double:ehp3. *XSJ, 
:subject.SHAPE
 2890              :hp3.int:ehp3. NDM, :hp3.int:ehp3. NEL, :hp3.int:ehp3. *IX, :hp3.int:ehp3. FLG)
 2891  &bxul.{
 2892  &bxv.    :hp3.double:ehp3. S&lbrk.4&rbrk. = {-0&period.5,  0&period.&cont.
5,  0&period.5, -0&period.5};
 2893  &bxv.    :hp3.double:ehp3. T&lbrk.4&rbrk. = {-0&period.5, -0&period.&cont.
5,  0&period.5,  0&period.5};
 2894  &bxv.    :hp3.double:ehp3. XS&lbrk.2&rbrk.&lbrk.2&rbrk.&cont.
 = {{0&period.0}};
 2895  &bxv.    :hp3.double:ehp3. SX&lbrk.2&rbrk.&lbrk.2&rbrk.&cont.
 = {{0&period.0}};
 2896  &bxv.    :hp3.int:ehp3. i = 0, j = 0;
 2897  &bxv.
 2898  &bxv.    &fn0041.("SHAPE&colon. SS = %lf, TT = %lf, NDM = %d, NEL = %d, FLG = %d", SS, TT, NDM, NEL, FLG);
 2899  &bxv.
 2900  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2901  &bxv.    :hp1./* Form 4-node quadrilateral shape functions                             */:ehp1.
 2902  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2903  &bxv.
 2904  &bxv.    :hp3.for:ehp3. (i = 0; i < 4; i++)
 2905  &bxv.   &bxul.{
 2906  &bxv.   &bxv.    &fn0048.(SHP, i, 2, 3, (0&period.5 + S&lbrk.i&rbrk.&cont.
 * SS) * (0&period.5 + T&lbrk.i&rbrk. * TT));
 2907  &bxv.   &bxv.    &fn0048.(SHP, i, 0, 3, S&lbrk.i&rbrk. * (0&period.&cont.
5 + T&lbrk.i&rbrk. * TT));
 2908  &bxv.   &bxv.    &fn0048.(SHP, i, 1, 3, T&lbrk.i&rbrk. * (0&period.&cont.
5 + S&lbrk.i&rbrk. * SS));
 2909  &bxv.   &bxll.}
 2910  &bxv.
 2911  &bxv.    :hp3.if:ehp3. (NEL < 4)
 2912  &bxv.   &bxul.{
 2913  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2914  &bxv.   &bxv.    :hp1./* Form triangle by adding third and fourth together                 */:ehp1.
 2915  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2916  &bxv.   &bxv.   
 2917  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < 3; i++)
 2918  &bxv.   &bxv.   &bxul.{
 2919  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, 2, i, 3, &fn0050.(SHP, 2, i, 3) + &fn0050.(SHP, 3, i, 3));
 2920  &bxv.   &bxv.   &bxll.}
 2921  &bxv.   &bxll.}
 2922  &bxv.
 2923  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2924  &bxv.    :hp1./* Add quadratic terms if necessary                                      */:ehp1.
 2925  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2926  &bxv.
 2927  &bxv.    :hp3.if:ehp3. (NEL > 4)     &fn0027.(SS, TT, SHP, IX, NEL);
 2928  &bxv.    
 2929  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2930  &bxv.    :hp1./* Construct jacobian and its inverse                                    */:ehp1.
 2931  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 2932  &bxv.
 2933  &bxv.    :hp3.for:ehp3. (i = 0; i < NDM; i++)
 2934  &bxv.   &bxul.{
 2935  &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < 2; j++)
 2936  &bxv.   &bxv.   &bxul.{
 2937  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. k = 0;
 2938  &bxv.   &bxv.   &bxv.
 2939  &bxv.   &bxv.   &bxv.    XS&lbrk.j&rbrk.&cont.
&lbrk.i&rbrk. = 0&period.0;
 2940  &bxv.   &bxv.   &bxv.
 2941  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NEL; k++)
 2942  &bxv.   &bxv.   &bxv.   &bxul.{
 2943  &bxv.   &bxv.   &bxv.   &bxv.    XS&lbrk.&cont.
j&rbrk.&lbrk.i&rbrk. = XS&lbrk.j&rbrk.&cont.
&lbrk.i&rbrk. + &fn0050.(X, k, i, NDM) * &fn0050.(SHP, k, j, 3);
 2944  &bxv.   &bxv.   &bxv.   &bxll.}
 2945  &bxv.   &bxv.   &bxll.}
 2946  &bxv.   &bxll.}
 2947  &bxv.
 2948  &bxv.    *XSJ = XS&lbrk.0&rbrk.&lbrk.0&rbrk.&cont.
 * XS&lbrk.1&rbrk.&lbrk.1&rbrk. - XS&lbrk.&cont.
0&rbrk.&lbrk.1&rbrk. * XS&lbrk.1&rbrk.&cont.
&lbrk.0&rbrk.;
 2949  &bxv.
 2950  &bxv.    &fn0037.("SHP", SHP, "%12&period.6lf", NEL, 3);
 2951  &bxv.    &fn0037.("XS", XS, "%12&period.6lf", 2, 2);
 2952  &bxv.    &fn0044.("*XSJ = %lf\n", *XSJ);
 2953  &bxv.
 2954  &bxv.    :hp3.if:ehp3. (!FLG)
 2955  &bxv.   &bxul.{
 2956  &bxv.   &bxv.    SX&lbrk.0&rbrk.&lbrk.&cont.
0&rbrk. =   XS&lbrk.1&rbrk.&lbrk.1&rbrk.&cont.
 / (*XSJ);
 2957  &bxv.   &bxv.    SX&lbrk.1&rbrk.&lbrk.&cont.
1&rbrk. =   XS&lbrk.0&rbrk.&lbrk.0&rbrk.&cont.
 / (*XSJ);
 2958  &bxv.   &bxv.    SX&lbrk.1&rbrk.&lbrk.&cont.
0&rbrk. = - XS&lbrk.1&rbrk.&lbrk.0&rbrk.&cont.
 / (*XSJ);
 2959  &bxv.   &bxv.    SX&lbrk.0&rbrk.&lbrk.&cont.
1&rbrk. = - XS&lbrk.0&rbrk.&lbrk.1&rbrk.&cont.
 / (*XSJ);
 2960  &bxv.   &bxv.                             
 2961  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2962  &bxv.   &bxv.    :hp1./* Form global derivatives                                           */:ehp1.
 2963  &bxv.   &bxv.    :hp1./*-------------------------------------------------------------------*/:ehp1.
 2964  &bxv.   &bxv.   
 2965  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NEL; i++)
 2966  &bxv.   &bxv.   &bxul.{
 2967  &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. TP       = &fn0050.(SHP, i, 0, 3) * SX&lbrk.&cont.
0&rbrk.&lbrk.0&rbrk. + &fn0050.(SHP, i, 1, 3) * SX&lbrk.0&rbrk.&cont.
&lbrk.1&rbrk.;
 2968  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, i, 1, 3, &fn0050.(SHP, i, 0, 3) * SX&lbrk.&cont.
1&rbrk.&lbrk.0&rbrk. + &fn0050.(SHP, i, 1, 3) * SX&lbrk.1&rbrk.&cont.
&lbrk.1&rbrk.);
 2969  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, i, 0, 3, TP);
 2970  &bxv.   &bxv.   &bxll.}
 2971  &bxv.   &bxv.
 2972  &bxv.   &bxv.    &fn0037.("SX", SX, "%12&period.6lf", 2, 2);
 2973  &bxv.   &bxv.    &fn0037.("SHP", SHP, "%12&period.6lf", NEL, 3);
 2974  &bxv.   &bxll.}
 2975  &bxv.
 2976  &bxv.    &fn0042.("SHAPE");
 2977  &bxv.    :hp3.return:ehp3.;
 2978  &bxll.}
 2979   
.cp 118
 2980   :hp1./*****************************************************************************/:ehp1.
 2981   :hp1./*                                                                           */:ehp1.
 2982   :hp1./* Add quadratic functions as necessary                                      */:ehp1.
 2983   :hp1./*                                                                           */:ehp1.
 2984   :hp1./*****************************************************************************/:ehp1.
 2985   
 2986   :hp3.void:ehp3. &fn0027.:spot id=sp0027.(:hp3.double:ehp3. S, :hp3.double:ehp3. T, :hp3.double:ehp3. *SHP, :hp3.int:ehp3. *IX, :hp3.int:ehp3. NEL)
:subject.SHAP2
 2987  &bxul.{
 2988  &bxv.    :hp3.double:ehp3. S2 = (1&period.0 - S * S) / 2&period.0;
 2989  &bxv.    :hp3.double:ehp3. T2 = (1&period.0 - T * T) / 2&period.0;
 2990  &bxv.    :hp3.int:ehp3. i = 0;
 2991  &bxv.    :hp3.int:ehp3. j = 0;
 2992  &bxv.    :hp3.int:ehp3. k = 0;
 2993  &bxv.    :hp3.int:ehp3. l = 0;
 2994  &bxv.
 2995  &bxv.    &fn0041.("SHAP2");
 2996  &bxv.
 2997  &bxv.    :hp3.for:ehp3. (i = 4; i < 9; i++)
 2998  &bxv.   &bxul.{
 2999  &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < 3; j++)
 3000  &bxv.   &bxv.   &bxul.{
 3001  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, i, j, 3, 0&period.0);
 3002  &bxv.   &bxv.   &bxll.}
 3003  &bxv.   &bxll.}
 3004  &bxv.
 3005  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3006  &bxv.    :hp1./* Midside nodes (serendipty)                                            */:ehp1.
 3007  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3008  &bxv.
 3009  &bxv.    :hp3.if:ehp3. (IX&lbrk.4&rbrk. != 0)
 3010  &bxv.   &bxul.{
 3011  &bxv.   &bxv.    &fn0048.(SHP, 4, 0, 3, -S * (1&period.0 - T));
 3012  &bxv.   &bxv.    &fn0048.(SHP, 4, 1, 3, -S2);
 3013  &bxv.   &bxv.    &fn0048.(SHP, 4, 2, 3, S2 * (1&period.0 - T));
 3014  &bxv.   &bxll.}
 3015  &bxv.
 3016  &bxv.    :hp3.if:ehp3. (NEL >= 6)
 3017  &bxv.   &bxul.{
 3018  &bxv.   &bxv.    :hp3.if:ehp3. (IX&lbrk.5&rbrk. != 0)
 3019  &bxv.   &bxv.   &bxul.{
 3020  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, 5, 0, 3, T2);
 3021  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, 5, 1, 3, -T * (1&period.&cont.
0 + S));
 3022  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, 5, 2, 3, T2 * (1&period.&cont.
0 + S));
 3023  &bxv.   &bxv.   &bxll.}
 3024  &bxv.   &bxv.   
 3025  &bxv.   &bxv.    :hp3.if:ehp3. (NEL >= 7)
 3026  &bxv.   &bxv.   &bxul.{
 3027  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (IX&lbrk.6&rbrk.&cont.
 != 0)
 3028  &bxv.   &bxv.   &bxv.   &bxul.{
 3029  &bxv.   &bxv.   &bxv.   &bxv.    &fn0048.(SHP, 6, 0, 3, -S &cont.
* (1&period.0 + T));
 3030  &bxv.   &bxv.   &bxv.   &bxv.    &fn0048.(SHP, 6, 1, 3, S2)&cont.
;
 3031  &bxv.   &bxv.   &bxv.   &bxv.    &fn0048.(SHP, 6, 2, 3, S2 &cont.
* (1&period.0 + T));
 3032  &bxv.   &bxv.   &bxv.   &bxll.}
 3033  &bxv.   &bxv.   &bxv.   
 3034  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (NEL >= 8)
 3035  &bxv.   &bxv.   &bxv.   &bxul.{
 3036  &bxv.   &bxv.   &bxv.   &bxv.      :hp3.if:ehp3. (IX&lbrk.&cont.
7&rbrk. != 0)
 3037  &bxv.   &bxv.   &bxv.   &bxv.     &bxul.&cont.
{
 3038  &bxv.   &bxv.   &bxv.   &bxv.     &bxv.&cont.
    &fn0048.(SHP, 7, 0, 3, -T2);
 3039  &bxv.   &bxv.   &bxv.   &bxv.     &bxv.&cont.
    &fn0048.(SHP, 7, 1, 3, -T * (1&period.0 - S));
 3040  &bxv.   &bxv.   &bxv.   &bxv.     &bxv.&cont.
    &fn0048.(SHP, 7, 2, 3, T2 * (1&period.0 - S));
 3041  &bxv.   &bxv.   &bxv.   &bxv.     &bxll.&cont.
}
 3042  &bxv.   &bxv.   &bxv.   &bxv.   
 3043  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3044  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Interior node (&cont.
lagrangian)                                */:ehp1.
 3045  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3046  &bxv.   &bxv.   &bxv.   &bxv.   
 3047  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. ((NEL >= 9) &amp.&cont.
&amp. (IX&lbrk.8&rbrk. != 0))
 3048  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 3049  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(SHP, 8, 0, 3, -4&period.0 * S * T2);
 3050  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(SHP, 8, 1, 3, -4&period.0 * T * S2);
 3051  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(SHP, 8, 2, 3,  4&period.0 * S2 * T2);
 3052  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 3053  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 3054  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Correct edge nodes for interior node (lagrangian)     */:ehp1.
 3055  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 3056  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 3057  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (j = 0; j < 3; j++)
 3058  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 3059  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.for:ehp3. (i = 0; j < 4; j++)
 3060  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
 3061  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    &fn0048.(SHP, i, j, 3, &fn0050.(SHP, i, j, 3) - 0&period.25 * &fn0050.(SHP, 8, j, 3&cont.
));
 3062  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
 3063  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   
 3064  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.for:ehp3. (i = 4; i < 8; i++)
 3065  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
 3066  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    :hp3.if:ehp3. (IX&lbrk.i&rbrk. != 0)   &fn0048.(SHP,&cont.
 i, j, 3, &fn0050.(SHP, i, j, 3) - 0&period.5 * &fn0050.(SHP, 8, j, 3));
 3067  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
 3068  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 3069  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 3070  &bxv.   &bxv.   &bxv.   &bxll.}
 3071  &bxv.   &bxv.   &bxll.}
 3072  &bxv.   &bxll.}
 3073  &bxv.
 3074  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3075  &bxv.    :hp1./* Correct corner nodes for presence of midside nodes                    */:ehp1.
 3076  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3077  &bxv.
 3078  &bxv.    k = 8;
 3079  &bxv.
 3080  &bxv.    :hp3.for:ehp3. (i = 0; i < 4; i++)
 3081  &bxv.   &bxul.{
 3082  &bxv.   &bxv.    l = i + 4;
 3083  &bxv.   &bxv.
 3084  &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < 3; j++)
 3085  &bxv.   &bxv.   &bxul.{
 3086  &bxv.   &bxv.   &bxv.    &fn0048.(SHP, i, j, 3, &fn0050.(SHP, i, j, 3) - 0&period.&cont.
5 * (&fn0050.(SHP, k, j, 3) + &fn0050.(SHP, l, j, 3)));
 3087  &bxv.   &bxv.   &bxll.}
 3088  &bxv.   &bxv.
 3089  &bxv.   &bxv.    k = l;
 3090  &bxv.   &bxll.}
 3091  &bxv.
 3092  &bxv.    &fn0042.("SHAP2");
 3093  &bxv.    :hp3.return:ehp3.;
 3094  &bxll.}
 3095   
.cp 155
 3096   :hp1./*****************************************************************************/:ehp1.
 3097   :hp1./*                                                                           */:ehp1.
 3098   :hp1./* Two dimensional heat transfer element                                     */:ehp1.
 3099   :hp1./*                                                                           */:ehp1.
 3100   :hp1./*****************************************************************************/:ehp1.
 3101   
 3102   :hp3.void:ehp3. &fn0028.:spot id=sp0028.(:hp3.double:ehp3. *D, :hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *TL,
:subject.ELMT02
 3103               :hp3.double:ehp3. *S, :hp3.double:ehp3. *P, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW)
 3104  &bxul.{
 3105  &bxv.    :hp3.double:ehp3. XSJ = *TL;
 3106  &bxv.    :hp3.int:ehp3. i = NDF, j = 0, l = 0;
 3107  &bxv.    :hp3.double:ehp3. SG&lbrk.4&rbrk. = { 1&period.0 ,  1&period.&cont.
0 , -1&period.0 , -1&period.0};
 3108  &bxv.    :hp3.double:ehp3. TG&lbrk.4&rbrk. = {-1&period.0 ,  1&period.&cont.
0 ,  1&period.0 , -1&period.0};
 3109  &bxv.    :hp3.double:ehp3. G = 1&period.0 / &fn0056.(3&period.0);
 3110  &bxv.    :hp3.double:ehp3. SHP&lbrk.9&rbrk.&lbrk.3&rbrk.&cont.
 = {{0&period.0}};
 3111  &bxv.
 3112  &bxv.    :hp3.static:ehp3. :hp3.int:ehp3.    KAT = 0;
 3113  &bxv.
 3114  &bxv.    &fn0041.("ELMT02");
 3115  &bxv.
 3116  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3117  &bxv.    :hp1./* Transfer to correct processor                                         */:ehp1.
 3118  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3119  &bxv.
 3120  &bxv.    :hp3.switch:ehp3. (ISW)
 3121  &bxv.   &bxul.{
 3122  &bxv.   &bxv.
 3123  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3124  &bxv.   &bxv.:hp1./* Input material properties                                             */:ehp1.
 3125  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3126  &bxv.   &bxv.
 3127  &bxv.   &bxv.:hp3.case:ehp3. 1&colon.
 3128  &bxv.   &bxv.   &bxul.{
 3129  &bxv.   &bxv.   &bxv.    :hp3.char:ehp3. *WLAB = NULL;
 3130  &bxv.   &bxv.   &bxv.    :hp3.char:ehp3. line&lbrk.LINE_LENGTH &cont.
+ 1&rbrk. = "";
 3131  &bxv.   &bxv.   &bxv.
 3132  &bxv.   &bxv.   &bxv.    &fn0045.(line);
 3133  &bxv.   &bxv.   &bxv.    D&lbrk.0&rbrk.&cont.
 = &fn0031.(line,  0, 10);
 3134  &bxv.   &bxv.   &bxv.    D&lbrk.1&rbrk.&cont.
 = &fn0031.(line, 10, 20);
 3135  &bxv.   &bxv.   &bxv.    D&lbrk.2&rbrk.&cont.
 = &fn0031.(line, 20, 30);
 3136  &bxv.   &bxv.   &bxv.    KAT  = &fn0030.   (line, 30, 35);
 3137  &bxv.   &bxv.   &bxv.
 3138  &bxv.   &bxv.   &bxv.    &fn0044.("    Linear heat conduction element\n\n");
 3139  &bxv.   &bxv.   &bxv.    &fn0044.("     Conductivity %12&period.&cont.
5lf     Specific heat %12&period.5lf       Density        %12&period.5lf\n",
 3140  &bxv.   &bxv.   &bxv.           D&lbrk.0&rbrk.&cont.
, D&lbrk.1&rbrk., D&lbrk.2&rbrk.);
 3141  &bxv.   &bxv.   &bxv.
 3142  &bxv.   &bxv.   &bxv.    G = 1&period.0 / &fn0056.(3&period.&cont.
0);
 3143  &bxv.   &bxv.   &bxv.    D&lbrk.1&rbrk.&cont.
 = D&lbrk.1&rbrk. * D&lbrk.2&rbrk.;
 3144  &bxv.   &bxv.   &bxv.
 3145  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (KAT != 2)
 3146  &bxv.   &bxv.   &bxv.   &bxul.{
 3147  &bxv.   &bxv.   &bxv.   &bxv.    KAT = 1;
 3148  &bxv.   &bxv.   &bxv.   &bxv.    WLAB = "Plane";
 3149  &bxv.   &bxv.   &bxv.   &bxll.}
 3150  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 3151  &bxv.   &bxv.   &bxv.   &bxul.{
 3152  &bxv.   &bxv.   &bxv.   &bxv.    KAT = 2;
 3153  &bxv.   &bxv.   &bxv.   &bxv.    WLAB = "Axisym";
 3154  &bxv.   &bxv.   &bxv.   &bxll.}
 3155  &bxv.   &bxv.   &bxv.
 3156  &bxv.   &bxv.   &bxv.    &fn0044.("          %s Analysis\n", WLAB);
 3157  &bxv.   &bxv.   &bxv.
 3158  &bxv.   &bxv.   &bxv.    :hp3.break:ehp3.;
 3159  &bxv.   &bxv.   &bxll.}
 3160  &bxv.   &bxv.
 3161  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3162  &bxv.   &bxv.:hp1./* Insert check of mesh if desired                                       */:ehp1.
 3163  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3164  &bxv.   &bxv.
 3165  &bxv.   &bxv.:hp3.case:ehp3. 2&colon.
 3166  &bxv.   &bxv.:hp3.case:ehp3. 4&colon.
 3167  &bxv.   &bxv.    :hp3.break:ehp3.;
 3168  &bxv.   &bxv.
 3169  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3170  &bxv.   &bxv.:hp1./* Compute conductivity (stiffness) matrix                               */:ehp1.
 3171  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3172  &bxv.   &bxv.
 3173  &bxv.   &bxv.:hp3.case:ehp3. 3&colon.
 3174  &bxv.   &bxv.:hp3.case:ehp3. 6&colon.
 3175  &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < 4; l++)
 3176  &bxv.   &bxv.   &bxul.{
 3177  &bxv.   &bxv.   &bxv.    &fn0026.(SG&lbrk.l&rbrk.&cont.
 * G, TG&lbrk.l&rbrk. * G, XL, SHP&lbrk.0&rbrk., &amp.&cont.
XSJ, NDM, NEL, IX, FALSE);
 3178  &bxv.   &bxv.   &bxv.
 3179  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (KAT == 2)
 3180  &bxv.   &bxv.   &bxv.   &bxul.{
 3181  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. RR = 0&period.&cont.
0;
 3182  &bxv.   &bxv.   &bxv.   &bxv.
 3183  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NE&cont.
L; i++)
 3184  &bxv.   &bxv.   &bxv.   &bxv.        RR = RR + SHP&lbrk.&cont.
i&rbrk.&lbrk.2&rbrk. * &fn0050.(XL, i, 0, NDM);
 3185  &bxv.   &bxv.   &bxv.   &bxv.
 3186  &bxv.   &bxv.   &bxv.   &bxv.    XSJ = XSJ * RR;
 3187  &bxv.   &bxv.   &bxv.   &bxll.}
 3188  &bxv.   &bxv.   &bxv.
 3189  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NEL; j++)
 3190  &bxv.   &bxv.   &bxv.   &bxul.{
 3191  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. A1  = D&lbrk.&cont.
0&rbrk. * SHP&lbrk.j&rbrk.&lbrk.0&rbrk.&cont.
 * XSJ;
 3192  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. A2  = D&lbrk.&cont.
0&rbrk. * SHP&lbrk.j&rbrk.&lbrk.1&rbrk.&cont.
 * XSJ;
 3193  &bxv.   &bxv.   &bxv.   &bxv.   
 3194  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NE&cont.
L; i++)
 3195  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 3196  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j, i, NST, &fn0050.(S, j, i, NST) + A1 * SHP&lbrk.i&rbrk.&lbrk.0&rbrk.&cont.
 + A2 * SHP&lbrk.i&rbrk.&lbrk.1&rbrk.);
 3197  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 3198  &bxv.   &bxv.   &bxv.   &bxll.}
 3199  &bxv.   &bxv.   &bxll.}
 3200  &bxv.   &bxv.
 3201  &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NEL; i++)
 3202  &bxv.   &bxv.   &bxul.{
 3203  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NEL; j++)
 3204  &bxv.   &bxv.   &bxv.   &bxul.{
 3205  &bxv.   &bxv.   &bxv.   &bxv.    P&lbrk.&cont.
i&rbrk. = P&lbrk.i&rbrk. - &fn0050.(S, j, i, NST) * UL&lbrk.j&rbrk.&cont.
;
 3206  &bxv.   &bxv.   &bxv.   &bxll.}
 3207  &bxv.   &bxv.   &bxll.}
 3208  &bxv.   &bxv.
 3209  &bxv.   &bxv.    :hp3.break:ehp3.;
 3210  &bxv.   &bxv.
 3211  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3212  &bxv.   &bxv.:hp1./* Compute heat capacity (mass) matrix                                   */:ehp1.
 3213  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3214  &bxv.   &bxv.
 3215  &bxv.   &bxv.:hp3.case:ehp3. 5&colon.
 3216  &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < 4; l++)
 3217  &bxv.   &bxv.   &bxul.{
 3218  &bxv.   &bxv.   &bxv.    &fn0026.(SG&lbrk.l&rbrk.&cont.
 * G, TG&lbrk.l&rbrk. * G, XL, SHP&lbrk.0&rbrk., &amp.&cont.
XSJ, NDM, NEL, IX, FALSE);
 3219  &bxv.   &bxv.   &bxv.
 3220  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (KAT == 2)
 3221  &bxv.   &bxv.   &bxv.   &bxul.{
 3222  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. RR = 0&period.&cont.
0;
 3223  &bxv.   &bxv.   &bxv.   &bxv.   
 3224  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NE&cont.
L; i++)
 3225  &bxv.   &bxv.   &bxv.   &bxv.        RR = RR + SHP&lbrk.&cont.
i&rbrk.&lbrk.2&rbrk. * &fn0050.(XL, i, 0, NDM);
 3226  &bxv.   &bxv.   &bxv.   &bxv.   
 3227  &bxv.   &bxv.   &bxv.   &bxv.    XSJ = XSJ * RR;
 3228  &bxv.   &bxv.   &bxv.   &bxll.}
 3229  &bxv.   &bxv.   &bxv.
 3230  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < NEL; j++)
 3231  &bxv.   &bxv.   &bxv.   &bxul.{
 3232  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. SHJ = D&lbrk.&cont.
1&rbrk. * SHP&lbrk.j&rbrk.&lbrk.2&rbrk.&cont.
 * XSJ;
 3233  &bxv.   &bxv.   &bxv.   &bxv.    P&lbrk.&cont.
j&rbrk. = P&lbrk.j&rbrk. + SHJ;
 3234  &bxv.   &bxv.   &bxv.   &bxv.   
 3235  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < NE&cont.
L; i++)
 3236  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 3237  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    &fn0048.(S, j, i, NST, &fn0050.(S, j, i, NST) + SHJ * SHP&lbrk.i&rbrk.&lbrk.2&rbrk.&cont.
);
 3238  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 3239  &bxv.   &bxv.   &bxv.   &bxll.}
 3240  &bxv.   &bxv.   &bxll.}
 3241  &bxv.   &bxv.
 3242  &bxv.   &bxv.    :hp3.break:ehp3.;
 3243  &bxv.   &bxll.}
 3244  &bxv.
 3245  &bxv.    &fn0042.("ELMT02");
 3246  &bxv.    :hp3.return:ehp3.;
 3247  &bxll.}
 3248   
.cp 189
 3249   :hp1./*****************************************************************************/:ehp1.
 3250   :hp1./*                                                                           */:ehp1.
 3251   :hp1./* Two dimensional fluid element for navier-stokes equations                 */:ehp1.
 3252   :hp1./*                                                                           */:ehp1.
 3253   :hp1./*****************************************************************************/:ehp1.
 3254   
 3255   :hp3.void:ehp3. &fn0029.:spot id=sp0029.(:hp3.double:ehp3. *D, :hp3.double:ehp3. *UL, :hp3.double:ehp3. *XL, :hp3.int:ehp3. *IX, :hp3.double:ehp3. *TL,
:subject.ELMT03
 3256               :hp3.double:ehp3. *S, :hp3.double:ehp3. *P, :hp3.int:ehp3. NDF, :hp3.int:ehp3. NDM, :hp3.int:ehp3. NST, :hp3.int:ehp3. ISW)
 3257  &bxul.{
 3258  &bxv.    :hp3.double:ehp3. XSJ  = *TL, XLAM = 0&period.0, XMU = 0&period.0, XRHO = 0&period.&cont.
0;
 3259  &bxv.    :hp3.double:ehp3. V&lbrk.2&rbrk. = {0&period.0};
 3260  &bxv.    :hp3.int:ehp3.    l = 0, i = 0, j = 0, k = 0;
 3261  &bxv.    :hp3.double:ehp3. DV&lbrk.2&rbrk.&lbrk.2&rbrk.&cont.
 = {{0&period.0}};
 3262  &bxv.    :hp3.double:ehp3. SHP&lbrk.9&rbrk.&lbrk.3&rbrk.&cont.
 = {{0&period.0}};
 3263  &bxv.
 3264  &bxv.    :hp3.static:ehp3. :hp3.int:ehp3.    LINT = 0;
 3265  &bxv.    :hp3.static:ehp3. :hp3.double:ehp3. SG&lbrk.9&rbrk. = {0&period.0}, T&cont.
G&lbrk.9&rbrk. = {0&period.0}, WG&lbrk.9&rbrk.&cont.
 = {0&period.0};
 3266  &bxv.
 3267  &bxv.    &fn0041.("ELMT03");
 3268  &bxv.
 3269  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3270  &bxv.    :hp1./* Transfer to correct processor                                         */:ehp1.
 3271  &bxv.    :hp1./*-----------------------------------------------------------------------*/:ehp1.
 3272  &bxv.
 3273  &bxv.    :hp3.switch:ehp3. (ISW)
 3274  &bxv.   &bxul.{
 3275  &bxv.   &bxv.
 3276  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3277  &bxv.   &bxv.:hp1./* Input/output fluid properties                                         */:ehp1.
 3278  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3279  &bxv.   &bxv.
 3280  &bxv.   &bxv.:hp3.case:ehp3. 1&colon.
 3281  &bxv.   &bxv.   &bxul.{
 3282  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. L = 0;
 3283  &bxv.   &bxv.   &bxv.
 3284  &bxv.   &bxv.   &bxv.    :hp3.char:ehp3. line&lbrk.LINE_LENGTH &cont.
+ 1&rbrk. = "";
 3285  &bxv.   &bxv.   &bxv.   
 3286  &bxv.   &bxv.   &bxv.    &fn0045.(line);
 3287  &bxv.   &bxv.   &bxv.    D&lbrk.0&rbrk.&cont.
 = &fn0031.(line,  0, 10);
 3288  &bxv.   &bxv.   &bxv.    D&lbrk.1&rbrk.&cont.
 = &fn0031.(line, 10, 20);
 3289  &bxv.   &bxv.   &bxv.    D&lbrk.2&rbrk.&cont.
 = &fn0031.(line, 20, 30);
 3290  &bxv.   &bxv.   &bxv.    L    = &fn0030.   (line, 30, 35);
 3291  &bxv.   &bxv.   &bxv.    
 3292  &bxv.   &bxv.   &bxv.   
 3293  &bxv.   &bxv.   &bxv.    &fn0044.("    Two dimensional fluid element\n\n");
 3294  &bxv.   &bxv.   &bxv.    &fn0044.("          Viscosity  = %12&period.&cont.
5lf\n", D&lbrk.0&rbrk.);
 3295  &bxv.   &bxv.   &bxv.    &fn0044.("          Constraint = %12&period.&cont.
5lf\n", D&lbrk.1&rbrk.);
 3296  &bxv.   &bxv.   &bxv.    &fn0044.("          Density    = %12&period.&cont.
5lf\n", D&lbrk.2&rbrk.);
 3297  &bxv.   &bxv.   &bxv.    &fn0044.("          Gauss pt/dir = %5d\n", L);
 3298  &bxv.   &bxv.   &bxv.   
 3299  &bxv.   &bxv.   &bxv.    D&lbrk.3&rbrk.&cont.
 = L;
 3300  &bxv.   &bxv.   &bxv.    LINT = 0;
 3301  &bxv.   &bxv.   &bxv.    :hp3.break:ehp3.;
 3302  &bxv.   &bxv.   &bxll.}
 3303  &bxv.   &bxv.
 3304  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3305  &bxv.   &bxv.:hp1./* Insert check of mesh if desired                                       */:ehp1.
 3306  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3307  &bxv.   &bxv.
 3308  &bxv.   &bxv.:hp3.case:ehp3. 2&colon.
 3309  &bxv.   &bxv.    :hp3.break:ehp3.;
 3310  &bxv.   &bxv.
 3311  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3312  &bxv.   &bxv.:hp1./* Compute unsymmetric tangent stiffness or out of balance forces        */:ehp1.
 3313  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3314  &bxv.   &bxv.
 3315  &bxv.   &bxv.:hp3.case:ehp3. 3&colon.
 3316  &bxv.   &bxv.:hp3.case:ehp3. 6&colon.
 3317  &bxv.   &bxv.    l = (:hp3.int:ehp3.) D&lbrk.3&rbrk.;
 3318  &bxv.   &bxv.
 3319  &bxv.   &bxv.    :hp3.if:ehp3. (l*l != LINT)    &fn0024.(l, &amp.LINT, SG, TG, WG);
 3320  &bxv.   &bxv.
 3321  &bxv.   &bxv.    :hp3.for:ehp3. (l = 0; l < LINT; l++)
 3322  &bxv.   &bxv.   &bxul.{
 3323  &bxv.   &bxv.   &bxv.    &fn0026.(SG&lbrk.l&rbrk.&cont.
, TG&lbrk.l&rbrk., XL, SHP&lbrk.0&rbrk., &amp.&cont.
XSJ, NDM, NEL, IX, FALSE);
 3324  &bxv.   &bxv.   &bxv.    XLAM = D&lbrk.1&rbrk.&cont.
 * XSJ * WG&lbrk.l&rbrk.;
 3325  &bxv.   &bxv.   &bxv.    XMU  = D&lbrk.0&rbrk.&cont.
 * XSJ * WG&lbrk.l&rbrk.;
 3326  &bxv.   &bxv.   &bxv.    XRHO = D&lbrk.2&rbrk.&cont.
 * XSJ * WG&lbrk.l&rbrk.;
 3327  &bxv.   &bxv.   &bxv.   
 3328  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 3329  &bxv.   &bxv.   &bxv.    :hp1./* Compute velocities and gradients                &cont.
              */:ehp1.
 3330  &bxv.   &bxv.   &bxv.    :hp1./*-------------------------------------------------&cont.
--------------*/:ehp1.
 3331  &bxv.   &bxv.   &bxv.   
 3332  &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (i = 0; i < 2; i++)
 3333  &bxv.   &bxv.   &bxv.   &bxul.{
 3334  &bxv.   &bxv.   &bxv.   &bxv.    V&lbrk.&cont.
i&rbrk. = 0&period.0;
 3335  &bxv.   &bxv.   &bxv.   &bxv.   
 3336  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NE&cont.
L; k++)
 3337  &bxv.   &bxv.   &bxv.   &bxv.        V&lbrk.&cont.
i&rbrk. = V&lbrk.i&rbrk. + SHP&lbrk.k&rbrk.&cont.
&lbrk.2&rbrk. * &fn0050.(UL, k, i, NDF);
 3338  &bxv.   &bxv.   &bxv.   &bxv.   
 3339  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < 2;&cont.
 j++)
 3340  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 3341  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    DV&lbrk.j&rbrk.&lbrk.i&rbrk. = 0&period.&cont.
0;
 3342  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 3343  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (k = 0; k < NEL; k++)
 3344  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 3345  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    DV&lbrk.j&rbrk.&lbrk.i&rbrk.&cont.
 = DV&lbrk.j&rbrk.&lbrk.i&rbrk. + SHP&lbrk.&cont.
k&rbrk.&lbrk.j&rbrk. * &fn0050.(UL, k, i, NDF);
 3346  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 3347  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 3348  &bxv.   &bxv.   &bxv.   &bxll.}
 3349  &bxv.   &bxv.   &bxv.   
 3350  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. (ISW == 3)
 3351  &bxv.   &bxv.   &bxv.   &bxul.{
 3352  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3353  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Compute tangent&cont.
, loop over columns of S                   */:ehp1.
 3354  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3355  &bxv.   &bxv.   &bxv.   &bxv.   
 3356  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. k1 = 0;
 3357  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NE&cont.
L; k++)
 3358  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 3359  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.int:ehp3. jj = 0;
 3360  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.
 3361  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. A1 = XMU * SHP&lbrk.k&rbrk.&lbrk.0&rbrk.;
 3362  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. A2 = XMU * SHP&lbrk.k&rbrk.&lbrk.1&rbrk.;
 3363  &bxv.:hp1./*                  double A3 = XRHO * (DV&lbrk.0&rbrk.&lbrk.&cont.
0&rbrk. * SHP&lbrk.k&rbrk.&lbrk.2&rbrk.&cont.
 + V&lbrk.0&rbrk. * SHP&lbrk.k&rbrk.&lbrk.&cont.
0&rbrk. + V&lbrk.1&rbrk. * SHP&lbrk.k&rbrk.&cont.
&lbrk.1&rbrk.); */:ehp1.
 3364  &bxv.:hp1./*                  double A4 = XRHO * (DV&lbrk.1&rbrk.&lbrk.&cont.
1&rbrk. * SHP&lbrk.k&rbrk.&lbrk.2&rbrk.&cont.
 + V&lbrk.0&rbrk. * SHP&lbrk.k&rbrk.&lbrk.&cont.
0&rbrk. + V&lbrk.1&rbrk. * SHP&lbrk.k&rbrk.&cont.
&lbrk.1&rbrk.); */:ehp1.
 3365  &bxv.:hp1./*                  double A5 = XRHO * DV&lbrk.1&rbrk.&lbrk.&cont.
0&rbrk. * SHP&lbrk.k&rbrk.&lbrk.2&rbrk.&cont.
;                                         */:ehp1.
 3366  &bxv.:hp1./*                  double A6 = XRHO * DV&lbrk.0&rbrk.&lbrk.&cont.
1&rbrk. * SHP&lbrk.k&rbrk.&lbrk.2&rbrk.&cont.
;                                         */:ehp1.
 3367  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. B1 = XLAM * SHP&lbrk.k&rbrk.&lbrk.0&rbrk.;
 3368  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.double:ehp3. B2 = XLAM * SHP&lbrk.k&rbrk.&lbrk.1&rbrk.;
 3369  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 3370  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 3371  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./* Loop over rows of S                                   */:ehp1.
 3372  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp1./*-------------------------------------------------------*/:ehp1.
 3373  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 3374  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    jj = 0;
 3375  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 3376  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (j = 0; j < NEL; j++)
 3377  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 3378  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1,   jj,   NST, &fn0050.(S, k1,   jj,   NST) + SHP&lbrk.j&rbrk.&lbrk.&cont.
0&rbrk. * (A1+A1+B1) + SHP&lbrk.j&rbrk.&lbrk.1&rbrk.&cont.
 * A2);
 3379  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1+1, jj,   NST, &fn0050.(S, k1+1, jj,   NST) + SHP&lbrk.j&rbrk.&lbrk.&cont.
0&rbrk. * B2 + SHP&lbrk.j&rbrk.&lbrk.1&rbrk.&cont.
 * A1);
 3380  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1,   jj+1, NST, &fn0050.(S, k1,   jj+1, NST) + SHP&lbrk.j&rbrk.&lbrk.&cont.
0&rbrk. * A2 + SHP&lbrk.j&rbrk.&lbrk.2&rbrk.&cont.
 * B1);
 3381  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(S, k1+1, jj+1, NST, &fn0050.(S, k1+1, jj+1, NST) + SHP&lbrk.j&rbrk.&lbrk.&cont.
0&rbrk. * A1 + SHP&lbrk.j&rbrk.&lbrk.2&rbrk.&cont.
 * (A2+A2+B2));
 3382  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    jj = jj + NDF;
 3383  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 3384  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   
 3385  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    k1 = k1 + NDF;
 3386  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 3387  &bxv.   &bxv.   &bxv.   &bxll.}
 3388  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 3389  &bxv.   &bxv.   &bxv.   &bxul.{
 3390  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3391  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Compute diverge&cont.
nce term                                   */:ehp1.
 3392  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3393  &bxv.   &bxv.   &bxv.   &bxv.   
 3394  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.double:ehp3. XDIV = (DV&lbrk.&cont.
0&rbrk.&lbrk.0&rbrk. + DV&lbrk.1&rbrk.&cont.
&lbrk.1&rbrk.) * XLAM;
 3395  &bxv.   &bxv.   &bxv.   &bxv.   
 3396  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3397  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./* Compute interna&cont.
l forces                                   */:ehp1.
 3398  &bxv.   &bxv.   &bxv.   &bxv.    :hp1./*----------------&cont.
-------------------------------------------*/:ehp1.
 3399  &bxv.   &bxv.   &bxv.   &bxv.   
 3400  &bxv.   &bxv.   &bxv.   &bxv.    :hp3.for:ehp3. (k = 0; k < NE&cont.
L; k++)
 3401  &bxv.   &bxv.   &bxv.   &bxv.   &bxul.&cont.
{
 3402  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
    :hp3.for:ehp3. (j = 0; j < 2; j++)
 3403  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxul.{
 3404  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.double:ehp3. SUM = XDIV * SHP&lbrk.k&rbrk.&lbrk.&cont.
j&rbrk.;
 3405  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   
 3406  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    :hp3.for:ehp3. (i = 0; i < 2; i++)
 3407  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxul.{
 3408  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxv.    SUM = SUM + XMU * (DV&lbrk.i&rbrk.&cont.
&lbrk.j&rbrk. + DV&lbrk.j&rbrk.&lbrk.&cont.
i&rbrk.) * SHP&lbrk.k&rbrk.&lbrk.i&rbrk.&cont.
 + XRHO * V&lbrk.i&rbrk. * DV&lbrk.i&rbrk.&lbrk.&cont.
j&rbrk. * SHP&lbrk.k&rbrk.&lbrk.2&rbrk.&cont.
;
 3409  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   &bxll.}
 3410  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.   
 3411  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxv.    &fn0048.(P, k, j, NDF, &fn0050.(P, k, j, NDF) - SUM);
 3412  &bxv.   &bxv.   &bxv.   &bxv.   &bxv.&cont.
   &bxll.}
 3413  &bxv.   &bxv.   &bxv.   &bxv.   &bxll.&cont.
}
 3414  &bxv.   &bxv.   &bxv.   &bxll.}
 3415  &bxv.   &bxv.   &bxll.}
 3416  &bxv.   &bxv.    :hp3.break:ehp3.;
 3417  &bxv.   &bxv.
 3418  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3419  &bxv.   &bxv.:hp1./* Compute stresses and velocity gradients                               */:ehp1.
 3420  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3421  &bxv.   &bxv.
 3422  &bxv.   &bxv.:hp3.case:ehp3. 4&colon.
 3423  &bxv.   &bxv.    :hp3.break:ehp3.;
 3424  &bxv.   &bxv.
 3425  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3426  &bxv.   &bxv.:hp1./* Compute mass matrix                                                   */:ehp1.
 3427  &bxv.   &bxv.:hp1./*-----------------------------------------------------------------------*/:ehp1.
 3428  &bxv.   &bxv.
 3429  &bxv.   &bxv.:hp3.case:ehp3. 5&colon.
 3430  &bxv.   &bxv.    :hp3.break:ehp3.;
 3431  &bxv.   &bxll.}
 3432  &bxv.
 3433  &bxv.    &fn0042.("ELMT03");
 3434  &bxll.}
 3435    
.cp 27
 3436   :hp1./*****************************************************************************/:ehp1.
 3437   :hp1./*                                                                           */:ehp1.
 3438   :hp1./* Read an integer value from a string between margins                       */:ehp1.
 3439   :hp1./*                                                                           */:ehp1.
 3440   :hp1./*****************************************************************************/:ehp1.
 3441   
 3442   :hp3.int:ehp3. &fn0030.:spot id=sp0030.(:hp3.char:ehp3. *line, :hp3.int:ehp3. lo, :hp3.int:ehp3. hi)
:subject.read_int
 3443  &bxul.{
 3444  &bxv.    :hp3.int:ehp3. value = 0, count = 0;
 3445  &bxv.
 3446  &bxv.    :hp3.if:ehp3. (&fn0064.(line) <= lo)
 3447  &bxv.        value = 0;
 3448  &bxv.    :hp3.else:ehp3.
 3449  &bxv.   &bxul.{
 3450  &bxv.   &bxv.    :hp3.char:ehp3. ch = line&lbrk.hi&rbrk.;
 3451  &bxv.   &bxv.    line&lbrk.hi&rbrk. = 0;
 3452  &bxv.   &bxv.    count = &fn0065.(&amp.line&lbrk.lo&rbrk.&cont.
, "%d", &amp.value);
 3453  &bxv.   &bxv.    line&lbrk.hi&rbrk. = ch;
 3454  &bxv.   &bxv.
 3455  &bxv.   &bxv.    :hp3.if:ehp3. (count != 1) value = 0;
 3456  &bxv.   &bxll.}
 3457  &bxv.
 3458  &bxv.    :hp3.return:ehp3. value;
 3459  &bxll.}
 3460   
.cp 28
 3461   :hp1./*****************************************************************************/:ehp1.
 3462   :hp1./*                                                                           */:ehp1.
 3463   :hp1./* Read a double value from a string between margins                         */:ehp1.
 3464   :hp1./*                                                                           */:ehp1.
 3465   :hp1./*****************************************************************************/:ehp1.
 3466   
 3467   :hp3.double:ehp3. &fn0031.:spot id=sp0031.(:hp3.char:ehp3. *line, :hp3.int:ehp3. lo, :hp3.int:ehp3. hi)
:subject.read_double
 3468  &bxul.{
 3469  &bxv.    :hp3.double:ehp3. value = 0&period.0;
 3470  &bxv.    :hp3.int:ehp3.    count = 0;
 3471  &bxv.
 3472  &bxv.    :hp3.if:ehp3. (&fn0064.(line) <= lo)
 3473  &bxv.        value = BLANK;
 3474  &bxv.    :hp3.else:ehp3.
 3475  &bxv.   &bxul.{
 3476  &bxv.   &bxv.    :hp3.char:ehp3. ch = line&lbrk.hi&rbrk.;
 3477  &bxv.   &bxv.    line&lbrk.hi&rbrk. = 0;
 3478  &bxv.   &bxv.    count = &fn0065.(&amp.line&lbrk.lo&rbrk.&cont.
, "%lf", &amp.value);
 3479  &bxv.   &bxv.    line&lbrk.hi&rbrk. = ch;
 3480  &bxv.   &bxv.
 3481  &bxv.   &bxv.    :hp3.if:ehp3. (count != 1) value = BLANK;
 3482  &bxv.   &bxll.}
 3483  &bxv.
 3484  &bxv.    :hp3.return:ehp3. value;
 3485  &bxll.}
 3486   
.cp 20
 3487   :hp1./*****************************************************************************/:ehp1.
 3488   :hp1./*                                                                           */:ehp1.
 3489   :hp1./* Read a string from a string between margins                               */:ehp1.
 3490   :hp1./*                                                                           */:ehp1.
 3491   :hp1./*****************************************************************************/:ehp1.
 3492   
 3493   :hp3.char:ehp3. *&fn0032.:spot id=sp0032.(:hp3.char:ehp3. *line, :hp3.int:ehp3. lo, :hp3.int:ehp3. hi, :hp3.char:ehp3. *buffer)
:subject.read_string
 3494  &bxul.{
 3495  &bxv.    size_t limit = (size_t) (hi - lo + 1);
 3496  &bxv.
 3497  &bxv.    :hp3.if:ehp3. (&fn0064.(line) <= lo)
 3498  &bxv.        *buffer = 0;
 3499  &bxv.    :hp3.else:ehp3.
 3500  &bxv.        &fn0054.(buffer, &amp.line&lbrk.lo&rbrk., limit)&cont.
;
 3501  &bxv.
 3502  &bxv.    :hp3.return:ehp3. buffer;
 3503  &bxll.}
 3504   
.cp 24
 3505   :hp1./*****************************************************************************/:ehp1.
 3506   :hp1./*                                                                           */:ehp1.
 3507   :hp1./* Left justify and strip trailing blanks from a string                      */:ehp1.
 3508   :hp1./*                                                                           */:ehp1.
 3509   :hp1./*****************************************************************************/:ehp1.
 3510   
 3511   :hp3.char:ehp3. *&fn0033.:spot id=sp0033.(:hp3.char:ehp3. *line)
:subject.strip
 3512  &bxul.{
 3513  &bxv.    :hp3.char:ehp3. *p = line, *q = line, *end = line;
 3514  &bxv.
 3515  &bxv.    :hp3.while:ehp3. (*p == ' ')     p++;
 3516  &bxv.
 3517  &bxv.    :hp3.while:ehp3. (*p)
 3518  &bxv.   &bxul.{
 3519  &bxv.   &bxv.    :hp3.if:ehp3. ((*q++ = *p++) != ' ')     end = q;
 3520  &bxv.   &bxll.}
 3521  &bxv.
 3522  &bxv.    *end = 0;
 3523  &bxv.
 3524  &bxv.    :hp3.return:ehp3. line;
 3525  &bxll.}
 3526   
.cp 17
 3527   :hp1./*****************************************************************************/:ehp1.
 3528   :hp1./*                                                                           */:ehp1.
 3529   :hp1./* Transfer of sign&period.  Return the sign of "b" times "absolute value of 'a'"   */:ehp1.
 3530   :hp1./*                                                                           */:ehp1.
 3531   :hp1./*****************************************************************************/:ehp1.
 3532   
 3533   :hp3.int:ehp3. &fn0034.:spot id=sp0034.(:hp3.int:ehp3. a, :hp3.int:ehp3. b)
:subject.ISIGN
 3534  &bxul.{         
 3535  &bxv.    :hp3.int:ehp3. sign = 1;
 3536  &bxv.
 3537  &bxv.    :hp3.if:ehp3. (b < 0)    sign = -1;
 3538  &bxv. 
 3539  &bxv.    :hp3.return:ehp3. sign * &fn0049.(a);
 3540  &bxll.}
 3541   
.cp 19
 3542   :hp1./*****************************************************************************/:ehp1.
 3543   :hp1./*                                                                           */:ehp1.
 3544   :hp1./* Remaindering&period.  Return "a - &lbrk.a/b&rbrk.*b" where &lbrk.&cont.
x&rbrk. is the integer whose        */:ehp1.
 3545   :hp1./* magnitude does not exceed the magnitude of "x" and whose sign is the same */:ehp1.
 3546   :hp1./* as "x"                                                                    */:ehp1.
 3547   :hp1./*                                                                           */:ehp1.
 3548   :hp1./*****************************************************************************/:ehp1.
 3549   
 3550   :hp3.double:ehp3. &fn0035.:spot id=sp0035.(:hp3.double:ehp3. a, :hp3.double:ehp3. b)
:subject.AMOD
 3551  &bxul.{
 3552  &bxv.    :hp3.double:ehp3. x     = a / b;
 3553  &bxv.    :hp3.double:ehp3. sign  = (x >= 0&period.0) ? 1&period.0 &colon.&cont.
 -1&period.0;
 3554  &bxv.    :hp3.double:ehp3. thing = sign * &fn0066.(&fn0058.(x));
 3555  &bxv.
 3556  &bxv.    :hp3.return:ehp3. (a - thing * b);
 3557  &bxll.}
 3558   
.cp 51
 3559   :hp1./*****************************************************************************/:ehp1.
 3560   :hp1./*                                                                           */:ehp1.
 3561   :hp1./* Print the matrix                                                          */:ehp1.
 3562   :hp1./*                                                                           */:ehp1.
 3563   :hp1./*****************************************************************************/:ehp1.
 3564   
 3565   :hp3.void:ehp3. &fn0036.:spot id=sp0036.(:hp3.int:ehp3. n, :hp3.int:ehp3. *JDIAG, :hp3.double:ehp3. *A, :hp3.double:ehp3. *B, :hp3.char:ehp3. *format, &period.&period.&period.&cont.
)
:subject.dspMatrix
 3566  &bxul.{
 3567  &bxv.    :hp3.int:ehp3. i = 0;
 3568  &bxv.    va_list arguments = NULL;
 3569  &bxv.
 3570  &bxv.    &fn0044.("\n");
 3571  &bxv.
 3572  &bxv.    &fn0067.(arguments, format);
 3573  &bxv.    &fn0068.(format, arguments);
 3574  &bxv.    &fn0069.(arguments);
 3575  &bxv.
 3576  &bxv.    &fn0044.("\n");
 3577  &bxv.    &fn0044.("%c%c",   esc, condensed);
 3578  &bxv.    &fn0044.("%c%c",   esc, cpi_15);
 3579  &bxv.    &fn0044.("\n");
 3580  &bxv.
 3581  &bxv.    :hp3.for:ehp3. (i = 0; i < n; i++)
 3582  &bxv.   &bxul.{
 3583  &bxv.   &bxv.    :hp3.int:ehp3. j = 0, jr = -1;
 3584  &bxv.   &bxv.
 3585  &bxv.   &bxv.    :hp3.for:ehp3. (j = 0; j < n; j++)
 3586  &bxv.   &bxv.   &bxul.{
 3587  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. jd = JDIAG&lbrk.j&rbrk.&cont.
 - 1;
 3588  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. jh = jd - jr;
 3589  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. k  = jh - (j - i);
 3590  &bxv.   &bxv.   &bxv.    :hp3.int:ehp3. l  = jr +  k;
 3591  &bxv.   &bxv.   &bxv.
 3592  &bxv.   &bxv.   &bxv.    :hp3.if:ehp3. ((j < i) || (k < 1))
 3593  &bxv.   &bxv.   &bxv.        &fn0044.("       ");
 3594  &bxv.   &bxv.   &bxv.    :hp3.else:ehp3.
 3595  &bxv.   &bxv.   &bxv.        &fn0044.("%7&period.1lf", A&lbrk.&cont.
l&rbrk.);
 3596  &bxv.   &bxv.   &bxv.
 3597  &bxv.   &bxv.   &bxv.    jr = jd;
 3598  &bxv.   &bxv.   &bxll.}
 3599  &bxv.   &bxv.
 3600  &bxv.   &bxv.    &fn0044.("  &colon. %7&period.3lf\n", B&lbrk.&cont.
i&rbrk.);
 3601  &bxv.   &bxll.}
 3602  &bxv.
 3603  &bxv.    &fn0044.("%c",   reset);
 3604  &bxv.    &fn0044.("%c%c", esc, cpi_10);
 3605  &bxv.    &fn0044.("\n");
 3606  &bxll.}
 3607   
.cp 41
 3608   :hp1./*****************************************************************************/:ehp1.
 3609   :hp1./*                                                                           */:ehp1.
 3610   :hp1./* Dump a 2 dimensional array                                                */:ehp1.
 3611   :hp1./*                                                                           */:ehp1.
 3612   :hp1./*****************************************************************************/:ehp1.
 3613   
 3614   :hp3.void:ehp3. &fn0037.:spot id=sp0037.(:hp3.char:ehp3. *name, :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. row, :hp3.int:ehp3. col)
:subject.print2Darray
 3615  &bxul.{
 3616  &bxv.    :hp3.char:ehp3. string&lbrk.40&rbrk. = "";
 3617  &bxv.    :hp3.int:ehp3. i = 0, j = 0, indent = 20, integer = 1;
 3618  &bxv.    :hp3.if:ehp3. (&fn0070.(format, 'f')) integer = 0;
 3619  &bxv.
 3620  &bxv.    &fn0071.(string, "%s&lbrk.%d&rbrk.&lbrk.%d&rbrk.&cont.
 = {{", name, row, col);
 3621  &bxv.    &fn0044.("%*&period.*s", indent, indent, string);
 3622  &bxv.    &fn0039.(integer, pointer, format, 0, 0, col);
 3623  &bxv.
 3624  &bxv.    :hp3.for:ehp3. (j = 1; j < col; j++)
 3625  &bxv.   &bxul.{
 3626  &bxv.   &bxv.    &fn0044.(", ");
 3627  &bxv.   &bxv.    &fn0039.(integer, pointer, format, 0, j, col);
 3628  &bxv.   &bxll.}
 3629  &bxv.
 3630  &bxv.    &fn0044.("}");
 3631  &bxv.
 3632  &bxv.    :hp3.for:ehp3. (i = 1; i < row; i++)
 3633  &bxv.   &bxul.{
 3634  &bxv.   &bxv.    &fn0044.(",\n%*&period.*s{", indent-1, indent-1, "");
 3635  &bxv.   &bxv.    &fn0039.(integer, pointer, format, i, 0, col);
 3636  &bxv.   &bxv.
 3637  &bxv.   &bxv.    :hp3.for:ehp3. (j = 1; j < col; j++)
 3638  &bxv.   &bxv.   &bxul.{
 3639  &bxv.   &bxv.   &bxv.    &fn0044.(", ");
 3640  &bxv.   &bxv.   &bxv.    &fn0039.(integer, pointer, format, i, j, col);
 3641  &bxv.   &bxv.   &bxll.}
 3642  &bxv.   &bxv.    &fn0044.("}");
 3643  &bxv.   &bxll.}
 3644  &bxv.    &fn0044.("}\n");
 3645  &bxll.}
 3646   
.cp 26
 3647   :hp1./*****************************************************************************/:ehp1.
 3648   :hp1./*                                                                           */:ehp1.
 3649   :hp1./* Dump a 1 dimensional array                                                */:ehp1.
 3650   :hp1./*                                                                           */:ehp1.
 3651   :hp1./*****************************************************************************/:ehp1.
 3652   
 3653   :hp3.void:ehp3. &fn0038.:spot id=sp0038.(:hp3.char:ehp3. *name, :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. size)
:subject.print1Darray
 3654  &bxul.{
 3655  &bxv.    :hp3.char:ehp3. string&lbrk.40&rbrk.   = "";
 3656  &bxv.    :hp3.int:ehp3. i = 0, indent = 20, integer = 1;
 3657  &bxv.    :hp3.if:ehp3. (&fn0070.(format, 'f')) integer = 0;
 3658  &bxv.
 3659  &bxv.    &fn0071.(string, "%s&lbrk.%d&rbrk. = {", name, size);
 3660  &bxv.    &fn0044.("%*&period.*s", indent, indent, string);
 3661  &bxv.    &fn0040.(integer, pointer, format, 0);
 3662  &bxv.
 3663  &bxv.    :hp3.for:ehp3. (i = 1; i < size; i++)
 3664  &bxv.   &bxul.{
 3665  &bxv.   &bxv.    &fn0044.(", ");
 3666  &bxv.   &bxv.    &fn0040.(integer, pointer, format, i);
 3667  &bxv.   &bxll.}
 3668  &bxv.    &fn0044.("}\n");
 3669  &bxll.}
 3670   
.cp 24
 3671   :hp1./*****************************************************************************/:ehp1.
 3672   :hp1./*                                                                           */:ehp1.
 3673   :hp1./* Print a value from a 2 dimensional array                                  */:ehp1.
 3674   :hp1./*                                                                           */:ehp1.
 3675   :hp1./*****************************************************************************/:ehp1.
 3676   
 3677   :hp3.void:ehp3. &fn0039.:spot id=sp0039.(:hp3.int:ehp3. integer, :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. i, :hp3.int:ehp3. j, :hp3.int:ehp3. col)
:subject.print2Dvalue
 3678  &bxul.{
 3679  &bxv.    :hp3.if:ehp3. (integer)
 3680  &bxv.   &bxul.{
 3681  &bxv.   &bxv.    :hp3.int:ehp3. *array = (:hp3.int:ehp3.*) pointer;
 3682  &bxv.   &bxv.    :hp3.int:ehp3. value  = &fn0050.(array, i, j, col);
 3683  &bxv.   &bxv.    &fn0044.(format, value);
 3684  &bxv.   &bxll.}
 3685  &bxv.    :hp3.else:ehp3.
 3686  &bxv.   &bxul.{
 3687  &bxv.   &bxv.    :hp3.double:ehp3. *array = (:hp3.double:ehp3.*) pointer;
 3688  &bxv.   &bxv.    :hp3.double:ehp3. value  = &fn0050.(array, i, j, col);
 3689  &bxv.   &bxv.    &fn0044.(format, value);
 3690  &bxv.   &bxll.}
 3691  &bxll.}
 3692   
.cp 24
 3693   :hp1./*****************************************************************************/:ehp1.
 3694   :hp1./*                                                                           */:ehp1.
 3695   :hp1./* Print a value from a 1 dimensional array                                  */:ehp1.
 3696   :hp1./*                                                                           */:ehp1.
 3697   :hp1./*****************************************************************************/:ehp1.
 3698   
 3699   :hp3.void:ehp3. &fn0040.:spot id=sp0040.(:hp3.int:ehp3. integer, :hp3.void:ehp3. *pointer, :hp3.char:ehp3. *format, :hp3.int:ehp3. i)
:subject.print1Dvalue
 3700  &bxul.{
 3701  &bxv.    :hp3.if:ehp3. (integer)
 3702  &bxv.   &bxul.{
 3703  &bxv.   &bxv.    :hp3.int:ehp3. *array = (:hp3.int:ehp3.*) pointer;
 3704  &bxv.   &bxv.    :hp3.int:ehp3. value  = array&lbrk.i&rbrk.;
 3705  &bxv.   &bxv.    &fn0044.(format, value);
 3706  &bxv.   &bxll.}
 3707  &bxv.    :hp3.else:ehp3.
 3708  &bxv.   &bxul.{
 3709  &bxv.   &bxv.    :hp3.double:ehp3. *array = (:hp3.double:ehp3.*) pointer;
 3710  &bxv.   &bxv.    :hp3.double:ehp3. value  = array&lbrk.i&rbrk.;
 3711  &bxv.   &bxv.    &fn0044.(format, value);
 3712  &bxv.   &bxll.}
 3713  &bxll.}
 3714   
.cp 27
 3715   :hp1./*****************************************************************************/:ehp1.
 3716   :hp1./*                                                                           */:ehp1.
 3717   :hp1./* Trace into a function                                                     */:ehp1.
 3718   :hp1./*                                                                           */:ehp1.
 3719   :hp1./*****************************************************************************/:ehp1.
 3720   
 3721   :hp3.void:ehp3. &fn0041.:spot id=sp0041.(:hp3.char:ehp3. *format, &period.&period.&period.)
:subject.traceIN
 3722  &bxul.{
 3723  &bxv.    va_list arguments = NULL;
 3724  &bxv.
 3725  &bxv.    trace_prefix&lbrk.trace_indent  &rbrk. = '';
 3726  &bxv.    trace_prefix&lbrk.trace_indent+1&rbrk. = 0;
 3727  &bxv. 
 3728  &bxv.    &fn0044.("%s ", trace_prefix);
 3729  &bxv. 
 3730  &bxv.    &fn0067.(arguments, format);
 3731  &bxv.    &fn0068.(format, arguments);
 3732  &bxv.    &fn0069.(arguments);
 3733  &bxv.
 3734  &bxv.    &fn0044.("\n");
 3735  &bxv.
 3736  &bxv.    trace_prefix&lbrk.trace_indent  &rbrk. = '';
 3737  &bxv.    trace_indent++;
 3738  &bxll.}
 3739   
.cp 26
 3740   :hp1./*****************************************************************************/:ehp1.
 3741   :hp1./*                                                                           */:ehp1.
 3742   :hp1./* Trace out of a function                                                   */:ehp1.
 3743   :hp1./*                                                                           */:ehp1.
 3744   :hp1./*****************************************************************************/:ehp1.
 3745   
 3746   :hp3.void:ehp3. &fn0042.:spot id=sp0042.(:hp3.char:ehp3. *format, &period.&period.&period.)
:subject.traceOUT
 3747  &bxul.{
 3748  &bxv.    va_list arguments = NULL;
 3749  &bxv.
 3750  &bxv.    :hp3.if:ehp3. (trace_indent > 0)    trace_indent--;
 3751  &bxv.
 3752  &bxv.    trace_prefix&lbrk.trace_indent  &rbrk. = '';
 3753  &bxv.    trace_prefix&lbrk.trace_indent+1&rbrk. = 0;
 3754  &bxv. 
 3755  &bxv.    &fn0044.("%s ", trace_prefix);
 3756  &bxv. 
 3757  &bxv.    &fn0067.(arguments, format);
 3758  &bxv.    &fn0068.(format, arguments);
 3759  &bxv.    &fn0069.(arguments);
 3760  &bxv.
 3761  &bxv.    &fn0044.("\n");
 3762  &bxll.}
.re oldenv
:euserdoc.
